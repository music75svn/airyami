#*************************************************************************
* CLASS 명      : popMetricSearch.vm
* 작 업 자      : 하윤식
* 작 업 일      : 2012.07.03
* 기    능      : 지표검색
* ---------------------------- 변 경 이 력 --------------------------------
* 번호   작 업 자     작   업   일        변 경 내 용             비고
* ----  --------  -----------------  -------------------------  --------
*  1     하 윤 식      2012.07.03          최 초 작 업 
**************************************************************************# 

<script type="text/javascript" language="javascript" >
//<![CDATA[

	var J = jQuery;
	
	J(document).ready(function(){
	
		/******************************************
		 * 데이터 그리드 출력
		 ******************************************/
		var str = J('#formFindPop').serialize();
		
		jQuery("#popList").jqGrid({
			url          :"$!{searchMap.txt2html("context")}/gov/measure/archiveMon/popMappingMetricList_xml.vw" + "?" + str,
			mtype        :"POST",
			datatype     :"json",
			jsonReader   : {   
    						page   : "page",
    						total  : "total",
    						root   : "rows",
    						records: function(obj){return obj.length;},
    						repeatitems: false, 
    						id     : "id"
    				       },
			height       : 350,
			colNames     :['$!{searchMap.txt2html("SC_DEPT_NM")}', '코드', '$!{searchMap.txt2html("METRIC_NM")}', '목표', '실적', '신호등'],
			colModel     :[
							{name:'SC_DEPT_NM'  	,index:'SC_DEPT_NM'   		,width:120   ,align:'left'   },
							{name:'METRIC_ID'  		,index:'METRIC_ID'   		,width:220   ,align:'left'   },
							{name:'METRIC_NM'  		,index:'METRIC_NM'   		,width:220   ,align:'left'   },
							{name:'TARGET'  		,index:'TARGET'   		    ,width:70    ,align:'right'  },
							{name:'ACTUAL'  	    ,index:'ACTUAL'          	,width:70    ,align:'right'  },
							{name:'STATUS'          ,index:'STATUS'  	        ,width:55    ,align:'center' ,	formatter:linkSignal}
							],
			rowNum       : 100000,
			autowidth    : false,
			viewrecords  : true,
			loadonce     : false,
			cellEdit     : true,
			cmTemplate	 : {sortable:false},
			caption:"조회"
		}).jqGrid('hideCol',"METRIC_ID");
		
	});
	
	/******************************************
	 * jqGrid 신호등
	 ******************************************/
	function linkSignal(cellvalue, options, rowObject) {
		return '<a href=javascript:goPopMetricActualDetail(' + options.rowId + ')><img name=\'sig\' src=\'$!{searchMap.txt2html("context")}/images/common/ball/ball_' + cellvalue + '.gif\' ></a>';
	}
	
	/*****************************************************
	 * 실적상세 팝업
	 *****************************************************/ 
    function goPopMetricActualDetail(rowId){
		var ret = J("#popList").jqGrid('getRowData',rowId);
		var metricId = ret.METRIC_ID;
		var year = J("#findYear :selected").val();
		var mon = J("#findMon :selected").val();
		var analCycle = "Y";
		
		var param = "&amp;year=" + year + "&amp;findMon=" + mon + "&amp;metricId=" + metricId + "&amp;analCycle="+analCycle;
		
		var url = "$!{searchMap.txt2html("context")}/bsc/mon/metricActualDetail/popMetricActualDetailList.vw?type=popup" + param;
		openWinByName(url,'popMetricDetail','1250','650','yes');
    }
	 
	

//]]>
</script>

<form id="formFindPop" name="formFindPop" method="post" action="$!{searchMap.txt2html("context")}/gov/measure/archiveMon/popMappingMetricList.vw?type=template">
	<input type="hidden" id="findYear"        name="findYear"        value="$!{searchMap.txt2html("findYear")}" />
	<input type="hidden" id="findMon"         name="findMon"         value="$!{searchMap.txt2html("findMon")}" />
	<input type="hidden" id="findGovMetricId" name="findGovMetricId" value="$!{searchMap.txt2html("findGovMetricId")}" />
	
    <div style="width:600px;height:400px;">
    	<div id="popMetricArea">
    		<h1 class="none">$!{searchMap.txt2html("METRIC_NM")} 조회</h1>
    		<div style="margin-left:30px;margin-bottom:10px;"></div>
    		<div id="userData" style="margin-left:15px;height:340px;width:450px;">
    			<!-- 데이터그리드 Start -->
    			<div class="blockGridListTable">
    				<table id="popList" summary="$!{searchMap.txt2html("METRIC_NM")}) 조회">
    					<caption class="none">$!{searchMap.txt2html("METRIC_NM")}) 조회</caption>
    					<thead><tr><th></th></tr></thead>
    					<tbody><tr><td></td></tr></tbody>
    				</table>
    				<div id="pager"></div>                    
    			</div>
    			<!--// 데이터그리드 End -->	
    		</div>
    	</div>
    </div>
</form>
