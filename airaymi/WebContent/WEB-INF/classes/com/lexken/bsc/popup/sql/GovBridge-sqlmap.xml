<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="bsc.popup.govBridge">

	<!--
	==================================================================
	  # 설명	: typeAlias 선언
	  #	기능	: SETTING
	  #	TABLE	:
	==================================================================
	-->
	<typeAlias alias="hashMap" 			type="java.util.HashMap" />

	<!--
	==================================================================
	  # 설명	: 시스템연계 인터페이스
	  #	기능	: SELECT
	  #	TABLE	: BSC_SYSTEM_ITEM
	==================================================================
	-->
	<select id="getDeptMetricInfo" parameterClass="hashMap" resultClass="hashMap">
		<![CDATA[
		SELECT A.*, B.SC_DEPT_ID
		  FROM (SELECT DISTINCT A.YEAR, B.METRIC_ID, A.URL
		          FROM BSC_SYSTEM_ITEM A, BSC_CAL_TYPE_COL B
		         WHERE A.YEAR = #findYear#
		           AND A.ITEM_CD = #findItemCd#
		           AND A.ITEM_ACTUAL_DIVI = '02'
		           AND A.ITEM_DIVI = '01'
		           AND A.YEAR = B.YEAR
		           AND A.ITEM_CD = B.ITEM_CD
		           AND B.INSERT_GUBUN = '01'
		           AND B.ITEM_CD LIKE 'S%') A
		     , BSC_METRIC B
		     , BSC_SC_DEPT C
		 WHERE A.YEAR = B.YEAR
		   AND A.METRIC_ID = B.METRIC_ID
		   AND B.YEAR = C.YEAR
		   AND B.SC_DEPT_ID = C.SC_DEPT_ID
		   AND B.DELETE_DT IS NULL
		   AND C.DELETE_DT IS NULL
		   AND ROWNUM < 2
		]]>
	</select>
</sqlMap>
