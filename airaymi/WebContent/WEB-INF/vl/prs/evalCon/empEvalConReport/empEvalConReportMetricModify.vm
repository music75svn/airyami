#*************************************************************************
* CLASS 명      : empEvalConReportModify
* 작 업 자      : 심준혁 
* 작 업 일      : 2014년 12월 22일 
* 기    능      : 업무성과기술서    
* ---------------------------- 변 경 이 력 --------------------------------
* 번호    작 업 자    작     업     일        변 경 내 용                비고
* ----  --------  -----------------  -------------------------  --------
*  1    심준혁      2014년 12월 22일             최 초 작 업 
**************************************************************************# 
<script type="text/javascript" language="javascript" >
//<![CDATA[

    var J = jQuery;

    J(document).ready(function(){
    
    	/******************************************
         * 테이블 rowspan(소타이틀)
         ******************************************/
		#set($listSize = $!{CS_HTML.txt2html($rptDetail.size())})
		var size = $listSize +1;
		#if($listSize == 0)
		J("#smallTitle").attr('rowspan', "2");
		#else
		J("#smallTitle").attr('rowspan', size);
		#end
    
        /******************************************
         * 취소버튼 (돌아가기)
         ******************************************/
        J("#btnBack").click(function() {
        	J("#mode").val("MOD");
            J("#form1").attr("action", "$!{context_path}/prs/evalCon/empEvalConReport/empEvalConReportModify.vw?type=template").submit();
        });
        
        /******************************************
         * 저장버튼 이벤트
         ******************************************/
        J("#btnInsert").click(function(e) {
            e.preventDefault();
            saveChk();
        });
        
        /******************************************
         * 저장버튼 이중 클릭 방지
         ******************************************/
        J("form").submit(function(){
            J("#btnInsert").unbind();
        });
        
        /******************************************
         * 목표/실적 숫자만 허용
         ******************************************/
        J("#targetValue").numeric({allow:"."});
		J("#targetValue").css("ime-mode", "disabled");
		J("#value").numeric({allow:"."});
		J("#value").css("ime-mode", "disabled");
        


    });

    /******************************************
     * 필수입력 체크
     ******************************************/
    function saveChk() {
    
    	if(J("#metricNm").val() == ""){
    		alert("지표명을 입력해 주세요.");
    		return;
    	}
    	
    	if(J("#targetValue").val() == ""){
    		alert("목표를 입력해 주세요.");
    		return;
    	}
    	
    	if(J("#value").val() == ""){
    		alert("실적을 입력해 주세요.");
    		return;
    	}
    
        J.showConfirmBox("저장하시겠습니까?", "saveDo"); //saveDo() 콜백함수 호출
    }
    
    /******************************************
     * 저장
     ******************************************/
    function saveDo() {
    	J("#mode").val("METRIC");
        J("#form1").attr("action", "$!{context_path}/prs/evalCon/empEvalConReport/empEvalConReportProcess.vw?type=template").submit();
    }
    
    /******************************************
     * 달성도 자동 계산
     ******************************************/
    function calScore(){
    
    	var directionCd = J("#directionCd").val();
    	var targetValue = J("#targetValue").val();
    	var value       = J("#value").val();
    	var score       = 0; 
    	
    	if(targetValue == ""){
    		targetValue = 0;
    	}
    	
    	if(value == ""){
    		value = 0;
    	}
    	
    	if(directionCd == "02"){
    		score = targetValue/value*100;
    	}else if(directionCd == "01"){
    		score = value/targetValue*100;
    	} 
    	
    	if(targetValue == 0 || value == 0){
    		score = 0;
    	}
    	
    	J("#score").val(score);
    }
    
//]]>
</script>    
 
<form id="form1" name="form1" method="post" action="$!{context_path}/prs/evalCon/empEvalConReport/empEvalConReportProcess.vw?type=template">
    <input type="hidden"     id="mode"            name="mode"              value="$!{searchMap.txt2html("mode")}" />
    <input type="hidden"     id="year"            name="year"              value="$!{searchMap.txt2html("findYear")}" />

    $!{searchMap.makeHiddenFind()}
    
    <div id="Table">
        <div id="Table_blockContainer">
            <div class="tableTop">
                #parse("/WEB-INF/vl/common/template/tabs.vm")
                <div class="clear"></div>
            </div>
            <div class="tableTop">
                <div class="clear"></div>
            </div>
            <div class="blockDetail">
		    <table summary="자기평가기술서 관리 등록">
		        <caption class="none">자기평가기술서 관리 등록</caption>
		        <colgroup>
		            <col width="10%" />
		            <col width="30%" />
		            <col width="10%" />
		            <col width="20%" />
		            <col width="10%" />
		            <col width="20%" />
		        </colgroup>
		       <tbody>
		       	<tr>
		            <td colspan="6" class="textCenter"><span>$!{CS_HTML.txt2html($rpt.YEAR)} 년도 직원 업무 성과 기술서</span></td>
		        </tr>
				<tr>
		            <th scope="row"><label for="posTcNm">소속부서</label></th>
		            <td>
		            	<span>$!{CS_HTML.txt2html($rpt.DEPT_NM)}</span>
		            	<input type="hidden" id="deptCd" name="deptCd" value="$!{CS_HTML.txt2html($rpt.DEPT_CD)}">
		            </td>
		            <th scope="row" rowspan="2"><label for="korNm">직급(직위)</label></th>
		            <td rowspan="2"><span>$!{CS_HTML.txt2html($rpt.CAST_TC_NM)}($!{CS_HTML.txt2html($rpt.POS_TC_NM)})</span></td>
		            <th scope="row" rowspan="2"><label for="deptKorNm">성명</label></th>
		            <td rowspan="2">
		            	<span>$!{CS_HTML.txt2html($rpt.KOR_NM)}</span>
		           		<input type="hidden" id="evalMembEmpn" name="evalMembEmpn" value="$!{CS_HTML.txt2html($rpt.EMPN)}">
		            </td>
		        </tr>
				<tr>
					<th scope="row"><label for="approveUserNm">현부서전입일</label></th>
		            <td><span>$!{CS_HTML.txt2html($rpt.DUTY_FROM_DT)}</span></td>
		        </tr>
				<tr>
		            <th scope="row"><label for="approveUserNm">직무 수행기간</label></th>
		            <td colspan="5"><span>$!{CS_HTML.txt2html($rpt.DUTY_FROM_DT)} ~ $!{CS_HTML.txt2html($rpt.DUTY_END_DT)}</span></td>
		        </tr>
		    </tbody>
		    </table>
		    </div>
            <div class="blockDetail">
                <table summary="성과계획 및 실적">
					<caption class="none">성과계획 및 실적</caption>
					<colgroup>
						<col width="15%" />
						<col width="85%" />
					</colgroup>
					<tbody>
						 <tr>
		                     <th><span class="txt_red">(*)</span><label for="metricGubun">지표구분</label></th>
		                     <td>
		                     	<select id="metricGubun" name="metricGubun" class="select w210">
                                    $!CS_CODE.getCodeOption("229", "", $!{searchMap.txt2html("year")})   
                                </select>	
		                     </td>
		                 </tr>
		                 <tr>
		                     <th><span class="txt_red">(*)</span><label for="metricNm">지표명</label></th>
		                     <td>
		                     	<input type="text" id="metricNm" name="metricNm" class="inputbox w500" value="$!{CS_HTML.txt2html($detail.METRIC_NM)}" maxlength="150"/>	
		                     </td>
		                 </tr>
		                 <tr>
		                     <th><span class="txt_red">(*)</span><label for="directionCd">지표특성(방향성)</label></th>
		                     <td>
		                     	<select id="directionCd" name="directionCd" class="select w210" onchange="javascript:calScore();">
                                    $!CS_CODE.getCodeOption("145", "", $!{searchMap.txt2html("year")})   
                                </select>	
		                     </td>
		                 </tr>
		                 <tr>
		                     <th><span class="txt_red">(*)</span><label for="unit">단위</label></th>
		                     <td>
		                     	<select id="unit" name="unit" class="select w210" >
                                    $!CS_CODE.getCodeOption("013", "", $!{searchMap.txt2html("year")})   
                                </select>	
		                     </td>
		                 </tr>
		                 <tr>
		                     <th><span class="txt_red">(*)</span><label for="targetValue">목표</label></th>
		                     <td>
		                     	<input type="text" id="targetValue" name="targetValue" maxlength="5" onkeyup="javascript:calScore();" class="inputbox w100" value="$!{CS_HTML.txt2html($detail.TARGET_VALUE)}"/>	
		                     </td>
		                 </tr>
		                 <tr>
		                     <th><span class="txt_red">(*)</span><label for="value">실적</label></th>
		                     <td>
		                     	<input type="text" id="value" name="value" class="inputbox w100" maxlength="5" onkeyup="javascript:calScore();" value="$!{CS_HTML.txt2html($detail.VALUE)}"/>	
		                     </td>
		                 </tr>
		                 <tr>
		                     <th><span class="txt_red">(*)</span><label for="score">달성도</label></th>
		                     <td>
		                     	<input type="text" id="score" name="score" class="inputbox w100" value="$!{CS_HTML.txt2html($detail.SCORE)}" readonly="readonly"/>	
		                     </td>
		                 </tr>
		                 <tr>
		                     <th><label for="sortOrder">정렬순서</label></th>
		                     <td>
		                     	<input type="text" id="sortOrder" name="sortOrder" class="inputbox w100" value="$!{CS_HTML.txt2html($detail.SORT_ORDER)}"/>	
		                     </td>
		                 </tr>
		    		</tbody>
				</table>
				</div>
            </div>
            <div class="blockButton"> 
                <ul>
                    <li><input type="button" id="btnBack"   value="돌아가기" /></li>
                    <li><input type="submit" id="btnInsert" value="저장" /></li>
                </ul>
            </div>    
        </div>
        <div class="clear"></div>
    </div>
</form>
