<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="bsc.popup.regularInsp">

	<!--
	==================================================================   
	  # 설명	: typeAlias 선언
	  #	기능	: SETTING
	  #	TABLE	: 
	==================================================================
	-->
	<typeAlias alias="hashMap" 			type="java.util.HashMap" />

	<!--
	==================================================================   
	  # 설명	: 시스템 연계 부서 목록 보기
	  #	기능	: SELECT
	  #	TABLE	: 
	==================================================================
	-->
	<select id="getDeptInfo" parameterClass="hashMap" resultClass="hashMap">
		SELECT A.DEPT_ID, B.DEPT_NM
		  FROM BSC_SC_DEPT_MAPPING A
	LEFT OUTER JOIN BSC_DEPTINFO B
			ON A.DEPT_ID = B.DEPT_ID
		 WHERE (YEAR, SC_DEPT_ID) IN
		          (SELECT YEAR, SC_DEPT_ID
		             FROM BSC_METRIC
		            WHERE (METRIC_GRP_ID, YEAR) IN
		                     (SELECT METRIC_GRP_ID, YEAR
		                        FROM BSC_METRIC
		                       WHERE YEAR = #findYear# AND METRIC_ID = #findMetricId#)
		              AND DELETE_DT IS NULL)
<![CDATA[		   AND OULEVEL < 2 ]]>
	</select>
	
	<!--
	==================================================================   
	  # 설명	: 시스템 연계 부서 목록 보기
	  #	기능	: SELECT
	  #	TABLE	: 
	==================================================================
	-->
	<select id="getScDeptMapping" parameterClass="hashMap" resultClass="java.lang.String">
		SELECT DEPT_ID
		  FROM ( SELECT DEPT_ID 
				   FROM BSC_SC_DEPT_MAPPING
				  WHERE YEAR = #findYear# 
				    AND SC_DEPT_ID = #findScDeptCd# ORDER BY DEPT_ID )
		 WHERE ROWNUM = 1
	</select>
	
	<!--
	==================================================================   
	  # 설명	: 시스템 연계데이터 조회 목록 보기
	  #	기능	: SELECT
	  #	TABLE	: 
	==================================================================
	-->
	<select id="getList" parameterClass="hashMap" resultClass="hashMap">
		<!-- 고액법사용시설 검사대상(S001D001) -->
		<isEqual property="findItemCd" compareValue="S001D001">
	    	SELECT A.YEAR
		         , A.DEPT_CD
		         , B.DEPT_NM
		         , A.PERM_TC
		         , (SELECT COMM_C_NM FROM MAORA01.MDA0000M WHERE 1 = 1 AND SYS_TC = 'GIZ'  AND KIND_TC IN ('0003') AND USE_YN = 'T' AND COMM_C = A.PERM_TC) PERM_TC_NM
		         , A.IMP_GUBUN
		         , A.CO_NO
		         , A.EQUI_NO
		         , A.EQUI_NM
		         , A.CO_NM
		         , A.BSNO
		         , A.ADDR
		         , A.INSP_NM
		         , A.SER
		         , TO_CHAR(TO_DATE(A.INSP_PLAN_DATE), 'YYYY-MM-DD') INSP_PLAN_DATE
		         , SUBSTR(A.INSP_PLAN_DATE, 5, 2) INSP_MON
		         , TO_CHAR(TO_DATE(A.REAL_INSP_DATE), 'YYYY-MM-DD') REAL_INSP_DATE
		         , A.FORE_COMS
		         , A.IMP_COMS
		         , A.RMK
		         , A.PROC_TC
		         , A.PROC_NM
		         , A.IMP_CD
			  FROM V_GHF0301M_001 A
		      LEFT OUTER JOIN BSC_DEPTINFO B
		       	ON A.DEPT_CD = B.DEPT_ID
			 WHERE A.YEAR = #findYear#
		       <isNotEmpty prepend="AND" property="findMon">
			       SUBSTR(A.INSP_PLAN_DATE, 5, 2)  = #findMon#
		       </isNotEmpty>
		       AND A.DEPT_CD = #findDeptId#
		       <!-- AND A.PROC_TC IS NULL
	           AND A.RMK IS NULL -->
	           AND A.PERM_TC IN ('101', '102')
	           AND A.CO_STAT_TC = '0'
	           AND A.INSP_PLAN_DATE IS NOT NULL
		 	 ORDER BY A.DEPT_CD, A.INSP_PLAN_DATE
		</isEqual>
		
		<!-- 고액법사용시설 검사실적(S001D002) -->
		<isEqual property="findItemCd" compareValue="S001D002">
	    	SELECT A.YEAR
		         , A.DEPT_CD
		         , B.DEPT_NM
		         , A.PERM_TC
		         , (SELECT COMM_C_NM FROM MAORA01.MDA0000M WHERE 1 = 1 AND SYS_TC = 'GIZ'  AND KIND_TC IN ('0003') AND USE_YN = 'T' AND COMM_C = A.PERM_TC) PERM_TC_NM
		         , A.IMP_GUBUN
		         , A.CO_NO
		         , A.EQUI_NO
		         , A.EQUI_NM
		         , A.CO_NM
		         , A.BSNO
		         , A.ADDR
		         , A.INSP_NM
		         , A.SER
		         , TO_CHAR(TO_DATE(A.INSP_PLAN_DATE), 'YYYY-MM-DD') INSP_PLAN_DATE
		         , SUBSTR(A.INSP_PLAN_DATE, 5, 2) INSP_MON
		         , TO_CHAR(TO_DATE(A.REAL_INSP_DATE), 'YYYY-MM-DD') REAL_INSP_DATE
		         , A.FORE_COMS
		         , A.IMP_COMS
		         , A.RMK
		         , A.PROC_TC
		         , A.PROC_NM
		         , A.IMP_CD
			  FROM V_GHF0301M_001 A
		      LEFT OUTER JOIN BSC_DEPTINFO B
		       	ON A.DEPT_CD = B.DEPT_ID
			 WHERE A.YEAR = #findYear#
		       <isNotEmpty prepend="AND" property="findMon">
			       SUBSTR(A.REAL_INSP_DATE, 5, 2)  = #findMon#
		       </isNotEmpty>
		       AND A.DEPT_CD = #findDeptId#
		       <!-- AND A.PROC_TC IS NULL
	           AND A.RMK IS NULL  -->
	           AND A.PERM_TC IN ('101', '102')
	           AND A.CO_STAT_TC = '0'
	           AND A.REAL_INSP_DATE IS NOT NULL
		 	 ORDER BY A.DEPT_CD, A.REAL_INSP_DATE
		</isEqual>
		
		<!-- 도법사용시설 검사대상(S001D003) -->
		<isEqual property="findItemCd" compareValue="S001D003">
	    	SELECT A.YEAR
		         , A.DEPT_CD
		         , B.DEPT_NM
		         , A.PERM_TC
		         , (SELECT COMM_C_NM FROM MAORA01.MDA0000M WHERE 1 = 1 AND SYS_TC = 'GIZ'  AND KIND_TC IN ('0003') AND USE_YN = 'T' AND COMM_C = A.PERM_TC) PERM_TC_NM
		         , A.IMP_GUBUN
		         , A.CO_NO
		         , A.EQUI_NO
		         , A.EQUI_NM
		         , A.CO_NM
		         , A.BSNO
		         , A.ADDR
		         , A.INSP_NM
		         , A.SER
		         , TO_CHAR(TO_DATE(A.INSP_PLAN_DATE), 'YYYY-MM-DD') INSP_PLAN_DATE
		         , SUBSTR(A.INSP_PLAN_DATE, 5, 2) INSP_MON
		         , TO_CHAR(TO_DATE(A.REAL_INSP_DATE), 'YYYY-MM-DD') REAL_INSP_DATE
		         , A.FORE_COMS
		         , A.IMP_COMS
		         , A.RMK
		         , A.PROC_TC
		         , A.PROC_NM
		         , A.IMP_CD
			  FROM V_GHF0301M_001 A
		      LEFT OUTER JOIN BSC_DEPTINFO B
		       	ON A.DEPT_CD = B.DEPT_ID
			 WHERE A.YEAR = #findYear#
		       <isNotEmpty prepend="AND" property="findMon">
			       SUBSTR(A.INSP_PLAN_DATE, 5, 2)  = #findMon#
		       </isNotEmpty>
		       AND A.DEPT_CD = #findDeptId#
		       <!-- AND A.PROC_TC IS NULL
	           AND A.RMK IS NULL -->
	           AND A.PERM_TC IN ('103')
	           AND A.CO_STAT_TC = '0'
	           AND A.INSP_PLAN_DATE IS NOT NULL
		 	 ORDER BY A.DEPT_CD, A.INSP_PLAN_DATE
		</isEqual>
		
		<!-- 도법사용시설 검사실적 : S001D004 -->
		<isEqual property="findItemCd" compareValue="S001D004">
	    	SELECT A.YEAR
		         , A.DEPT_CD
		         , B.DEPT_NM
		         , A.PERM_TC
		         , (SELECT COMM_C_NM FROM MAORA01.MDA0000M WHERE 1 = 1 AND SYS_TC = 'GIZ'  AND KIND_TC IN ('0003') AND USE_YN = 'T' AND COMM_C = A.PERM_TC) PERM_TC_NM
		         , A.IMP_GUBUN
		         , A.CO_NO
		         , A.EQUI_NO
		         , A.EQUI_NM
		         , A.CO_NM
		         , A.BSNO
		         , A.ADDR
		         , A.INSP_NM
		         , A.SER
		         , TO_CHAR(TO_DATE(A.INSP_PLAN_DATE), 'YYYY-MM-DD') INSP_PLAN_DATE
		         , SUBSTR(A.INSP_PLAN_DATE, 5, 2) INSP_MON
		         , TO_CHAR(TO_DATE(A.REAL_INSP_DATE), 'YYYY-MM-DD') REAL_INSP_DATE
		         , A.FORE_COMS
		         , A.IMP_COMS
		         , A.RMK
		         , A.PROC_TC
		         , A.PROC_NM
		         , A.IMP_CD
			  FROM V_GHF0301M_001 A
		      LEFT OUTER JOIN BSC_DEPTINFO B
		       	ON A.DEPT_CD = B.DEPT_ID
			 WHERE A.YEAR = #findYear#
		       <isNotEmpty prepend="AND" property="findMon">
			       SUBSTR(A.REAL_INSP_DATE, 5, 2)  = #findMon#
		       </isNotEmpty>
		       AND A.DEPT_CD = #findDeptId#
		       <!-- AND A.PROC_TC IS NULL
	           AND A.RMK IS NULL -->
	           AND A.PERM_TC IN ('103')
	           AND A.CO_STAT_TC = '0'
	           AND A.REAL_INSP_DATE IS NOT NULL
		 	 ORDER BY A.DEPT_CD, A.REAL_INSP_DATE
		</isEqual>
	</select>
	
	<!--
	==================================================================   
	  # 설명	: 시스템 연계항목 정보를 가져옴
	  #	기능	: SELECT
	  #	TABLE	: 
	==================================================================
	-->
	<select id="getItem" remapResults="true" parameterClass="hashMap" resultClass="hashMap">
          SELECT A.ITEM_CD, B.CAL_TYPE_COL_NM
            FROM BSC_SYSTEM_ITEM A
               , BSC_CAL_TYPE_COL B
           WHERE A.YEAR = #findYear#
             AND A.YEAR = B.YEAR
             AND A.ITEM_CD = B.ITEM_CD
             AND B.METRIC_ID = #findMetricId#
             AND B.INSERT_GUBUN = '01'
           ORDER BY B.CAL_TYPE_COL_NM
	</select>
	
	<!--
	==================================================================   
	  # 설명	: 시스템 연계데이터 조회 목록 보기
	  #	기능	: SELECT
	  #	TABLE	: 
	==================================================================
	-->
	<select id="getList2" parameterClass="hashMap" resultClass="hashMap">
		<!-- 가스시설검사 실적(S076D001) -->
		<isEqual property="findItemCd" compareValue="S076D001">
	    	SELECT A.YEAR
        		 , A.DEPT_CD            
                 , B.DEPT_NM
                 , A.PERM_TC
		         , (SELECT COMM_C_NM 
		              FROM MAORA01.MDA0000M 
		             WHERE 1 = 1 
		               AND SYS_TC = 'GIZ'  
		               AND KIND_TC IN ( '0003') 
		               AND USE_YN = 'T' 
		               AND COMM_C = A.PERM_TC) PERM_TC_NM
		         , A.IMP_GUBUN
		         , A.CO_NO
		         , A.EQUI_NO
		         , A.EQUI_NM
		         , A.CO_NM
		         , A.BSNO
		         , A.ADDR
		         , A.INSP_NM
		         , A.SER
		         <!-- , TO_CHAR(TO_DATE(A.INSP_PLAN_DATE), 'YYYY-MM-DD') INSP_PLAN_DATE -->
		         , A.INSP_PLAN_DATE
		         , SUBSTR(A.INSP_PLAN_DATE,5,2) INSP_MON
		         <!-- , TO_CHAR(TO_DATE(A.REAL_INSP_DATE), 'YYYY-MM-DD') REAL_INSP_DATE -->
		         , A.REAL_INSP_DATE
		         , A.FORE_COMS
		         , A.IMP_COMS
		         , A.RMK 
		         , A.PROC_TC
		         , A.PROC_NM  
		         , A.IMP_CD      
		      FROM ( SELECT YEAR
		      			  , DEPT_CD            
		        		  , PERM_TC            
		        		  , (SELECT COMM_C_NM 
		                       FROM MAORA01.MDA0000M 
		        	          WHERE 1 = 1 
		                        AND SYS_TC = 'GIZ'  
		                        AND KIND_TC IN ('0003') 
		                		AND USE_YN = 'T' 
		                		AND COMM_C = PERM_TC) PERM_TC_NM
		         		  , IMP_GUBUN            
		         		  , CO_NO            
		         		  , EQUI_NO            
		         		  , EQUI_NM            
		         		  , CO_NM            
		         		  , BSNO            
		         		  , ADDR            
		         		  , INSP_NM            
		         		  , SER            
		        		  , INSP_PLAN_DATE                   
				          , REAL_INSP_DATE            
				          , FORE_COMS            
				          , IMP_COMS            
				          , RMK            
				          , PROC_TC            
				          , PROC_NM            
				          , IMP_CD  
				       FROM V_GHF0301M_001
					  WHERE YEAR = #findYear#
					    AND REAL_INSP_DATE IS NOT NULL
					    AND SUBSTR(REAL_INSP_DATE,5,2) = #findMon#
					    AND CO_STAT_TC = '0'
					    AND PERM_TC IN ('101','102','103')
					    AND DEPT_CD = #findDeptId#
					  UNION ALL
					 SELECT YEAR
		      			  , DEPT_CD            
		        		  , PERM_TC            
		        		  , (SELECT COMM_C_NM 
		                       FROM MAORA01.MDA0000M 
		        	          WHERE 1 = 1 
		                        AND SYS_TC = 'GIZ'  
		                        AND KIND_TC IN ('0003') 
		                		AND USE_YN = 'T' 
		                		AND COMM_C = PERM_TC) PERM_TC_NM
		         		  , IMP_GUBUN            
		         		  , CO_NO            
		         		  , EQUI_NO            
		         		  , EQUI_NM            
		         		  , CO_NM            
		         		  , BSNO            
		         		  , ADDR            
		         		  , INSP_NM            
		         		  , SER            
		        		  , INSP_PLAN_DATE                   
				          , REAL_INSP_DATE           
				          , FORE_COMS            
				          , IMP_COMS            
				          , RMK            
				          , PROC_TC            
				          , PROC_NM            
				          , IMP_CD    
					   FROM V_GHF0301M_001
					  WHERE YEAR = #findYear#
					    AND REAL_INSP_DATE IS NOT NULL
					    AND SUBSTR(REAL_INSP_DATE,5,2) = #findMon#
					    <![CDATA[ 
					    AND PERM_TC <> '042'
						]]>
					    AND IMP_GUBUN = '1501'
					    AND DEPT_CD = #findDeptId#
					    AND CO_STAT_TC = '0'
				      UNION ALL
					 SELECT YEAR
		      			  , DEPT_CD            
		        		  , PERM_TC            
		        		  , (SELECT COMM_C_NM 
		                       FROM MAORA01.MDA0000M 
		        	          WHERE 1 = 1 
		                        AND SYS_TC = 'GIZ'  
		                        AND KIND_TC IN ('0003') 
		                		AND USE_YN = 'T' 
		                		AND COMM_C = PERM_TC) PERM_TC_NM
		         		  , IMP_GUBUN            
		         		  , CO_NO            
		         		  , EQUI_NO            
		         		  , EQUI_NM            
		         		  , CO_NM            
		         		  , BSNO            
		         		  , ADDR            
		         		  , INSP_NM            
		         		  , SER            
		        		  , INSP_PLAN_DATE                   
				          , REAL_INSP_DATE          
				          , FORE_COMS            
				          , IMP_COMS            
				          , RMK            
				          , PROC_TC            
				          , PROC_NM            
				          , IMP_CD    
				       FROM V_GHF0301M_001
					  WHERE YEAR = #findYear#
					    AND (
				             (IMP_GUBUN = '0104' AND PERM_TC IN ('011', '021', '031', '041', '042', '043', '061', '062', '072', '081', '082', '092', '211', '221', '231')) 
				              OR (IMP_GUBUN = '1501' AND PERM_TC IN ('042')
				              )
					         )
					    AND REAL_INSP_DATE IS NOT NULL
					    AND SUBSTR(REAL_INSP_DATE, 5, 2) = #findMon#
					    AND RMK IS NULL 
					    <!-- AND PROC_TC IS NULL -->
					    AND DEPT_CD = #findDeptId#
					    AND CO_STAT_TC = '0'
					  UNION ALL
					 SELECT YY AS YEAR 
					      , BR_CD DEPT_CD           
		        		  , PERM_TC            
		        		  , (SELECT COMM_C_NM 
		                       FROM MAORA01.MDA0000M 
		        	          WHERE 1 = 1 
		                        AND SYS_TC = 'GIZ'  
		                        AND KIND_TC IN ('0003') 
		                		AND USE_YN = 'T' 
		                		AND COMM_C = PERM_TC) PERM_TC_NM
		         		  , IMP_GUBUN            
		         		  , CO_NO            
		         		  , EQUI_NO            
		         		  , EQUI_NM            
		         		  , CO_NM            
		         		  , BSNO            
		         		  , ADDR            
		         		  , INSP_NM            
		         		  , SER            
		        		  , INSP_PLAN_DATE                   
				          , REAL_INSP_DATE          
				          , FORE_COMS            
				          , IMP_COMS            
				          , RMK            
				          , PROC_TC            
				          , PROC_NM            
				          , IMP_CD   
				       FROM V_GHF0311M_001 
                      WHERE YY = #findYear#
                        AND REAL_INSP_DATE IS NOT NULL
                        AND SUBSTR(REAL_INSP_DATE, 5, 2) = #findMon#
                        AND RMK IS NULL 
                        <!-- AND PROC_TC IS NULL -->
                        AND EQUI_TC IN (1, 2, 3)       
                        AND BR_CD = #findDeptId#
                    ) A
			 LEFT OUTER JOIN
		      BSC_DEPTINFO B
		       ON A.DEPT_CD = B.DEPT_ID     
		    ORDER BY A.DEPT_CD
		           , A.REAL_INSP_DATE    
		</isEqual>
		
		<!-- 가스시설검사 대상 (S076D002) -->
		<isEqual property="findItemCd" compareValue="S076D002">
	    	SELECT A.YEAR
                 , A.DEPT_CD            
                 , B.DEPT_NM
                 , A.PERM_TC
                 , (SELECT COMM_C_NM 
                      FROM MAORA01.MDA0000M 
                     WHERE 1 = 1 
                       AND SYS_TC = 'GIZ'  
                       AND KIND_TC IN ( '0003') 
                       AND USE_YN = 'T' 
                       AND COMM_C = A.PERM_TC) PERM_TC_NM
                 , A.IMP_GUBUN
                 , A.CO_NO
                 , A.EQUI_NO
                 , A.EQUI_NM
                 , A.CO_NM
                 , A.BSNO
                 , A.ADDR
                 , A.INSP_NM
                 , A.SER
                 <!-- , TO_CHAR(TO_DATE(A.INSP_PLAN_DATE), 'YYYY-MM-DD') INSP_PLAN_DATE -->
		         , A.INSP_PLAN_DATE
		         , SUBSTR(A.INSP_PLAN_DATE,5,2) INSP_MON
		         <!-- , TO_CHAR(TO_DATE(A.REAL_INSP_DATE), 'YYYY-MM-DD') REAL_INSP_DATE -->
		         , A.REAL_INSP_DATE
                 , A.FORE_COMS
                 , A.IMP_COMS
                 , A.RMK 
                 , A.PROC_TC
                 , A.PROC_NM  
                 , A.IMP_CD      
              FROM ( SELECT YEAR
                            , DEPT_CD            
                          , PERM_TC            
                          , (SELECT COMM_C_NM 
                               FROM MAORA01.MDA0000M 
                              WHERE 1 = 1 
                                AND SYS_TC = 'GIZ'  
                                AND KIND_TC IN ('0003') 
                                AND USE_YN = 'T' 
                                AND COMM_C = PERM_TC) PERM_TC_NM
                           , IMP_GUBUN            
                           , CO_NO            
                           , EQUI_NO            
                           , EQUI_NM            
                           , CO_NM            
                           , BSNO            
                           , ADDR            
                           , INSP_NM            
                           , SER            
                          , INSP_PLAN_DATE                   
				          , REAL_INSP_DATE         
                          , FORE_COMS            
                          , IMP_COMS            
                          , RMK            
                          , PROC_TC            
                          , PROC_NM            
                          , IMP_CD  
                       FROM V_GHF0301M_001
                      WHERE YEAR = #findYear#
                        AND INSP_PLAN_DATE IS NOT NULL
                        AND SUBSTR(INSP_PLAN_DATE,5,2) = #findMon#
                        AND CO_STAT_TC = '0'
                        AND PERM_TC IN ('101','102','103')
                        AND DEPT_CD = #findDeptId#
                      UNION ALL
                     SELECT YEAR
                            , DEPT_CD            
                          , PERM_TC            
                          , (SELECT COMM_C_NM 
                               FROM MAORA01.MDA0000M 
                              WHERE 1 = 1 
                                AND SYS_TC = 'GIZ'  
                                AND KIND_TC IN ('0003') 
                                AND USE_YN = 'T' 
                                AND COMM_C = PERM_TC) PERM_TC_NM
                           , IMP_GUBUN            
                           , CO_NO            
                           , EQUI_NO            
                           , EQUI_NM            
                           , CO_NM            
                           , BSNO            
                           , ADDR            
                           , INSP_NM            
                           , SER            
                          , INSP_PLAN_DATE                   
				          , REAL_INSP_DATE            
                          , FORE_COMS            
                          , IMP_COMS            
                          , RMK            
                          , PROC_TC            
                          , PROC_NM            
                          , IMP_CD    
                       FROM V_GHF0301M_001
                      WHERE YEAR = #findYear#
                        AND INSP_PLAN_DATE IS NOT NULL
                        AND SUBSTR(INSP_PLAN_DATE,5,2) = #findMon#
                        <![CDATA[ 
					    AND PERM_TC <> '042'
						]]>
                        AND IMP_GUBUN = '1501'
                        AND DEPT_CD = #findDeptId#
                        AND CO_STAT_TC = '0'
                      UNION ALL
                     SELECT YEAR
                            , DEPT_CD            
                          , PERM_TC            
                          , (SELECT COMM_C_NM 
                               FROM MAORA01.MDA0000M 
                              WHERE 1 = 1 
                                AND SYS_TC = 'GIZ'  
                                AND KIND_TC IN ('0003') 
                                AND USE_YN = 'T' 
                                AND COMM_C = PERM_TC) PERM_TC_NM
                           , IMP_GUBUN            
                           , CO_NO            
                           , EQUI_NO            
                           , EQUI_NM            
                           , CO_NM            
                           , BSNO            
                           , ADDR            
                           , INSP_NM            
                           , SER            
                          , INSP_PLAN_DATE                   
				          , REAL_INSP_DATE        
                          , FORE_COMS            
                          , IMP_COMS            
                          , RMK            
                          , PROC_TC            
                          , PROC_NM            
                          , IMP_CD    
                       FROM V_GHF0301M_001
                      WHERE YEAR = #findYear#
                        AND (
                             (IMP_GUBUN = '0104' AND PERM_TC IN ('011', '021', '031', '041', '042', '043', '061', '062', '072', '081', '082', '092', '211', '221', '231')) 
                              OR (IMP_GUBUN = '1501' AND PERM_TC IN ('042')
                              )
                             )
                        AND INSP_PLAN_DATE IS NOT NULL
                        AND SUBSTR(INSP_PLAN_DATE, 5, 2) = #findMon#
                        AND RMK IS NULL 
                        <!-- AND PROC_TC IS NULL -->
                        AND DEPT_CD = #findDeptId#
                        AND CO_STAT_TC = '0'
                      UNION ALL
                     SELECT YY AS YEAR 
                          , BR_CD DEPT_CD           
                          , PERM_TC            
                          , (SELECT COMM_C_NM 
                               FROM MAORA01.MDA0000M 
                              WHERE 1 = 1 
                                AND SYS_TC = 'GIZ'  
                                AND KIND_TC IN ('0003') 
                                AND USE_YN = 'T' 
                                AND COMM_C = PERM_TC) PERM_TC_NM
                           , IMP_GUBUN            
                           , CO_NO            
                           , EQUI_NO            
                           , EQUI_NM            
                           , CO_NM            
                           , BSNO            
                           , ADDR            
                           , INSP_NM            
                           , SER            
                          , INSP_PLAN_DATE                   
				          , REAL_INSP_DATE         
                          , FORE_COMS            
                          , IMP_COMS            
                          , RMK            
                          , PROC_TC            
                          , PROC_NM            
                          , IMP_CD   
                       FROM V_GHF0311M_001 
                      WHERE YY = #findYear#
                        AND INSP_PLAN_DATE IS NOT NULL
                        AND SUBSTR(INSP_PLAN_DATE, 5, 2) = #findMon#
                        AND RMK IS NULL 
                        <!-- AND PROC_TC IS NULL -->
                        AND EQUI_TC IN (1, 2, 3)       
                        AND BR_CD = #findDeptId#
                    ) A
             LEFT OUTER JOIN
              BSC_DEPTINFO B
               ON A.DEPT_CD = B.DEPT_ID     
            ORDER BY A.DEPT_CD
                   , A.INSP_PLAN_DATE 
		</isEqual>
		
	</select>
	
</sqlMap>


