<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="bsc.popup.laborCost">

	<!--
	==================================================================
	  # 설명	: typeAlias 선언
	  #	기능	: SETTING
	  #	TABLE	:
	==================================================================
	-->
	<typeAlias alias="hashMap" 			type="java.util.HashMap" />

	<!--
	==================================================================
	  # 설명	: 기본급
	  #	기능	: SELECT
	  #	TABLE	: V_HEA0101M_002
	==================================================================
	-->
	<select id="S070D001" parameterClass="hashMap" resultClass="hashMap">
			SELECT A.SLRY_YM, A.EMPN, A.KOR_NM, A.DEPT_CD, A.CAST_TC
                 , (SELECT UP_DEPT_NM || ' ' || DEPT_F_NM FROM V_DEPTINFO WHERE DEPT_ID = A.DEPT_CD) DEPT_NM
                 , (SELECT CODE_NM FROM BSC_CODE WHERE CODE_GRP_ID = '170' AND YEAR = #findYear# AND A.CAST_TC = CODE_ID) CAST_TC_NM
                 , SUM(A.E00) E00, SUM(A.E01) E01, SUM(A.E02) E02, SUM(A.E03) E03, SUM(A.E00 + A.E01 + A.E02 + A.E03) TOTAL
			  FROM V_HEA0101M_002 A
			 WHERE SLRY_YM = #findYear# || #findMon#
			 GROUP BY A.SLRY_YM, A.EMPN, A.KOR_NM, A.DEPT_CD, A.CAST_TC
			 ORDER BY A.KOR_NM
	</select>

	<!--
	==================================================================
	  # 설명	: 제수당
	  #	기능	: SELECT
	  #	TABLE	: V_HEA0101M_002
	==================================================================
	-->
	<select id="S070D002" parameterClass="hashMap" resultClass="hashMap">
			SELECT A.SLRY_YM, A.EMPN, A.KOR_NM, A.DEPT_CD, A.CAST_TC
                 , (SELECT UP_DEPT_NM || ' ' || DEPT_F_NM FROM V_DEPTINFO WHERE DEPT_ID = A.DEPT_CD) DEPT_NM
                 , (SELECT CODE_NM FROM BSC_CODE WHERE CODE_GRP_ID = '170' AND YEAR = #findYear# AND A.CAST_TC = CODE_ID) CAST_TC_NM
                 , SUM(A.E41) E41, SUM(A.E42) E42, SUM(A.E51) E51, SUM(A.E52) E52, SUM(A.E53) E53, SUM(A.E61) E61, SUM(A.E71) E71, SUM(A.E72) E72
                 , SUM(A.E73) E73, SUM(A.E74) E74, SUM(A.E75) E75, SUM(A.E76) E76, SUM(A.E81) E81, SUM(A.E82) E82, SUM(A.E84) E84, SUM(A.E85) E85, SUM(A.E99) E99
                 , SUM(A.E41 + A.E42 + A.E51 + A.E52 + A.E53 + A.E61 + A.E71 + A.E72 + A.E73 + A.E74 + A.E75 + A.E76 + A.E81 + A.E82 + A.E84 + A.E85 + A.E99) TOTAL
			  FROM V_HEA0101M_002 A
			 WHERE SLRY_YM = #findYear# || #findMon#
			 GROUP BY A.SLRY_YM, A.EMPN, A.KOR_NM, A.DEPT_CD, A.CAST_TC
			 ORDER BY A.KOR_NM
	</select>
	
	<!--
	==================================================================
	  # 설명	: 성과연봉
	  #	기능	: SELECT
	  #	TABLE	: V_HEA0101M_002
	==================================================================
	-->
	<select id="S070D003" parameterClass="hashMap" resultClass="hashMap">
			SELECT A.SLRY_YM, A.EMPN, A.KOR_NM, A.DEPT_CD, A.CAST_TC
                 , (SELECT UP_DEPT_NM || ' ' || DEPT_F_NM FROM V_DEPTINFO WHERE DEPT_ID = A.DEPT_CD) DEPT_NM
                 , (SELECT CODE_NM FROM BSC_CODE WHERE CODE_GRP_ID = '170' AND YEAR = #findYear# AND A.CAST_TC = CODE_ID) CAST_TC_NM
                 , SUM(A.E13) E13, SUM(A.E13) TOTAL
			  FROM V_HEA0101M_002 A
			 WHERE SLRY_YM = #findYear# || #findMon#
			 GROUP BY A.SLRY_YM, A.EMPN, A.KOR_NM, A.DEPT_CD, A.CAST_TC
			 ORDER BY A.KOR_NM
	</select>
	
	<!--
	==================================================================
	  # 설명	: 경영평가성과급(전환금+추가금)
	  #	기능	: SELECT
	  #	TABLE	: V_HEA0101M_002
	==================================================================
	-->
	<select id="S070D004" parameterClass="hashMap" resultClass="hashMap">
			SELECT A.SLRY_YM, A.EMPN, A.KOR_NM, A.DEPT_CD, A.CAST_TC
                 , (SELECT UP_DEPT_NM || ' ' || DEPT_F_NM FROM V_DEPTINFO WHERE DEPT_ID = A.DEPT_CD) DEPT_NM
                 , (SELECT CODE_NM FROM BSC_CODE WHERE CODE_GRP_ID = '170' AND YEAR = #findYear# AND A.CAST_TC = CODE_ID) CAST_TC_NM
                 , SUM(A.E35) E35, SUM(A.E36) E36, SUM(A.E35 + A.E36) TOTAL
			  FROM V_HEA0101M_002 A
			 WHERE SLRY_YM = #findYear# || #findMon#
			 GROUP BY A.SLRY_YM, A.EMPN, A.KOR_NM, A.DEPT_CD, A.CAST_TC
			 ORDER BY A.KOR_NM
	</select>

	<!--
	==================================================================
	  # 설명	: 퇴직급여충담금
	  #	기능	: SELECT
	  #	TABLE	: V_ABA0301M_001
	==================================================================
	-->
	<select id="S070D005" parameterClass="hashMap" resultClass="hashMap">
			SELECT ACNT_YM, ACCT_CD, ACCT_NM, CUR_AMT_1 TOTAL
			  FROM V_ABA0199M_002
			 WHERE ACNT_YM = #findYear# || #findMon# 
			   AND ACCT_CD = '61110000'
	</select>
	
	<!--
	==================================================================
	  # 설명	: 교통보조비
	  #	기능	: SELECT
	  #	TABLE	: V_ABA0301M_001
	==================================================================
	-->
	<select id="S070D006" parameterClass="hashMap" resultClass="hashMap">
			SELECT A.SLIP_DATE, A.CUST_EMPN EMPN, A.INCO_MN_NM KOR_NM
			     , A.INCO_AMT, A.DEPT_CD 
			     , (SELECT UP_DEPT_NM || ' ' || DEPT_F_NM FROM V_DEPTINFO WHERE DEPT_ID = A.DEPT_CD) DEPT_NM
			     , RMK
			  FROM V_ABA0301M_001 A
			 WHERE A.REV_YM = #findYear# || #findMon#
			   AND A.OTH_LABOR_TC = 'A'
			 ORDER BY A.SLIP_DATE, A.INCO_MN_NM
	</select>
	
	<!--
	==================================================================
	  # 설명	: 자가운전보조금
	  #	기능	: SELECT
	  #	TABLE	: V_ABA0301M_001
	==================================================================
	-->
	<select id="S070D007" parameterClass="hashMap" resultClass="hashMap">
			SELECT A.SLIP_DATE, A.CUST_EMPN EMPN, A.INCO_MN_NM KOR_NM
			     , A.INCO_AMT, A.DEPT_CD 
			     , (SELECT UP_DEPT_NM || ' ' || DEPT_F_NM FROM V_DEPTINFO WHERE DEPT_ID = A.DEPT_CD) DEPT_NM
			     , RMK
			  FROM V_ABA0301M_001 A
			 WHERE A.REV_YM = #findYear# || #findMon#
			   AND A.OTH_LABOR_TC = '7'
			 ORDER BY A.SLIP_DATE, A.INCO_MN_NM
	</select>

	<!--
	==================================================================
	  # 설명	: 자기계발비
	  #	기능	: SELECT
	  #	TABLE	: V_ABA0301M_001
	==================================================================
	-->
	<select id="S070D008" parameterClass="hashMap" resultClass="hashMap">
			SELECT A.SLIP_DATE, A.CUST_EMPN EMPN, A.INCO_MN_NM KOR_NM
			     , A.INCO_AMT, A.DEPT_CD 
			     , (SELECT UP_DEPT_NM || ' ' || DEPT_F_NM FROM V_DEPTINFO WHERE DEPT_ID = A.DEPT_CD) DEPT_NM
			     , RMK
			  FROM V_ABA0301M_001 A
			 WHERE A.REV_YM = #findYear# || #findMon#
			   AND A.OTH_LABOR_TC = '4'
			 ORDER BY A.SLIP_DATE, A.INCO_MN_NM
	</select>

	<!--
	==================================================================
	  # 설명	: 통신비
	  #	기능	: SELECT
	  #	TABLE	: V_ABA0301M_001
	==================================================================
	-->
	<select id="S070D009" parameterClass="hashMap" resultClass="hashMap">
			SELECT A.SLIP_DATE, A.CUST_EMPN EMPN, A.INCO_MN_NM KOR_NM
			     , A.INCO_AMT, A.DEPT_CD 
			     , (SELECT UP_DEPT_NM || ' ' || DEPT_F_NM FROM V_DEPTINFO WHERE DEPT_ID = A.DEPT_CD) DEPT_NM
			     , RMK
			  FROM V_ABA0301M_001 A
			 WHERE A.REV_YM = #findYear# || #findMon#
			   AND A.OTH_LABOR_TC = '3'
			 ORDER BY A.SLIP_DATE, A.INCO_MN_NM
	</select>
	
	<!--
	==================================================================
	  # 설명	: 특별근로대가
	  #	기능	: SELECT
	  #	TABLE	: V_ABA0301M_001
	==================================================================
	-->
	<select id="S070D010" parameterClass="hashMap" resultClass="hashMap">
			SELECT A.SLIP_DATE, A.CUST_EMPN EMPN, A.INCO_MN_NM KOR_NM
			     , A.INCO_AMT, A.DEPT_CD 
			     , (SELECT UP_DEPT_NM || ' ' || DEPT_F_NM FROM V_DEPTINFO WHERE DEPT_ID = A.DEPT_CD) DEPT_NM
			     , RMK
			  FROM V_ABA0301M_001 A
			 WHERE A.REV_YM = #findYear# || #findMon#
			   AND OTH_LABOR_TC IN ('1', '2', '5', '6', '8', 'C', 'D')
			 ORDER BY A.SLIP_DATE, A.INCO_MN_NM
	</select>
	
	<!--
	==================================================================
	  # 설명	: 중식보조비
	  #	기능	: SELECT
	  #	TABLE	: V_ABA0301M_001
	==================================================================
	-->
	<select id="S070D011" parameterClass="hashMap" resultClass="hashMap">
			SELECT A.SLRY_YM, A.EMPN, A.KOR_NM, A.DEPT_CD, A.CAST_TC
                 , (SELECT UP_DEPT_NM || ' ' || DEPT_F_NM FROM V_DEPTINFO WHERE DEPT_ID = A.DEPT_CD) DEPT_NM
                 , (SELECT CODE_NM FROM BSC_CODE WHERE CODE_GRP_ID = '170' AND YEAR = #findYear# AND A.CAST_TC = CODE_ID) CAST_TC_NM
                 , SUM(A.E92) E92, SUM(A.E92) TOTAL
			  FROM V_HEA0101M_002 A
			 WHERE SLRY_YM = #findYear# || #findMon#
			 GROUP BY A.SLRY_YM, A.EMPN, A.KOR_NM, A.DEPT_CD, A.CAST_TC
			 ORDER BY A.KOR_NM
	</select>
	
	<!--
	==================================================================
	  # 설명	: 학자금
	  #	기능	: SELECT
	  #	TABLE	: V_ABA0301M_001
	==================================================================
	-->
	<select id="S070D012" parameterClass="hashMap" resultClass="hashMap">
			SELECT A.SLIP_DATE, A.CUST_EMPN EMPN, A.INCO_MN_NM KOR_NM
			     , A.INCO_AMT, A.DEPT_CD 
			     , (SELECT UP_DEPT_NM || ' ' || DEPT_F_NM FROM V_DEPTINFO WHERE DEPT_ID = A.DEPT_CD) DEPT_NM
			     , RMK
			  FROM V_ABA0301M_001 A
			 WHERE A.REV_YM = #findYear# || #findMon#
			   AND OTH_LABOR_TC IN ('9')
			 ORDER BY A.SLIP_DATE, A.INCO_MN_NM
	</select>
	
	<!--
	==================================================================
	  # 설명	: 부서조회
	  #	기능	: SELECT
	  #	TABLE	: BSC_DEPTINFO
	==================================================================
	-->
	<select id="getDeptList" parameterClass="hashMap" resultClass="hashMap">
		SELECT A.DEPT_ID, B.DEPT_NM
		  FROM BSC_SC_DEPT_MAPPING A
	LEFT OUTER JOIN BSC_DEPTINFO B
			ON A.DEPT_ID = B.DEPT_ID
		 WHERE (YEAR, SC_DEPT_ID) IN
		          (SELECT YEAR, SC_DEPT_ID
		             FROM BSC_METRIC
		            WHERE (METRIC_GRP_ID, YEAR) IN
		                     (SELECT METRIC_GRP_ID, YEAR
		                        FROM BSC_METRIC
		                       WHERE YEAR = #findYear# AND METRIC_ID = #findMetricId#)
				AND DELETE_DT IS NULL)
	</select>

	<!--
	==================================================================
	  # 설명	: 시스템 연계 부서 목록 보기
	  #	기능	: SELECT
	  #	TABLE	:
	==================================================================
	-->
	<select id="getScDeptMapping" parameterClass="hashMap" resultClass="java.lang.String">
		SELECT DEPT_ID
		  FROM ( SELECT DEPT_ID 
				   FROM BSC_SC_DEPT_MAPPING
				  WHERE YEAR = #findYear# 
				    AND SC_DEPT_ID = #findScDeptCd# ORDER BY DEPT_ID 
				    )
		 WHERE ROWNUM = 1
	</select>
	
	<!--
	==================================================================
	  # 설명	: 시스템 연계항목 정보를 가져옴
	  #	기능	: SELECT
	  #	TABLE	:
	==================================================================
	-->
	<select id="getItem" remapResults="true" parameterClass="hashMap" resultClass="hashMap">
          SELECT A.ITEM_CD, B.CAL_TYPE_COL_NM
            FROM BSC_SYSTEM_ITEM A
               , BSC_CAL_TYPE_COL B
           WHERE A.YEAR = #findYear#
             AND A.YEAR = B.YEAR
             AND A.ITEM_CD = B.ITEM_CD
             AND B.METRIC_ID = #findMetricId#
             AND B.INSERT_GUBUN = '01'
           ORDER BY B.CAL_TYPE_COL_NM
	</select>
	
</sqlMap>