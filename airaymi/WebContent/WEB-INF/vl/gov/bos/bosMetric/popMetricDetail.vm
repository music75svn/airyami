#*************************************************************************
* CLASS 명      : popMetricDetail
* 작 업 자      : 박경태
* 작 업 일      : 2012년 11월 12일 
* 기    능      : 기관장지표 정의서    
* ---------------------------- 변 경 이 력 --------------------------------
* 번호    작 업 자    작     업     일        변 경 내 용                비고
* ----  --------  -----------------  -------------------------  --------
*  1    박경태      2012년 11월 12일        최 초 작 업
*  2	김상용		2013년  7월  6일		평가착안사항 수정
**************************************************************************# 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko">

#set($main_url = $!{searchMap.txt2html("mainUrl")})
#set($curr_url = $!{context_path} + "/gov/bos/bosMetric/popMetricDetail.vw")

<head>
	#parse("/WEB-INF/vl/common/template/head.vm")
<script type="text/javascript" language="javascript" >
//<![CDATA[

	var J = jQuery;

	J(document).ready(function(){
        
		/******************************************
		 * 닫기버튼 이벤트
		 ******************************************/
		J("#btnClose").click(function(e) {
			self.close();
		});
		
		/******************************************
		 * 화면 초기셋팅
		 ******************************************/
		init();
	});
	
	/*****************************************************
	 * 화면초기셋팅
	 *****************************************************/ 
	function init() {
		chgMethod();
	}
	/******************************************
	 * 평가방법 선택시 지표유형 변경
	 ******************************************/
	function chgMethod(){
		if(J("#evalMethodId").val()!=""){
    		if(J("#evalMethodId").val()=="01" || J("#evalMethodId").val()=="02"){
				J("#actDetailBtn").show();
    			J("#actDetailArea").show();
				J("#actDetailSum").show();
				J("#unmeasureBlankSpace").show();
				
				
    			J("#actCalTypeArea").hide();
    			
    			J("#actMethodArea01").hide();
    			J("#actMethodArea02").hide();
    			J("#actMethodArea03").hide();
    		}else{
    			//계량으로 셋팅
    			J("#actCalTypeArea").show();
				
    			if(J("#evalMethodId").val()=="03" || J("#evalMethodId").val()=="06" || J("#evalMethodId").val()=="07"){
    				J("#actMethodArea01").show();
    				J("#actMethodArea02").hide();
    				J("#actMethodArea03").hide();
    			}else if(J("#evalMethodId").val()=="04"){
    				J("#actMethodArea01").hide();
    				J("#actMethodArea02").show();
    				J("#actMethodArea03").hide();
    			}else if(J("#evalMethodId").val()=="05"){
    				J("#actMethodArea01").hide();
    				J("#actMethodArea02").hide();
    				J("#actMethodArea03").show();
    			}
    		}
		}
		
	}
	
	/******************************************
	 * 실행계획 팝업
	 ******************************************/
	function goActionPlan(govConceptId) {
		var findYear = J("#year").val();
		var findGovConceptId = govConceptId;
		
		var param = "&amp;year=" + findYear + "&amp;govConceptId=" + findGovConceptId ;
		
		var url = "$!{context_path}/gov/bos/bosMetric/popActionPlanList.vw?type=popup" + param;
		openWinByName(url,'popActionPlan','880','640','yes');
	}
//]]>
</script>    
</head>
<body>
<form id="form1" name="form1" method="post">
    <input type="hidden" 	id="mode"		    name="mode"		      value="$!{searchMap.txt2html("mode")}" />
	<input type="hidden"	id="year"           name="year"           value="$!{searchMap.txt2html("year")}" />
	<input type="hidden" 	id="index" 	 		name="index" />
	<input type="hidden" 	id="evalMethodId" 	name="evalMethodId" 	value="$!{CS_HTML.txt2html($detail.EVAL_METHOD_ID)}" />
	<input type="hidden" 	id="mainMetricYn" 	name="mainMetricYn" 	value="$!{CS_HTML.txt2html($detail.MAIN_METRIC_YN)}" />
	
    $!{searchMap.makeHiddenFind()}
	
    <div>
    	<div id="Table_blockContainer_w800">
			<div class="clear h10"></div>
			
			<div>
			<table width="100%" border="0" cellspacing="0" cellpadding="0">
    		<tr>
    			<td>
    				<table width="100%" border="0" cellpadding="0" cellspacing="0" class="popup_tit_c">
    				<tr>
    					<td class="popup_tit_l"></td>
    					<td class="popup_tit_r">기관장평가지표 정의서</td>
    				</tr>
    				</table>
    			</td>
    		</tr>
    		</table>	
			</div>
			
			<div class="clear h10"></div>
			
    		<div class="blockDetail">
    			<table summary="기관장지표관리 ">
					<caption class="none">기관장지표관리 </caption>
    				<colgroup>
    					<col width="15%" />
    					<col width="35%" />
						<col width="15%" />
						<col width="35%" />
    				</colgroup>
    				<tbody>
						<tr>
							<th scope="row">$!{YEAR}</th>
							<td colspan="3">$!{searchMap.txt2html("findYear")} 년</td>
						</tr>
						<tr>
							<th scope="row">평가지표코드</th>
							<td>$!{CS_HTML.txt2html($detail.BOSS_METRIC_ID)}</td>
							<th scope="row">평가지표</th>
							<td>$!{CS_HTML.txt2html($detail.BOSS_METRIC_NM)}</td>
						</tr>
						<tr>
							<th scope="row">평가범주</th>
							<td>$!{CS_HTML.txt2html($detail.EVAL_CAT_GRP_NM)}</td>
							<th scope="row">정평지표</th>
							<td>$!{CS_HTML.txt2html($detail.GOV_METRIC_NM)}</td>
						</tr>
						<tr>
							<th scope="row">지표방향성</th>
							<td>$!{CS_HTML.txt2html($detail.DIREC_NM)}</td>
							<th scope="row">평가방법</th>
							<td>$!{CS_HTML.txt2html($detail.EVAL_METHOD_NM)}</td>
						</tr>
						<tr>
							<th scope="row">지표유형</th>
							<td>$!{CS_HTML.txt2html($detail.GBN_NM)}</td>
							<th scope="row">단위</th>
							<td>$!{CS_HTML.txt2html($detail.UNIT_NM)}</td>
						</tr>
						<tr>
							<th scope="row">담당자</th>
							<td>$!{CS_HTML.txt2html($detail.INSERT_USER_NM)}</td>
							<th scope="row">주관부서</th>
							<td>$!{CS_HTML.txt2html($!{detail.SC_DEPT_NM})}</td>
						</tr>
						<tr>
							<th scope="row">가중치</th>
							<td>$!{CS_HTML.txt2html($detail.WEIGHT)}</td>
							<th scope="row">정렬순서</th>
							<td>$!{CS_HTML.txt2html($detail.SORT_ORDER)}</td>
						</tr>
						<tr>
							<th scope="row">사용여부</th>
							<td>$!{CS_HTML.txt2html($detail.USER_YN_NM)}</td>
						</tr>
						<tr>
							<th scope="row">지표정의</th>
							<td colspan="3">
								<textarea id="content" name="content" class="tabletext" title="지표정의" cols="" rows="5" readonly="readonly">$!{CS_HTML.txt2html($detail.CONTENT)}</textarea>
							</td>
						</tr>
					</tbody>
    			</table>
    		</div>
			
			<!-- 실적산식 -->
			<div id="actCalTypeArea" class="blockDetail2 none">
    			<table id="actCalTypeTB" summary="산식항목 ">
    				<caption class="none">산식항목 </caption>
    				<colgroup>
    					<col width="15%" />
    					<col width="65%" />
						<col width="20%" />
					</colgroup>
    				<tbody>
    					<tr>
    						<th scope="row">$!{METRIC_NM} 산식</th>
    						<td colspan="3" class="textLeft">$!{CS_HTML.txt2html($detail.ACT_CAL_TYPE)}</td>
    					</tr>
    					<tr id="actCalTypeList">
    						<th scope="row">산식항목</th>
    						<th scope="row">산식항목명</th>
							<th scope="row">단위</th>
						</tr>
                        #foreach($list in $calTypeColList)
						<tr>
    						<td><span>$!{CS_HTML.txt2html($list.ACT_CAL_TYPE_COL_ID)}</span></td>
    						<td class="textLeft">$!{CS_HTML.txt2html($list.ACT_CAL_TYPE_COL_NM)}</td>
							<td>$!CS_CODE.getCodeName("013", $list.UNIT, $!{searchMap.txt2html("year")})</td>
						</tr>
                        #end
						
						<tr id="kpiActCalTypeNm">
    						<th scope="row">$!{METRIC_NM} 산식명</th>
							<td class="textLeft" colspan="3"><span>$!{calTypeColDesc}</span></td>
    					</tr>
    				</tbody>
    			</table>
    		</div>
			
			<div id="actMethodArea01" class="blockDetail none">
    			<table summary="목표관리 ">
    				<caption class="none">목표관리 </caption>
    				<colgroup>
    					<col width="15%" />
    					<col width="85%" />
					</colgroup>
    				<tbody>
    					<tr>
    						<th scope="row">기준치</th>
    						<td>$!{CS_HTML.txt2html($detail.BASE_VALUE)}</td>
    					</tr>
					</tbody>
    			</table>
    		</div>
			
			<div id="actMethodArea02" class="blockDetail none">
    			<table summary="목표관리 ">
    				<caption class="none">목표관리 </caption>
    				<colgroup>
    					<col width="15%" />
    					<col width="20%" />
						<col width="15%" />
    					<col width="20%" />
						<col width="15%" />
    					<col width="15%" />
					</colgroup>
    				<tbody>
    					<tr>
    						<th scope="row">기준치</th>
    						<td>$!{CS_HTML.txt2html($detail.BASE_VALUE)}</td>
							<th scope="row">최고목표</th>
    						<td>$!{CS_HTML.txt2html($detail.BEST_TARGET)}</td>
							<th scope="row">최저목표</th>
    						<td>$!{CS_HTML.txt2html($detail.LOWEST_TARGET)}</td>
    					</tr>
					</tbody>
    			</table>
    		</div>
			
			<div id="actMethodArea03" class="blockDetail none">
    			<table summary="목표관리 ">
    				<caption class="none">목표관리 </caption>
    				<colgroup>
    					<col width="12%" />
    					<col width="13%" />
						<col width="12%" />
    					<col width="13%" />
						<col width="12%" />
    					<col width="13%" />
						<col width="12%" />
    					<col width="13%" />
					</colgroup>
    				<tbody>
    					<tr>
    						<th scope="row">기준치</th>
    						<td>$!{CS_HTML.txt2html($detail.BASE_VALUE)}</td>
							<th scope="row">최고목표</th>
    						<td>$!{CS_HTML.txt2html($detail.BEST_TARGET)}</td>
							<th scope="row">최저목표</th>
    						<td>$!{CS_HTML.txt2html($detail.LOWEST_TARGET)}</td>
							<th scope="row">표준편차</th>
    						<td>$!{CS_HTML.txt2html($detail.STAD_CONST)}</td>
    					</tr>
					</tbody>
    			</table>
    		</div>
			
			<div id="unmeasureBlankSpace" class="clear h10 none"></div>
			
			<div id="actDetailArea" class="blockDetail2 none">
				<table id="actDetailTB" summary="세부평가내용 ">
    				<caption class="none">세부평가내용 </caption>
    				<colgroup>
						<col width="45%" />
    					<col width="45%" />
						<col width="10%" />
					</colgroup>
    				<tbody>
    					<tr>
    						<th scope="row">세부평가내용</th>
    						<th scope="row">평가착안사항</th>
							<th scope="row">담당자</th>
						</tr>
						
						## 이전 row 의 detailEvalId
						#set ($preDetailEvalId = "")
						
						#set ($detailEvalId = "") 
						#set ($detailEvalNm = "")
						#set ($conceptId = "")
						#set ($conceptNm = "")
						#set ($insertUserId = "")
						#set ($insertUserNm = "")
						
						#set ($div = "")
						
						#set ($items = [])
						#set ($detailEvalItems = [])
						
						#foreach($list in $detailEvalItemList)
							#set ($isNew = ($preDetailEvalId == "" || $preDetailEvalId != $list.DETAIL_EVAL_ID))
							
							#if ($isNew)
								#if ($preDetailEvalId != "")
									#set($temp = $items.add($detailEvalId))
        							#set($temp = $items.add($detailEvalNm))
        							#set($temp = $items.add($conceptId))
        							#set($temp = $items.add($conceptNm))
        							#set($temp = $items.add($insertUserId))
        							#set($temp = $items.add($insertUserNm))
							
									#set($temp = $items.add($div))
									
									#set($temp = $detailEvalItems.add($items))
									
									#set ($items = [])
								#end
							#end
							
							#set ($tmpDiv = "")
							
							#set ($tmpDiv = $tmpDiv + "<div name='div_$!{CS_HTML.txt2html($list.DETAIL_EVAL_ID)}' align='right'>")
							#set ($tmpDiv = $tmpDiv + "		<input type='hidden' name='CONCEPT_$!{CS_HTML.txt2html($list.DETAIL_EVAL_ID)}' value='CONCEPT_$!{CS_HTML.txt2html($list.DETAIL_EVAL_ID)}_$!{CS_HTML.txt2html($list.CONCEPT_ID)}'/>")
                            #set ($tmpDiv = $tmpDiv + "		<textarea name='CONCEPT_$!{CS_HTML.txt2html($list.DETAIL_EVAL_ID)}_$!{CS_HTML.txt2html($list.CONCEPT_ID)}' class='tabletext' title='평가착안사항' cols='' rows='3' readonly='readonly'>$!{CS_HTML.txt2html($list.CONCEPT_NM)}</textarea>")
							#set ($tmpDiv = $tmpDiv + "		<input type='button' onclick='javascript:goActionPlan(${esc.getQ()}$!{CS_HTML.txt2html($list.CONCEPT_ID)}${esc.getQ()}); return false;' value='실행계획 조회' class='valign_middle' />")
							#set ($tmpDiv = $tmpDiv + "</div>")
							
							#if ($isNew)
								#set ($div = $tmpDiv)
							#else
								#set ($div = $div + $tmpDiv)
							#end
							
							#set ($detailEvalId = $list.DETAIL_EVAL_ID) 
    						#set ($detailEvalNm = $list.DETAIL_EVAL_NM)
    						#set ($conceptId = $list.CONCEPT_ID)
    						#set ($conceptNm = $list.CONCEPT_NM)
    						#set ($insertUserId = $list.INSERT_USER_ID)
    						#set ($insertUserNm = $list.INSERT_USER_NM)
							
							#set ($preDetailEvalId = $list.DETAIL_EVAL_ID)
						#end
						#if ($detailEvalId != "")
							#set($temp = $items.add($detailEvalId))
							#set($temp = $items.add($detailEvalNm))
							#set($temp = $items.add($conceptId))
							#set($temp = $items.add($conceptNm))
							#set($temp = $items.add($insertUserId))
							#set($temp = $items.add($insertUserNm))
							#set($temp = $items.add($div))
							
							#set($temp = $detailEvalItems.add($items))
							
							#set ($items = [])
						#end
						
						#foreach ($detailEvalItem in $detailEvalItems)
						<tr>
							<td style="text-align:left">
								<textarea id="DETAIL_$!{CS_HTML.txt2html($detailEvalItem.get(0))}" name="DETAIL_$!{CS_HTML.txt2html($detailEvalItem.get(0))}" class="tabletext" title="세부평가내용" cols="" rows="4" readonly="readonly">$!{CS_HTML.txt2html($detailEvalItem.get(1))}</textarea>
							</td>
							<td style="text-align:left">
								$detailEvalItem.get(6)
							</td>
							<td>$!{CS_HTML.txt2html($detailEvalItem.get(5))}</td>
						</tr>
						#end
					</tbody>
				</table>
			</div>
			
			<div id="actDetailSum" class="blockDetail none">
    			<table summary="세부평가요약 ">
    				<caption class="none">세부평가요약 </caption>
    				<colgroup>
    					<col width="15%" />
    					<col width="85%" />
					</colgroup>
    				<tbody>
    					<tr>
    						<th scope="row">세부평가요약</th>
    						<td>$!{CS_HTML.txt2html($detail.DETAIL_EVAL_SUMMARY_COMMENT)}</td>
    					</tr>
					</tbody>
    			</table>
    		</div>
			
    		<div class="blockButton"> 
    			<ul>
    				<li><input type="button" id="btnClose"   value="닫기" /></li>
    			</ul>
    		</div>	
    	</div>
		<a id="anchor"></a>
    	<div class="clear"></div>
    </div>
</form>

</body>
</html>
