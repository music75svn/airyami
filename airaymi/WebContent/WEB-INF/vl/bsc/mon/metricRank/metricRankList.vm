#*************************************************************************
* CLASS 명      : metricRankList
* 작 업 자      : 정철수
* 작 업 일      : 2012년 8월 14일
* 기    능      : KPI순위
* ---------------------------- 변 경 이 력 --------------------------------
* 번호    작 업 자     작   업   일       변 경 내 용           비  고
* ----  --------  -----------------  -------------------------  -----------
*  1     정철수      2012년 8월 14일             최 초 작 업
**************************************************************************#
#set($curr_url = $!{context_path} + "/bsc/mon/metricRank/metricRankList.vw")
<script type="text/javascript" language="javascript" >
//<![CDATA[

	var J = jQuery;

	J(document).ready(function(){

		/******************************************
		 * 데이터 그리드 출력
		 ******************************************/
		var str = J('#formFind').serialize();

		jQuery("#list").jqGrid({
			url          :"$!{context_path}/bsc/mon/metricRank/metricRankList_xml.vw" + "?" + str,
			mtype        :"POST",
			datatype     :"json",
			jsonReader   : {
    						page   : "page",
    						total  : "total",
    						root   : "rows",
    						records: function(obj){return obj.length;},
    						repeatitems: false,
    						id     : "id"
    				       },
			height       : $!{jqGrid_height},
			width        : $!{jqGrid_width},
			colNames     :['순위', '평가부서코드', '$!{SC_DEPT_NM}', '1월', '2월', '3월', '4월', '5월', '6월', '7월', '8월', '9월', '10월', '11월', '12월'
						   #if( 'SCORE' == $!{searchMap.txt2html("findSchGbn")} )
						   , '1월평균', '2월평균', '3월평균', '4월평균', '5월평균', '6월평균', '7월평균', '8월평균', '9월평균', '10월평균', '11월평균', '12월평균'
						   #end
							],
			colModel     :[
							{name:'RANK'         		 ,index:'RANK'				   ,width:70	,align:'center' },
                            {name:'SC_DEPT_ID'           ,index:'SC_DEPT_ID'           ,width:100   ,align:'left' },
                            {name:'SC_DEPT_NM'           ,index:'SC_DEPT_NM'           ,width:100   ,align:'left' },
							#if( 'SCORE' == $!{searchMap.txt2html("findSchGbn")} )
                            {name:'SCORE01'              ,index:'SCORE01'              ,width:50   ,align:'center' },
                            {name:'SCORE02'              ,index:'SCORE02'              ,width:50   ,align:'center' },
                            {name:'SCORE03'              ,index:'SCORE03'              ,width:50   ,align:'center' },
                            {name:'SCORE04'              ,index:'SCORE04'              ,width:50   ,align:'center' },
                            {name:'SCORE05'              ,index:'SCORE05'              ,width:50   ,align:'center' },
                            {name:'SCORE06'              ,index:'SCORE06'              ,width:50   ,align:'center' },
                            {name:'SCORE07'              ,index:'SCORE07'              ,width:50   ,align:'center' },
                            {name:'SCORE08'              ,index:'SCORE08'              ,width:50   ,align:'center' },
                            {name:'SCORE09'              ,index:'SCORE09'              ,width:50   ,align:'center' },
                            {name:'SCORE10'              ,index:'SCORE10'              ,width:50   ,align:'center' },
                            {name:'SCORE11'              ,index:'SCORE11'              ,width:50   ,align:'center' },
                            {name:'SCORE12'              ,index:'SCORE12'              ,width:50   ,align:'center' },
							{name:'SCORES01'             ,index:'SCORES01'             ,width:50   ,align:'center' ,formatter:linkScores1},
							{name:'SCORES02'             ,index:'SCORES02'             ,width:50   ,align:'center' ,formatter:linkScores2},
							{name:'SCORES03'             ,index:'SCORES03'             ,width:50   ,align:'center' ,formatter:linkScores3},
							{name:'SCORES04'             ,index:'SCORES04'             ,width:50   ,align:'center' ,formatter:linkScores4},
							{name:'SCORES05'             ,index:'SCORES05'             ,width:50   ,align:'center' ,formatter:linkScores5},
							{name:'SCORES06'             ,index:'SCORES06'             ,width:50   ,align:'center' ,formatter:linkScores6},
							{name:'SCORES07'             ,index:'SCORES07'             ,width:50   ,align:'center' ,formatter:linkScores7},
							{name:'SCORES08'             ,index:'SCORES08'             ,width:50   ,align:'center' ,formatter:linkScores8},
							{name:'SCORES09'             ,index:'SCORES09'             ,width:50   ,align:'center' ,formatter:linkScores9},
							{name:'SCORES10'             ,index:'SCORES10'             ,width:50   ,align:'center' ,formatter:linkScores10},
							{name:'SCORES11'             ,index:'SCORES11'             ,width:50   ,align:'center' ,formatter:linkScores11},
							{name:'SCORES12'             ,index:'SCORES12'             ,width:50   ,align:'center' ,formatter:linkScores12}
							#else
							{name:'STATUS_01'            ,index:'STATUS_01'            ,width:80   ,align:'center' ,formatter:linkUpdate },
                            {name:'STATUS_02'            ,index:'STATUS_02'            ,width:80   ,align:'center' ,formatter:linkUpdate },
                            {name:'STATUS_03'            ,index:'STATUS_03'            ,width:80   ,align:'center' ,formatter:linkUpdate },
                            {name:'STATUS_04'            ,index:'STATUS_04'            ,width:80   ,align:'center' ,formatter:linkUpdate },
                            {name:'STATUS_05'            ,index:'STATUS_05'            ,width:80   ,align:'center' ,formatter:linkUpdate },
                            {name:'STATUS_06'            ,index:'STATUS_06'            ,width:80   ,align:'center' ,formatter:linkUpdate },
                            {name:'STATUS_07'            ,index:'STATUS_07'            ,width:80   ,align:'center' ,formatter:linkUpdate },
                            {name:'STATUS_08'            ,index:'STATUS_08'            ,width:80   ,align:'center' ,formatter:linkUpdate },
                            {name:'STATUS_09'            ,index:'STATUS_09'            ,width:80   ,align:'center' ,formatter:linkUpdate },
                            {name:'STATUS_10'            ,index:'STATUS_10'            ,width:80   ,align:'center' ,formatter:linkUpdate },
                            {name:'STATUS_11'            ,index:'STATUS_11'            ,width:80   ,align:'center' ,formatter:linkUpdate },
                            {name:'STATUS_12'            ,index:'STATUS_12'            ,width:80   ,align:'center' ,formatter:linkUpdate }
							#end
							],
			rowNum       : $!{jqGrid_rownum},
			autowidth    : false,
			viewrecords  : true,
			loadonce     : true,
			multiselect  : false,
			cellEdit     : true,
			cmTemplate   : {sortable:false},
			footerrow	 : true,
			userDataOnFooter : true,
			gridview     : true,
			loadComplete : function() {
					var grid = J("#list");
					var ids	= J("#list").jqGrid('getDataIDs');
					var rowdata = "";
					var scDeptId = "";

					for (var i = 0; i < ids.length; i++) {
						rowdata = J("#list").getRowData(ids[i]);
						if (rowdata.SC_DEPT_ID == "$!{CS_LOGIN.getSc_dept_id()}") {
							J("#" + ids[i]).css("background", "#fdeccd");
						}
					}

					grid.jqGrid('footerData', 'set', showTotAvg());
				  },
			caption:"KPI순위"

		}).jqGrid('hideCol',"SC_DEPT_ID").jqGrid('hideCol',"SCORES01").jqGrid('hideCol',"SCORES02").jqGrid('hideCol',"SCORES03").jqGrid('hideCol',"SCORES04").jqGrid('hideCol',"SCORES05").jqGrid('hideCol',"SCORES06")
		  .jqGrid('hideCol',"SCORES07").jqGrid('hideCol',"SCORES08").jqGrid('hideCol',"SCORES09").jqGrid('hideCol',"SCORES10").jqGrid('hideCol',"SCORES11").jqGrid('hideCol',"SCORES12").setGridWidth($!{jqGrid_width});

		/******************************************
		 * 조회
		 ******************************************/
		J("#formFind").submit(function(event) {
			//submit 하기전 작업추가
		});

		/******************************************
		 * 엑셀다운로드 버튼 클릭 이벤트
		 ******************************************/
		J("#btnExcelDown").click(function() {
			excelDownload();
			return false;
		});

		/******************************************
    	 * 년도 변경에 따라 평가그룹 change 이벤트
    	 ******************************************/
    	$('#findYear').change(function(){
    		chScDeptGrp();
			metricGrpInit();
    	});

		/******************************************
		 * fancy Box 팝업호출
		 ******************************************/
		J("#anchor").fancybox();            //실적연계 항목 팝업


	});

	/******************************************
	 * jqGrid 점수 평균
	 ******************************************/
	function linkScores1(cellvalue, options, rowObject) {
		if(options.rowId==""){
			return cellvalue;
		}else{
			var str = '';
			str += '<input type="hidden" id="scores1" name="scores1" value="' + cellvalue + '" class="inputbox wp70;" readonly="readonly" style="text-align:center" maxlength="5" />';
			return str;
		}
	}
	/******************************************
	 * jqGrid 점수 평균
	 ******************************************/
	function linkScores2(cellvalue, options, rowObject) {
		if(options.rowId==""){
			return cellvalue;
		}else{
			var str = '';
			str += '<input type="hidden" id="scores2" name="scores2" value="' + cellvalue + '" class="inputbox wp70;" readonly="readonly" style="text-align:center" maxlength="5" />';
			return str;
		}
	}
	/******************************************
	 * jqGrid 점수 평균
	 ******************************************/
	function linkScores3(cellvalue, options, rowObject) {
		if(options.rowId==""){
			return cellvalue;
		}else{
			var str = '';
			str += '<input type="hidden" id="scores3" name="scores3" value="' + cellvalue + '" class="inputbox wp70;" readonly="readonly" style="text-align:center" maxlength="5" />';
			return str;
		}
	}
	/******************************************
	 * jqGrid 점수 평균
	 ******************************************/
	function linkScores4(cellvalue, options, rowObject) {
		if(options.rowId==""){
			return cellvalue;
		}else{
			var str = '';
			str += '<input type="hidden" id="scores4" name="scores4" value="' + cellvalue + '" class="inputbox wp70;" readonly="readonly" style="text-align:center" maxlength="5" />';
			return str;
		}
	}
	/******************************************
	 * jqGrid 점수 평균
	 ******************************************/
	function linkScores5(cellvalue, options, rowObject) {
		if(options.rowId==""){
			return cellvalue;
		}else{
			var str = '';
			str += '<input type="hidden" id="scores5" name="scores5" value="' + cellvalue + '" class="inputbox wp70;" readonly="readonly" style="text-align:center" maxlength="5" />';
			return str;
		}
	}
	/******************************************
	 * jqGrid 점수 평균
	 ******************************************/
	function linkScores6(cellvalue, options, rowObject) {
		if(options.rowId==""){
			return cellvalue;
		}else{
			var str = '';
			str += '<input type="hidden" id="scores6" name="scores6" value="' + cellvalue + '" class="inputbox wp70;" readonly="readonly" style="text-align:center" maxlength="5" />';
			return str;
		}
	}
	/******************************************
	 * jqGrid 점수 평균
	 ******************************************/
	function linkScores7(cellvalue, options, rowObject) {
		if(options.rowId==""){
			return cellvalue;
		}else{
			var str = '';
			str += '<input type="hidden" id="scores7" name="scores7" value="' + cellvalue + '" class="inputbox wp70;" readonly="readonly" style="text-align:center" maxlength="5" />';
			return str;
		}
	}
	/******************************************
	 * jqGrid 점수 평균
	 ******************************************/
	function linkScores8(cellvalue, options, rowObject) {
		if(options.rowId==""){
			return cellvalue;
		}else{
			var str = '';
			str += '<input type="hidden" id="scores8" name="scores8" value="' + cellvalue + '" class="inputbox wp70;" readonly="readonly" style="text-align:center" maxlength="5" />';
			return str;
		}
	}
	/******************************************
	 * jqGrid 점수 평균
	 ******************************************/
	function linkScores9(cellvalue, options, rowObject) {
		if(options.rowId==""){
			return cellvalue;
		}else{
			var str = '';
			str += '<input type="hidden" id="scores9" name="scores9" value="' + cellvalue + '" class="inputbox wp70;" readonly="readonly" style="text-align:center" maxlength="5" />';
			return str;
		}
	}
	/******************************************
	 * jqGrid 점수 평균
	 ******************************************/
	function linkScores10(cellvalue, options, rowObject) {
		if(options.rowId==""){
			return cellvalue;
		}else{
			var str = '';
			str += '<input type="hidden" id="scores10" name="scores10" value="' + cellvalue + '" class="inputbox wp70;" readonly="readonly" style="text-align:center" maxlength="5" />';
			return str;
		}
	}
	/******************************************
	 * jqGrid 점수 평균
	 ******************************************/
	function linkScores11(cellvalue, options, rowObject) {
		if(options.rowId==""){
			return cellvalue;
		}else{
			var str = '';
			str += '<input type="hidden" id="scores11" name="scores11" value="' + cellvalue + '" class="inputbox wp70;" readonly="readonly" style="text-align:center" maxlength="5" />';
			return str;
		}
	}
	/******************************************
	 * jqGrid 점수 평균
	 ******************************************/
	function linkScores12(cellvalue, options, rowObject) {
		if(options.rowId==""){
			return cellvalue;
		}else{
			var str = '';
			str += '<input type="hidden" id="scores12" name="scores12" value="' + cellvalue + '" class="inputbox wp70;" readonly="readonly" style="text-align:center" maxlength="5" />';
			return str;
		}
	}

	/******************************************
	 * 계산실행
	 ******************************************/
	function showTotAvg() {
		var ids = J("#list").getDataIDs();

		var totalScore1 = 0;
		var totalScore2 = 0;
		var totalScore3 = 0;
		var totalScore4 = 0;
		var totalScore5 = 0;
		var totalScore6 = 0;
		var totalScore7 = 0;
		var totalScore8 = 0;
		var totalScore9 = 0;
		var totalScore10 = 0;
		var totalScore11 = 0;
		var totalScore12 = 0;

		for(var i=0;i<=ids.length-1;i++) {
			if(J("input[name=scores1]").eq(i).val() != "") {
				totalScore1 += parseFloat(J("input[name=scores1]").eq(i).val());
			}
			if(J("input[name=scores2]").eq(i).val() != "") {
				totalScore2 += parseFloat(J("input[name=scores2]").eq(i).val());
			}
			if(J("input[name=scores3]").eq(i).val() != "") {
				totalScore3 += parseFloat(J("input[name=scores3]").eq(i).val());
			}
			if(J("input[name=scores4]").eq(i).val() != "") {
				totalScore4 += parseFloat(J("input[name=scores4]").eq(i).val());
			}
			if(J("input[name=scores5]").eq(i).val() != "") {
				totalScore5 += parseFloat(J("input[name=scores5]").eq(i).val());
			}
			if(J("input[name=scores6]").eq(i).val() != "") {
				totalScore6 += parseFloat(J("input[name=scores6]").eq(i).val());
			}
			if(J("input[name=scores7]").eq(i).val() != "") {
				totalScore7 += parseFloat(J("input[name=scores7]").eq(i).val());
			}
			if(J("input[name=scores8]").eq(i).val() != "") {
				totalScore8 += parseFloat(J("input[name=scores8]").eq(i).val());
			}
			if(J("input[name=scores9]").eq(i).val() != "") {
				totalScore9 += parseFloat(J("input[name=scores9]").eq(i).val());
			}
			if(J("input[name=scores10]").eq(i).val() != "") {
				totalScore10 += parseFloat(J("input[name=scores10]").eq(i).val());
			}
			if(J("input[name=scores11]").eq(i).val() != "") {
				totalScore11 += parseFloat(J("input[name=scores11]").eq(i).val());
			}
			if(J("input[name=scores12]").eq(i).val() != "") {
				totalScore12 += parseFloat(J("input[name=scores12]").eq(i).val());
			}
		}

		totalScore1 = totalScore1/ids.length;
		totalScore2 = totalScore2/ids.length;
		totalScore3 = totalScore3/ids.length;
		totalScore4 = totalScore4/ids.length;
		totalScore5 = totalScore5/ids.length;
		totalScore6 = totalScore6/ids.length;
		totalScore7 = totalScore7/ids.length;
		totalScore8 = totalScore8/ids.length;
		totalScore9 = totalScore9/ids.length;
		totalScore10 = totalScore10/ids.length;
		totalScore11 = totalScore11/ids.length;
		totalScore12 = totalScore12/ids.length;

		totalScore1 = totalScore1.toFixed(3);
		totalScore2 = totalScore2.toFixed(3);
		totalScore3 = totalScore3.toFixed(3);
		totalScore4 = totalScore4.toFixed(3);
		totalScore5 = totalScore5.toFixed(3);
		totalScore6 = totalScore6.toFixed(3);
		totalScore7 = totalScore7.toFixed(3);
		totalScore8 = totalScore8.toFixed(3);
		totalScore9 = totalScore9.toFixed(3);
		totalScore10 = totalScore10.toFixed(3);
		totalScore11 = totalScore11.toFixed(3);
		totalScore12 = totalScore12.toFixed(3);

		if( isNaN(totalScore1)) {

			J("#list").jqGrid('footerData', 'set', {SCORE01: 0});
			J("#list").jqGrid('footerData', 'set', {SCORE02: 0});
			J("#list").jqGrid('footerData', 'set', {SCORE03: 0});
			J("#list").jqGrid('footerData', 'set', {SCORE04: 0});
			J("#list").jqGrid('footerData', 'set', {SCORE05: 0});
			J("#list").jqGrid('footerData', 'set', {SCORE06: 0});
			J("#list").jqGrid('footerData', 'set', {SCORE07: 0});
			J("#list").jqGrid('footerData', 'set', {SCORE08: 0});
			J("#list").jqGrid('footerData', 'set', {SCORE09: 0});
			J("#list").jqGrid('footerData', 'set', {SCORE10: 0});
			J("#list").jqGrid('footerData', 'set', {SCORE11: 0});
			J("#list").jqGrid('footerData', 'set', {SCORE12: 0});

		} else {

			J("#list").jqGrid('footerData', 'set', {SCORE01: totalScore1});
			J("#list").jqGrid('footerData', 'set', {SCORE02: totalScore2});
			J("#list").jqGrid('footerData', 'set', {SCORE03: totalScore3});
			J("#list").jqGrid('footerData', 'set', {SCORE04: totalScore4});
			J("#list").jqGrid('footerData', 'set', {SCORE05: totalScore5});
			J("#list").jqGrid('footerData', 'set', {SCORE06: totalScore6});
			J("#list").jqGrid('footerData', 'set', {SCORE07: totalScore7});
			J("#list").jqGrid('footerData', 'set', {SCORE08: totalScore8});
			J("#list").jqGrid('footerData', 'set', {SCORE09: totalScore9});
			J("#list").jqGrid('footerData', 'set', {SCORE10: totalScore10});
			J("#list").jqGrid('footerData', 'set', {SCORE11: totalScore11});
			J("#list").jqGrid('footerData', 'set', {SCORE12: totalScore12});

		}

		J("#list").jqGrid('footerData', 'set', {SC_DEPT_NM: "평균"});
	}

	/******************************************
	 * jqGrid 신호등
	 ******************************************/
	function linkUpdate(cellvalue, options, rowObject) {
		return "<img name=\'sig\'  src=\'$!{img_path}/common/ball/ball_" + cellvalue + ".gif\' >";
	}


	/******************************************
	 * 엑셀다운로드
	 ******************************************/
	function excelDownload(){
		J("#yearNm").val(J("#findYear > option:selected").text());
		J("#scDeptGrpNm").val(J("#findScDeptGrpId > option:selected").text());
		J("#schGbnNm").val(J("#findSchGbn > option:selected").text());
		J("#analCycleNm").val(J("input:radio[name=findAnalCycle]:checked").next().text());
		J("#formList").attr("action", "$!{context_path}/bsc/mon/metricRank/metricRankListExcel.vw?type=excel").submit();

		return false;
	}

	/******************************************
	 * 선택된 해당년도의 평가그룹  조회
	 ******************************************/
	function chScDeptGrp(){
		J.ajax({
        	url      : "$!{context_path}/bsc/mon/metricRank/scDeptGrp_ajax.vw",﻿
        	cache    : false,
        	type     : "POST",
			data     : J("#formFind").serialize(),
        	dataType : "html",
        	contentType: "application/x-www-form-urlencoded; charset=UTF-8",
        	success  : function (data) {
				var xmlDoc = J.parseXML(data);
				var beforeVal = J("#findScDeptGrpId").val();
        		J("#findScDeptGrpId").empty();
				J('<option/>').attr('value', '').text('전체').appendTo('#findScDeptGrpId');
				J(xmlDoc).find("data").each(function() {

					J('<option/>').attr('value', J(this).find("value").text()).text(J(this).find("text").text()).appendTo('#findScDeptGrpId');
				})
				J("#findScDeptGrpId").val( beforeVal );
        	}
    	});
	}

	/*****************************************************
	 * 지표pool 선택시 설정
	 *****************************************************/
	function setKpiPoolSet(metricGrpId) {
		J.fancybox.close();
		J("#findMetricGrpId").val(metricGrpId);
		J("#formFind").attr("action", "$!{context_path}/bsc/mon/metricRank/metricRankList.vw?type=template").submit();
	}

	/*****************************************************
	 * 지표pool 선택 팝업
	 *****************************************************/
	function metricGrpSearch() {
		J("#anchor").attr("href","$!{context_path}/bsc/module/commModule/popMetricGrpSearch.vw?findYear="+J("#findYear").val());
		J("#anchor").click();
	}

	/*****************************************************
	 * 지표pool 선택 취소
	 *****************************************************/
	function metricGrpInit() {
		J("#findMetricGrpId").val("");
		J("#findMetricGrpNm").val("");
	}

//]]>
</script>

<div id="Table">
	<div id="Table_blockContainer">
		<h1 class="none">KPI순위</h1>
		<div class="tableTop">
			#parse("/WEB-INF/vl/common/template/tabs.vm")

    		<!-- search S -->
			<form id="formFind" name="formFind" method="post" action="$!{context_path}/bsc/mon/metricRank/metricRankList.vw?type=template">
				<input type="hidden"	id="findHighPgmId"	name="findHighPgmId"	value="$!{searchMap.txt2html("findHighPgmId")}" />
				<input type="hidden" 	id="findSubPgmId"	name="findSubPgmId"		value="$!{searchMap.txt2html("findSubPgmId")}" />
				<input type="hidden"    id="findPgmId"		name="findPgmId"		value="$!{searchMap.txt2html("findPgmId")}" />
				<input type="hidden"    id="findMon"		name="findMon"			value="$!{searchMap.txt2html("findMon")}" />


				<div class="searchBox">
    				<div><div><div>
    				<table summary="$!{METRIC_NM}순위검색 조건">
						<caption class="none">$!{METRIC_NM}순위 검색 조건</caption>
						<thead><tr><th></th></tr></thead>
        				<tbody>
            				<tr>
								<td class="searchBox_tit w140">
                                    <span><label for="findYear">$!{YEAR}</label></span>
            						<span class="searchBar">
            							<select id="findYear" name="findYear" class="select w80">
            								$!CS_CODE.getCodeOption("017", $!{searchMap.txt2html("findYear")})
            							</select>
            						</span>
            					</td>
            					<td class="searchBox_tit w270">
                					<span><label for="findMetricGrpNm">$!{METRIC_GRP_NM}</label></span>
									<span class="searchBar">
										<!--
										<input type="hidden" id="findMetricId" name="findMetricId" class="inputbox wp80" value='$!{searchMap.txt2html("findMetricId")}' maxlength="50" />
										<input type="text" id="findMetricNm" name="findMetricNm" class="text" value="$!{searchMap.txt2html("findMetricNm")}"  maxlength="10" title="$!{METRIC_NM}"/>
										<span><img src="$!{img_path}/common/board/ic_search.gif" id="kpiSelect" class="valign_middle" alt="$!{METRIC_NM}선택" style="cursor:pointer;"/></span>
                                        <span><img src="$!{img_path}/common/board/ic_cancel.gif" id="kpiCancel" class="valign_middle" alt="$!{METRIC_NM} 취소" style="cursor:pointer;"/></span>
										-->
										<input type="hidden" id="findMetricGrpId" name="findMetricGrpId" class="inputbox wp80" value='$!{searchMap.txt2html("findMetricGrpId")}' maxlength="50" />
										<input type="text" id="findMetricGrpNm" name="findMetricGrpNm" class="inputbox w150" value='$!{searchMap.txt2html("findMetricGrpNm")}' maxlength="50" readonly="readonly"/>
										<span><input type="image" onclick="javascript:metricGrpSearch();return false;" class="valign_middle" src="$!{img_path}/common/board/ic_search.gif" alt="지표풀선택"/></span>
										<span><input type="image" onclick="javascript:metricGrpInit();return false;" class="valign_middle" src="$!{img_path}/common/board/ic_cancel.gif" alt="지표풀 선택취소"/></span>

									</span>
                                </td>
								<td class="searchBox_tit w170">
                					<span><label for="findScDeptGrpId">평가그룹</label></span>
									<span class="searchBar">
										<select id="findScDeptGrpId" name="findScDeptGrpId" class="select w100" >
            								<option value="" $!{CS_HTML.getSelected("",$!{searchMap.txt2html("findScDeptGrpId")} )}>전체</option>
											$!CS_CODE.getCodeOption("003", $!{searchMap.txt2html("findScDeptGrpId")}, $!{searchMap.txt2html("findYear")})
            							</select>
									</span>
                                </td>
								<td class="searchBox_tit w130">
									<span><label for="findLevelId">레벨</label></span>
            						<span class="searchBar">
            							<select id="findLevelId" name="findLevelId" class="select w80">
            								<option value="" $!{CS_HTML.getSelected("",$!{searchMap.txt2html("findLevelId")} )}>전체</option>
											$!CS_CODE.getCodeOption("004", $!{searchMap.txt2html("findLevelId")})
            							</select>
            						</span>
            					</td>
            					<td class="searchBox_tit w150">
									<span><label for="findSchGbn">조회구분</label></span>
            						<span class="searchBar">
            							<select id="findSchGbn" name="findSchGbn" class="select w70">
            								<option value="SCORE" $!{CS_HTML.getSelected("SCORE",$!{searchMap.txt2html("findSchGbn")} )}>점수</option>
											<option value="SIGNAL" $!{CS_HTML.getSelected("SIGNAL",$!{searchMap.txt2html("findSchGbn")} )}>신호등</option>
            							</select>
            						</span>
            					</td>
								<td class="searchBox_tit w100">
            						<span class="searchBar">
										$!CS_CODE.getCodeRadio("findAnalCycle", "138", $!{searchMap.txt2html("findAnalCycle")}, "")
            						</span>
            					</td>
            				</tr>
        				</tbody>
    				</table>
                    <input type="image" class="btnSearch" src="$!{img_path}/common/btn_search.gif" align="middle" alt="검색" />
                    </div></div></div>
    	        </div>
    		</form>
    		<!-- search E -->
			<div class="clear"></div>
		</div>

		<form id="formList" name="formList" method="post" action="$!{context_path}/bsc/mon/metricRank/metricRankProcess.vw?type=template">
			<input type="hidden" id="mode"       name="mode" />
			<input type="hidden" id="year"		 name="year" />
			<input type="hidden" id="yearNm"		 name="yearNm" />
			<input type="hidden" id="scDeptGrpNm"	 name="scDeptGrpNm" />
			<input type="hidden" id="schGbnNm"		 name="schGbnNm" />
			<input type="hidden" id="analCycleNm"	 name="analCycleNm" />
			$!{searchMap.makeHiddenFind()}
			<div id="splitterBox">
				<div>
					<!-- 데이터그리드 Start -->
					<div class="blockGridListTable">
						<table id="list" summary="$!{METRIC_NM}순위 조회결과">
							<caption class="none">$!{METRIC_NM}순위 조회</caption>
							<thead><tr><th></th></tr></thead>
							<tbody><tr><td></td></tr></tbody>
						</table>
						<div id="pager"></div>
					</div>
					<!--// 데이터그리드 End -->
					<div class="blockButton_all">
						<div class="blockButton" style="float:left; text-align:left; width:80px;">
							<input id="btnExcelDown" type="button" align="middle" value="엑셀변환", alt="엑셀변환 다운로드" />
						</div>
						<!--
						<div class="blockButton">
							<ul>
								<li><input type="button" id="btnInsert" value="신규" /></li>
								<li><input type="submit" id="btnDelete" value="삭제" /></li>
							</ul>
						</div>
						-->
					</div>
				</div>
			</div>
		</form>

	</div>
	<a id="anchor"></a>
	<div class="clear"></div>
</div>
