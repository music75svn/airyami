<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="bsc.base.metricGrpJH">

    <!--
    ==================================================================   
      # 설명    : typeAlias 선언
      #    기능    : SETTING
      #    TABLE    : 
    ==================================================================
    -->
    <typeAlias alias="hashMap"             type="java.util.HashMap" />
     

    <!--
    ==================================================================   
      # 설명    : 임시지표POOL 목록 보기
      #    기능    : SELECT
      #    TABLE    : 
    ==================================================================
    -->
    <select id="getList" parameterClass="hashMap" resultClass="hashMap">
        SELECT T1.YEAR
		, T1.METRIC_GRP_ID
		, T1.METRIC_GRP_NM
		, T1.DESCRIPTION
		, F_CODE_NM('007', T1.TYPE_ID, T1.YEAR) AS TYPE_NM
		, T1.TYPE_ID
		, F_CODE_NM('013', T1.UNIT, T1.YEAR) AS UNIT_NM
		, T1.UNIT
		, F_CODE_NM('008', T1.EVAL_CYCLE, T1.YEAR) AS EVAL_CYCLE_NM
		, T1.EVAL_CYCLE
		, ( SELECT COUNT(1) FROM BSC_METRIC S1 WHERE S1.YEAR = T1.YEAR AND S1.METRIC_GRP_ID = T1.METRIC_GRP_ID ) AS METRIC_CNT
		FROM BSC_METRIC_GRP T1
		WHERE 1=1
		    AND T1.YEAR = #findYear#
		<dynamic>
            <isNotEmpty prepend="AND" property="findMetricGrpNm" >
                T1.METRIC_GRP_NM LIKE '%'|| #findMetricGrpNm# ||'%'
            </isNotEmpty>
            <isEqual prepend="AND" property="findUseYn" compareValue="Y">
                DELETE_DT IS NULL
            </isEqual>	
            <isEqual prepend="AND" property="findUseYn" compareValue="N">
                DELETE_DT IS NOT NULL
            </isEqual>
		</dynamic>
		
		<isEmpty property="sidx">
            ORDER BY METRIC_GRP_ID NULLS LAST
        </isEmpty>
        <isNotEmpty property="sidx">
            ORDER BY $sidx$ $sord$ NULLS LAST
        </isNotEmpty>
		
		
    </select>
    
    <!--
    ==================================================================   
      #    설명    : 임시지표POOL 상세 보기
      #    기능    : SELECT
      #    TABLE   : BSC_METRIC_GRP
    ==================================================================
    -->
    <select id="getDetail" parameterClass="hashMap" resultClass="hashMap">
        SELECT T1.YEAR
		, T1.METRIC_GRP_ID
		, T1.METRIC_GRP_NM
		, T1.TYPE_ID
		, T1.METRIC_PROPERTY_ID
		, T1.DESCRIPTION
		, T1.POOL_GUBUN
		, T1.EVAL_CYCLE
		, T1.TIME_ROLLUP
		, T1.UNIT
		, T1.DIRECTION_ID
		, T1.STRATEGY_ID
		, T1.CSF_ID
		, CASE WHEN T1.DELETE_DT IS NULL THEN 'Y' ELSE 'N' END AS USE_YN
		, T1.KPI_PURPOSE
		, T1.ACT_CAL_TYPE
		, T1.SCORE_CAL_TYPE_GUBUN
		, T1.SCORE_CAL_TYPE_ID
		, T1.CHARGE_SC_DEPT_ID
		, ( SELECT S1.SC_DEPT_NM FROM BSC_SC_DEPT S1 WHERE S1.YEAR = T1.YEAR AND S1.SC_DEPT_ID = T1.CHARGE_SC_DEPT_ID ) AS CHARGE_SC_DEPT_NM
		, ( SELECT COUNT(1) FROM BSC_METRIC S2 WHERE S2.YEAR = T1.YEAR AND S2.METRIC_GRP_ID = T1.METRIC_GRP_ID ) AS METRIC_CNT
		FROM BSC_METRIC_GRP T1
		WHERE 1=1
		    AND YEAR = #year#    
		    AND METRIC_GRP_ID = #metricGrpId#  
    </select>
    
    <!--
    ==================================================================   
      # 설명    : 임시지표POOL 등록
      #    기능    : INSERT
      #    TABLE    : 
    ==================================================================
    -->    
    <insert id="insertData" parameterClass="hashMap">
        <selectKey resultClass="java.lang.String" keyProperty="SEQ" >
            SELECT F_PGM_SERI('','','','','','') SEQ FROM DUAL
        </selectKey>
        INSERT INTO  ( 
             ) VALUES ( 
             )
    </insert>    
    
    <!--
    ==================================================================   
      # 설명    : 임시지표POOL 수정
      #    기능    : UPDATE
      #    TABLE    : 
    ==================================================================
    -->    
    <update id="updateData" parameterClass="hashMap">
        UPDATE  
           SET          WHERE 1 = 1 
        
    </update>    
    

    <!--
    ==================================================================   
      # 설명    : 임시지표POOL 삭제
      #    기능    : UPDATE
      #    TABLE    : 
    ==================================================================
    -->    
    <update id="deleteData" parameterClass="hashMap">
        DELETE FROM  
         WHERE 1 = 1 

    </update>
    
    
</sqlMap>


