#*************************************************************************
* CLASS 명      : activityList
* 작 업 자      : 김윤기
* 작 업 일      : 2012년 7월 30일 
* 기    능      : Activity관리
* ---------------------------- 변 경 이 력 --------------------------------
* 번호    작 업 자     작   업   일       변 경 내 용           비  고
* ----  --------  -----------------  -------------------------  -----------
*  1     김윤기      2012년 7월 30일             최 초 작 업
**************************************************************************# 
#set($curr_url = $!{context_path} + "/bsc/base/activity/activityList.vw")
<script type="text/javascript" language="javascript" >
//<![CDATA[

	var J = jQuery;
	
	J(document).ready(function(){
	
    
		/******************************************
		 * 취소버튼 (돌아가기)
		 ******************************************/
		J("#btnBack").click(function() {
			J("#formList").attr("action", "$!{context_path}/bsc/base/activity/activityList.vw?type=template").submit();
		});
        		
		/******************************************
		 * 조회
		 ******************************************/
		J("#formFind").submit(function(event) {
			J("#mode").val("ADD");
			//submit 하기전 작업추가
		});
        
		/******************************************
		 * 신규 등록
		 ******************************************/
		J("#btnInsert").click(function() {
			J("#mode").val("ADD");
			J("#formList").attr("action", "$!{context_path}/bsc/base/activity/activityModify.vw?type=template").submit();
		});
        
		/******************************************
		 * 삭제 버튼 클릭 이벤트
		 ******************************************/
		J("#btnDelete").click(function() {
			goDelete();
			return false;
		});
				
		/******************************************
		 * 체크박스 전체 선택 이벤트
		 ******************************************/
		J("#checkAll").click(function() {
			var map=J("input[name=check]");
			if(this.checked){
    			J.each(map, function(key, value){
    				J(value).attr("checked","checked");
    				J(value).parent().parent().css("background-color", "#FCFAF1");
				});	
			}else{
    			J.each(map, function(key, value){
					J(value).removeAttr("checked");
    				J(value).parent().parent().css("background-color", "white");
				});	
			}
		});
				
		/******************************************
		 * 체크박스 선택 이벤트
		 ******************************************/
		J("input[name=check]").click(function() {
			if(this.checked){
    			J(this).parent().parent().css("background-color", "#FCFAF1");
			}else{
    			J(this).parent().parent().css("background-color", "white");
			}
			
		});
				
		
	});

	/******************************************
	 * jqGrid 수정페이지 링크
	 ******************************************/
	function linkUpdate(cellvalue, options, rowObject) { 
		return '<a href=javascript:goModify(' + options.rowId + ')>' + cellvalue + '<//a>';
	}
	
	/******************************************
	 * 수정
	 ******************************************/
	function goModify(initiativeId) {
		J("#mode").val("MOD");
		J("#initiativeId").val(initiativeId);
		J("#formList").attr("action", "$!{context_path}/bsc/base/activity/activityModify.vw?type=template").submit();
	}
    
	/******************************************
	 * 삭제
	 ******************************************/
	function goDelete() {
		if(!deletable("check",true)){
			J.showMsgBox("삭제할 데이터를 선택하십시요", null, null);
		} else {
			J.showConfirmBox("삭제하시겠습니까?", "deleteDo"); //deleteDo() 콜백함수 호출
		}
	}
    
	/******************************************
	 * 삭제처리
	 ******************************************/
	function deleteDo() {
		J("#mode").val("DEL");
		J("#initiativeIds").val(deletable("check",false));
		J("#formList").attr("action", "$!{context_path}/bsc/base/activity/activityProcess.vw?type=template").submit();
		return false;
	}
	
	
	/******************************************
	 * 삭제
	 ******************************************/
	function deletable(name, type) {
		var ret;
		var codeIds="";
		var tempNum=0;
		var map = J("input[name="+name+"]");
		for(var i=0; i<map.length; i++){
			if(map[i].checked){
				codeIds += map[i].value + '|';
				tempNum++;
			}
		}
		
		if(type){
			ret=tempNum==0?false:true; 
		}else{
			ret=codeIds; 
		}
		return ret;
	}
	
	
	/******************************************
	 * 엑셀다운로드
	 ******************************************/
	function excelDownload(){
		J("#formFind").attr("action", "$!{context_path}/bsc/base/activity/activityListExcel.vw?type=excel").submit();
		return false;
	}

//]]>
</script>

<div id="Table">
	<div id="Table_blockContainer">
		<h1 class="none">Activity관리</h1>
		<div class="tableTop">
			#parse("/WEB-INF/vl/common/template/tabs.vm")
			
    		<!-- DIV S -->
			<div>
				<input type="hidden"	id="findHighPgmId"	name="findHighPgmId"	value="$!{searchMap.txt2html("findHighPgmId")}" />
				<input type="hidden" 	id="findSubPgmId"	name="findSubPgmId"		value="$!{searchMap.txt2html("findSubPgmId")}" />
				<input type="hidden"    id="findPgmId"		name="findPgmId"		value="$!{searchMap.txt2html("findPgmId")}" />

				<div class="searchBox">
    				<div><div><div>
    				<table summary="Activity관리검색 조건">
						<caption class="none">Activity관리 검색 조건</caption> 
						<thead><tr><th></th></tr></thead>
        				<tbody>
            				<tr>
    							<td class="searchBox_tit w150">
            						<span><label for="year">$!{YEARMON}</label></span>
									<span class="searchBar">
										$!{searchMap.txt2html("year")}년
                                    </span>
            					</td>
    							<td class="searchBox_tit w200">
            						<span><label for="scDeptId">$!{SC_DEPT_NM}</label></span>
									<span class="searchBar">
										$!{searchMap.txt2html("scDeptNm")}
                                    </span>
            					</td>
            					<td class="searchBox_tit w500">
    								<span><label for="metricId">$!{METRIC_NM}</label></span>
									<span class="searchBar">
										$!{searchMap.txt2html("metricNm")}
                                    </span>
								</td>
								
            				</tr>
        				</tbody>
    				</table>
                    </div></div></div>
    	        </div>
    		</div>
    		<!-- DIV E -->
			<div class="clear"></div>
		</div>
		
		<form id="formList" name="formList" method="post" action="$!{context_path}/bsc/base/activity/activityProcess.vw?type=template">
			<input type="hidden" id="mode"		 	name="mode"			value="$!{searchMap.txt2html("mode")}"/>
			<input type="hidden" id="year" 		 	name="year" 		value="$!{searchMap.txt2html("year")}"/>
			<input type="hidden" id="scDeptId"   	name="scDeptId" 	value="$!{searchMap.txt2html("scDeptId")}"/>
			<input type="hidden" id="scDeptNm"	 	name="scDeptNm" 	value="$!{searchMap.txt2html("scDeptNm")}"/>
			<input type="hidden" id="metricId" 	 	name="metricId" 	value="$!{searchMap.txt2html("metricId")}"/>
			<input type="hidden" id="metricNm"	 	name="metricNm" 	value="$!{searchMap.txt2html("metricNm")}"/>	
			<input type="hidden" id="initiativeId" 	name="initiativeId"/>	
			<input type="hidden" id="initiativeIds" name="initiativeIds"/>	
			
			$!{searchMap.makeHiddenFind()}
			<div id="splitterBox">
				<div>
        			<div class="blockListTable" id="abcde">					
        				<table summary=" " >
        					<caption></caption>
            				<colgroup>
            					<col width="57px" />
            					<col width="276px" />
            					<col width="57px" />
            					<col width="57px" />
            					<col width="57px" />
            					<col width="57px" />
            					<col width="57px" />
            					<col width="57px" />
            					<col width="57px" />
            					<col width="57px" />
            					<col width="57px" />
            					<col width="57px" />
            					<col width="57px" />
            					<col width="57px" />
            					<col width="*"/>
            				</colgroup>								
        					<thead>
        						<tr>
        							<th scope="col"  rowspan="2"><input type="checkbox"  id="checkAll" name="checkAll" title="전체선택"/></th>
        							<th scope="col"  rowspan="2">$ACTIVITY_NM 실행계획</th>
        							<th scope="col"  colspan="12">일정</th>
        							<th scope="col"   rowspan="2">산출물</th>
        						</tr>
        						<tr>
        							<th scope="col">1월</th>
        							<th scope="col">2월</th>
        							<th scope="col">3월</th>
        							<th scope="col">4월</th>
        							<th scope="col">5월</th>
        							<th scope="col">6월</th>
        							<th scope="col">7월</th>
        							<th scope="col">8월</th>
        							<th scope="col">9월</th>
        							<th scope="col">10월</th>
        							<th scope="col">11월</th>
        							<th scope="col">12월</th>
        						</tr>
        					</thead>
        				</table>
        			</div>			
        			<div class="tableContent" style="height:$!{jqGrid_height}px;overflow:auto;overflow-x:hidden">					
        				<table summary=" " id="tb_list" width="100%" >
        					<caption></caption>
            				<colgroup>
            					<col width="57px" />
            					<col width="276px" />
            					<col width="57px" />
            					<col width="57px" />
            					<col width="57px" />
            					<col width="57px" />
            					<col width="57px" />
            					<col width="57px" />
            					<col width="57px" />
            					<col width="57px" />
            					<col width="57px" />
            					<col width="57px" />
            					<col width="57px" />
            					<col width="57px" />
            					<col width="*"/>
            				</colgroup>								
        					<tbody>
								#set($start_dt  = 0)
								#set($start_dt2 = 0)
								#set($start_dt3 = 0)
								#set($start_dt4 = 0)
								#set($start_dt5 = 0)
								#set($start_dt6 = 0)
								#set($end_dt    = 0)
								#set($end_dt2   = 0)
								#set($end_dt3   = 0)
								#set($end_dt4   = 0)
								#set($end_dt5   = 0)
								#set($end_dt6   = 0)
								
        						#foreach($detailList in $detailList)
									#if($CS_HTML.txt2html($detailList.PLAN_START_DT)!="")
										#set($start_dt =  $!{CS_STATIC.toNumber($CS_STATIC.nullToZero($CS_HTML.txt2html($detailList.PLAN_START_DT)))})
    									#set($end_dt =  $!{CS_STATIC.toNumber($CS_STATIC.nullToZero($CS_HTML.txt2html($detailList.PLAN_END_DT)))})
									#end
									#if($CS_HTML.txt2html($detailList.PLAN_START_DT2)!="")
										#set($start_dt2 =  $!{CS_STATIC.toNumber($CS_STATIC.nullToZero($CS_HTML.txt2html($detailList.PLAN_START_DT2)))})
    									#set($end_dt2 =  $!{CS_STATIC.toNumber($CS_STATIC.nullToZero($CS_HTML.txt2html($detailList.PLAN_END_DT2)))})
									#end
									#if($CS_HTML.txt2html($detailList.PLAN_START_DT3)!="")
										#set($start_dt3 =  $!{CS_STATIC.toNumber($CS_STATIC.nullToZero($CS_HTML.txt2html($detailList.PLAN_START_DT3)))})
    									#set($end_dt3 =  $!{CS_STATIC.toNumber($CS_STATIC.nullToZero($CS_HTML.txt2html($detailList.PLAN_END_DT3)))})
									#end
									#if($CS_HTML.txt2html($detailList.PLAN_START_DT4)!="")
										#set($start_dt4 =  $!{CS_STATIC.toNumber($CS_STATIC.nullToZero($CS_HTML.txt2html($detailList.PLAN_START_DT4)))})
    									#set($end_dt4 =  $!{CS_STATIC.toNumber($CS_STATIC.nullToZero($CS_HTML.txt2html($detailList.PLAN_END_DT4)))})
									#end
									#if($CS_HTML.txt2html($detailList.PLAN_START_DT5)!="")
										#set($start_dt5 =  $!{CS_STATIC.toNumber($CS_STATIC.nullToZero($CS_HTML.txt2html($detailList.PLAN_START_DT5)))})
    									#set($end_dt5 =  $!{CS_STATIC.toNumber($CS_STATIC.nullToZero($CS_HTML.txt2html($detailList.PLAN_END_DT5)))})
									#end
									#if($CS_HTML.txt2html($detailList.PLAN_START_DT6)!="")
										#set($start_dt6 =  $!{CS_STATIC.toNumber($CS_STATIC.nullToZero($CS_HTML.txt2html($detailList.PLAN_START_DT6)))})
    									#set($end_dt6 =  $!{CS_STATIC.toNumber($CS_STATIC.nullToZero($CS_HTML.txt2html($detailList.PLAN_END_DT6)))})
									#end
									
                                <tr>
									<td><input type="checkbox"  name="check"  value="$!{CS_HTML.txt2html($detailList.INITIATIVE_ID)}" title="선택"/></td>
									#if($!{CS_HTML.txt2html($detailList.UP_INITIATIVE_ID)}=="")	
        								<td  style="line-height:20px; text-align:left;padding:0px 0px 0px 0px;padding-left:10px;" title="$!{CS_HTML.txt2html($detailList.PLAN_DESC)}">
									#else
        								<td  style="line-height:20px; text-align:left;padding:0px 0px 0px 0px;padding-left:20px;" title="$!{CS_HTML.txt2html($detailList.PLAN_DESC)}">
									#end
											<a href="javascript:goModify('$!{CS_HTML.txt2html($detailList.INITIATIVE_ID)}')" >
            									#if($!{CS_HTML.txt2html($detailList.UP_INITIATIVE_ID)}=="")	
    												$!{CS_HTML.txt2html($detailList.INITIATIVE_NM)}
            									#else
    												┗$!{CS_HTML.txt2html($detailList.INITIATIVE_NM)}
												#end
											</a>
        								</td>
									<td  colspan="12" >
										<table  width="100%"  summary=" ">	
											<tr>
												#foreach($i in [1..12])
													#if($i >= $start_dt && $i <= $end_dt )
													<td style=" border:0px; line-height:20px;text-align:left; padding:0px 0px 0px 0px; ">
    													#if($i == $end_dt )
												    		<div style="background-color:#7CFC00;width:90%;" >&nbsp;</div>
												    	#else
												    		<div style="background-color:#7CFC00;width:100%;">&nbsp;</div>
												    	#end
												    </td>
													#elseif(($i >= $start_dt2 && $i <= $end_dt2 )) 
												    <td style=" border:0px; line-height:20px;text-align:left; padding:0px 0px 0px 0px; ">
    													#if($i == $end_dt2 )
															<div style="background-color:#7CFC00;width:90%;" >&nbsp;</div>
												    	#else
															<div style="background-color:#7CFC00;width:100%;" >&nbsp;</div>
												    	#end
												    </td>
													#elseif(($i >= $start_dt3 && $i <= $end_dt3 )) 
												    <td style=" border:0px; line-height:20px;text-align:left; padding:0px 0px 0px 0px; "> 
    													#if($i == $end_dt3 )
															<div style="background-color:#7CFC00;width:90%;" >&nbsp;</div>
												    	#else
															<div style="background-color:#7CFC00;width:100%;" >&nbsp;</div>
												    	#end
												    </td>
													#elseif(($i >= $start_dt4 && $i <= $end_dt4 )) 
												    <td style=" border:0px; line-height:20px;text-align:left; padding:0px 0px 0px 0px; ">
    													#if($i == $end_dt4 )
															<div style="background-color:#7CFC00;width:90%;" >&nbsp;</div>
												    	#else
															<div style="background-color:#7CFC00;width:100%;" >&nbsp;</div>
												    	#end
												    </td>
													#elseif(($i >= $start_dt5 && $i <= $end_dt5 )) 
												    <td style=" border:0px; line-height:20px;text-align:left; padding:0px 0px 0px 0px; ">
    													#if($i == $end_dt5 )
															<div style="background-color:#7CFC00;width:90%;" >&nbsp;</div>
												    	#else
															<div style="background-color:#7CFC00;width:100%;" >&nbsp;</div>
												    	#end
												    </td>
													#elseif(($i >= $start_dt6 && $i <= $end_dt6 )) 
												    <td style=" border:0px; line-height:20px;text-align:left; padding:0px 0px 0px 0px; ">
    													#if($i == $end_dt6 )
															<div style="background-color:#7CFC00;width:90%;" >&nbsp;</div>
												    	#else
															<div style="background-color:#7CFC00;width:100%;" >&nbsp;</div>
												    	#end
												    </td>
													#else
													<td style=" border:0px; line-height:20px;text-align:left; padding:0px 0px 0px 0px; ">&nbsp;</td>
													#end
												#end
													 #set($start_dt  = 0) 
													 #set($start_dt2 = 0) 
													 #set($start_dt3 = 0) 
													 #set($start_dt4 = 0) 
													 #set($start_dt5 = 0) 
													 #set($start_dt6 = 0) 
													 #set($end_dt    = 0) 
													 #set($end_dt2   = 0) 
													 #set($end_dt3   = 0) 
													 #set($end_dt4   = 0) 
													 #set($end_dt5   = 0) 
													 #set($end_dt6   = 0) 
											</tr>
										</table>
									</td>		
                                    <td  class="textLeft">$!{CS_HTML.txt2html($detailList.PRODUCT)}</td>
        						</tr>
        						#end
                            </tbody>
                        </table>
                    </div>					
					<div class="blockButton_all">
						<div class="blockButton_l"></div>
						<div class="blockButton">
							<ul>
								<li><input type="button" id="btnBack"   value="돌아가기"/></li>
								<li><input type="submit" id="btnInsert" value="신규" /></li>
								<li><input type="button" id="btnDelete" value="삭제" /></li>
							</ul>
						</div>
					</div>
				</div>
			</div>
		</form>
		
	</div>
	<div class="clear"></div>
</div>
