<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="prs.mng.planHistory">

    <!--
    ==================================================================   
      # 설명    : typeAlias 선언
      #    기능    : SETTING
      #    TABLE    : 
    ==================================================================
    -->
    <typeAlias alias="hashMap"             type="java.util.HashMap" />
     

    <!--
    ==================================================================   
      # 설명    : 성과계획서(팝업) 목록 보기
      #    기능    : SELECT
      #    TABLE    : 
    ==================================================================
    -->
    <select id="getList" parameterClass="hashMap" resultClass="hashMap">
         SELECT A.YEAR
			 , A.EVAL_MEMB_EMPN
			 , A.EVAL_MEMB_EMPN_SEQ
			 , A.KOR_NM
			 , B.SEQ
			 , A.DEPT_CD
			 , F_DEPT_FULL_NM(A.YEAR,A.DEPT_CD,'BSC_INSA_DEPT') DEPT_FULL_NM
			 , A.CAST_TC
			 , A.POS_TC
			 , F_CODE_NM('170', A.CAST_TC , A.YEAR) CAST_TC_NM 
             , F_CODE_NM('171', A.POS_TC , A.YEAR) POS_TC_NM 
			 , A.PRS_YN
			 , A.EVAL_GRP_ID
			 , A.FROM_DT
			 , A.TO_DT
			 , C.PLAN_YN
             , TO_CHAR(B.FINAL_APPROVE_DT,'YYYY.MM.DD')AS FINAL_APPROVE_DT
             , B.APPROVE_USER_ID
             , B.APPROVE_USER_NM
		FROM PRS_MNG_MEMBER A
		 LEFT OUTER JOIN PRS_MNG_PLAN_HISTORY B ON A.YEAR = B.YEAR AND A.EVAL_MEMB_EMPN = B.EVAL_MEMB_EMPN AND A.EVAL_MEMB_EMPN_SEQ = B.EVAL_MEMB_EMPN_SEQ
		 LEFT OUTER JOIN PRS_EVAL_GRP C ON A.YEAR = C.YEAR AND A.EVAL_GRP_ID = C.EVAL_GRP_ID
		 LEFT OUTER JOIN BSC_INSA_DEPT D ON A.YEAR = D.YEAR AND A.DEPT_CD = D.DEPT_CD
		 WHERE A.YEAR				 = #findYear#
		  AND  A.EVAL_MEMB_EMPN      = #evalMembEmpn#
		  AND  A.EVAL_MEMB_EMPN_SEQ  = #evalMembEmpnSeq#
		  AND  A.PRS_YN 		 	 ='Y'
		 ORDER BY B.SEQ
    </select>
    
    <!--
    ==================================================================   
      # 설명    : 성과계획서(팝업) 상세 보기
      #    기능    : SELECT
      #    TABLE    : 
    ==================================================================
    -->
    <select id="getFindMember" parameterClass="hashMap" resultClass="hashMap">
       SELECT A.YEAR
			 , A.EVAL_MEMB_EMPN
			 , A.EVAL_MEMB_EMPN_SEQ
			 , C.PLAN_YN
		FROM PRS_MNG_MEMBER A
		 LEFT OUTER JOIN PRS_EVAL_GRP C ON A.YEAR = C.YEAR AND A.EVAL_GRP_ID = C.EVAL_GRP_ID
		 WHERE A.YEAR				= #findYear#
		  AND A.EVAL_MEMB_EMPN      = #evalMembEmpn#
		  AND A.EVAL_MEMB_EMPN_SEQ  = #evalMembEmpnSeq#
		  AND A.PRS_YN 				='Y'
		 <!--  AND C.PLAN_YN 			='Y'    -->       
    </select>
    
     <!--
    ==================================================================   
      # 설명    : 성과계획서 관리 성과목표목록 보기
      #    기능    : SELECT
      #    TABLE    : 
    ==================================================================
    -->
    <select id="getPlanList" parameterClass="hashMap" resultClass="hashMap">
         SELECT   A.YEAR
         		, A.SEQ
				, A.DIRECTION_CD
				, F_CODE_NM('218', A.DIRECTION_CD , A.YEAR) DIRECTION_NM 
				, A.TARGET_ID
				, A.TARGET_NM
				, A.METRIC_NM
				, A.TARGET_VALUE
                , A.TARGET_BASIS
				, A.UNIT
				, F_CODE_NM('013', A.UNIT , A.YEAR) UNIT_NM 
				, A.Q1_TARGET_VALUE
				, A.Q2_TARGET_VALUE
				, A.Q3_TARGET_VALUE
				, A.Q4_TARGET_VALUE
				, A.CONTENT
		 FROM  PRS_MNG_TARGET_HISTORY A
		 WHERE A.YEAR				 = #findYear#
		   AND A.EVAL_MEMB_EMPN      = #evalMembEmpn#
		   AND A.EVAL_MEMB_EMPN_SEQ  = #evalMembEmpnSeq#
		   AND A.SEQ = #seq#
		 ORDER BY A.DIRECTION_CD, A.TARGET_ID 
    </select>    
    
</sqlMap>


