#*************************************************************************
* CLASS 명      : metricInitActPlanList
* 작 업 자      : 김윤기
* 작 업 일      : 2012년 9월 1일 
* 기    능      : 년간ACTIVITY계획
* ---------------------------- 변 경 이 력 --------------------------------
* 번호    작 업 자     작   업   일       변 경 내 용           비  고
* ----  --------  -----------------  -------------------------  -----------
*  1     김윤기      2012년 9월 1일             최 초 작 업
**************************************************************************# 
#set($curr_url = $!{context_path} + "/bsc/mon/metricActivityPlan/metricInitActPlanList.vw")
<script type="text/javascript" language="javascript" >
//<![CDATA[

	var J = jQuery;
	
	J(document).ready(function(){
	
		/******************************************
		 * 요약보고서버튼 클릭 이벤트
		 ******************************************/
		J("#btnSummaryReport").click(function() {
			J("#formList").attr("action", "$!{context_path}/bsc/mon/deptSummaryReport/deptSummaryReportList.vw?type=template").submit();
		});
	
    	/******************************************
    	 * 돌아가기버튼 클릭 이벤트
    	 ******************************************/
    	J("#btnBack").click(function() {
    		J("#formFind").attr("action", "$!{context_path}/bsc/mon/orgDetail/orgDetailList.vw?type=template").submit();
    	});
    
		/******************************************
		 * 엑셀다운로드 버튼 클릭 이벤트
		 ******************************************/
		J("#btnExcelDown").click(function() {
			excelDownload();
			return false;
		});
	});

	/******************************************
	 * 엑셀다운로드
	 ******************************************/
	function excelDownload(){
		J("#formFind").attr("action", "$!{context_path}/bsc/mon/metricActivityPlan/metricInitActPlanListExcel.vw?type=excel").submit();
		return false;
	}

//]]>
</script>

<div id="Table">
	<div id="Table_blockContainer">
		<h1 class="none">년간ACTIVITY계획</h1>
		<div class="tableTop">
			#parse("/WEB-INF/vl/common/template/tabs.vm")
    		<!-- search S -->
			<form id="formFind" name="formFind" method="post" action="$!{context_path}/bsc/mon/metricActivityPlan/metricInitActPlanList.vw?type=template">
    			<input type="hidden"    name="year"	        value="$!{searchMap.txt2html("year")}"/>
    			<input type="hidden"    name="mon"		 	value="$!{searchMap.txt2html("mon")}"/>
    			<input type="hidden"    name="scDeptId"	    value="$!{searchMap.txt2html("scDeptId")}"/>  
    			<input type="hidden"    name="strategyId"	value="$!{searchMap.txt2html("strategyId")}"/>
    			<input type="hidden"    name="metricId"	    value="$!{searchMap.txt2html("metricId")}"/>
    			<input type="hidden"    name="analCycle"	value="$!{searchMap.txt2html("analCycle")}"/>
				$!{searchMap.makeHiddenFind()}
				<div class="searchBox">
    				<div><div><div>
    				<table summary="년간ACTIVITY계획검색 조건">
						<caption class="none">년간ACTIVITY계획 검색 조건</caption> 
						<thead><tr><th></th></tr></thead>
        				<tbody>
            				<tr>
    							<td class="searchBox_tit w140">
            						<span><label>$!{YEARMON}</label></span>
            						<span class="searchBar">
    									$!{CS_CODE.getCodeName('017', $!{searchMap.txt2html("year")}, $!{searchMap.txt2html("year")})}
            						</span>
            					</td>
            					<td class="searchBox_tit w270">
    								<span><label>$!{SC_DEPT_NM}</label></span>
            						<span class="searchBar">
										$!{CS_UTIL.reduceString($CS_HTML.txt2html($scDeptNm),27)}
    								</span>
                                </td>            					
            					<td class="searchBox_tit w250">
                					<span><label> $!{STRATEGY_NM}</label></span>
            						<span class="searchBar">
										$!{CS_UTIL.reduceString($CS_HTML.txt2html($strategyNm),27)}
            						</span>
                                </td>            					
            					<td class="searchBox_tit w250">
                					<span><label> $!{METRIC_NM}</label></span>
            						<span class="searchBar">
										$!{CS_UTIL.reduceString($CS_HTML.txt2html($metricNm),20)}
            						</span>
                                </td>            					
            					<td class="searchBox_tit w100">
                					<span><label> $!{KPI_NM}담당자</label></span>
            						<span class="searchBar">
										$CS_HTML.txt2html($userNm)
            						</span>
                                </td>            					
            				</tr>
        				</tbody>
    				</table>
                    </div></div></div>
    	        </div>
    		</form>
    		<!-- search E -->
			<div class="clear"></div>
		</div>
		<form id="formList" name="formList" method="post" action="$!{context_path}/bsc/mon/metricActivityPlan/metricActivityPlanProcess.vw?type=template">
			<div id="splitterBox1">
				<div>
					<div class="blockButton_all">
						<div class="blockButton">
							<ul>
								<!--<li><input type="button" id="btnSummaryReport" 	value="요약보고서" /></li>-->
								<li><input type="button" id="btnBack" value="돌아가기"/></li>
							</ul>
						</div>
					</div>
				</div>
			</div>
			<div class="h40"></div>
			
			<div id="splitterBox2">
				<div>
        			<div class="blockListTable">					
        				<table summary=" " >
        					<caption></caption>
                				<colgroup>
                					<col width="24%" />
                					<col width="5%" />
                					<col width="5%" />
                					<col width="5%" />
                					<col width="5%" />
                					<col width="5%" />
                					<col width="5%" />
                					<col width="5%" />
                					<col width="5%" />
                					<col width="5%" />
                					<col width="5%" />
                					<col width="5%" />
                					<col width="5%" />
                					<col width="24%"/>
                				</colgroup>								
        					<thead>
        						<tr>
        							<th scope="col"  rowspan="2">$ACTIVITY_NM 실행계획</th>
        							<th scope="col"  colspan="12">일정</th>
        							<th scope="col"  rowspan="2">산출물</th>
        						</tr>
        						<tr>
        							<th scope="col">1월</th>
        							<th scope="col">2월</th>
        							<th scope="col">3월</th>
        							<th scope="col">4월</th>
        							<th scope="col">5월</th>
        							<th scope="col">6월</th>
        							<th scope="col">7월</th>
        							<th scope="col">8월</th>
        							<th scope="col">9월</th>
        							<th scope="col">10월</th>
        							<th scope="col">11월</th>
        							<th scope="col">12월</th>
        						</tr>
        					</thead>
        				</table>
        			</div>			
        			<div class="tableContent">					
        				<table summary=" " id="tb_list" width="100%" >
        					<caption></caption>
            				<colgroup>
            					<col width="24%" />
            					<col width="5%" />
            					<col width="5%" />
            					<col width="5%" />
            					<col width="5%" />
            					<col width="5%" />
            					<col width="5%" />
            					<col width="5%" />
            					<col width="5%" />
            					<col width="5%" />
            					<col width="5%" />
            					<col width="5%" />
            					<col width="5%" />
            					<col width="24%"/>
            				</colgroup>								
        					<tbody>
								#set($start_dt  = 0)
								#set($start_dt2 = 0)
								#set($start_dt3 = 0)
								#set($start_dt4 = 0)
								#set($start_dt5 = 0)
								#set($start_dt6 = 0)
								#set($end_dt    = 0)
								#set($end_dt2   = 0)
								#set($end_dt3   = 0)
								#set($end_dt4   = 0)
								#set($end_dt5   = 0)
								#set($end_dt6   = 0)
								
        						#foreach($activityList in $activityList)
									#if($CS_HTML.txt2html($activityList.PLAN_START_DT)!="")
										#set($start_dt =  $!{CS_STATIC.toNumber($CS_STATIC.nullToZero($CS_HTML.txt2html($activityList.PLAN_START_DT)))})
    									#set($end_dt =  $!{CS_STATIC.toNumber($CS_STATIC.nullToZero($CS_HTML.txt2html($activityList.PLAN_END_DT)))})
									#end
									#if($CS_HTML.txt2html($activityList.PLAN_START_DT2)!="")
										#set($start_dt2 =  $!{CS_STATIC.toNumber($CS_STATIC.nullToZero($CS_HTML.txt2html($activityList.PLAN_START_DT2)))})
    									#set($end_dt2 =  $!{CS_STATIC.toNumber($CS_STATIC.nullToZero($CS_HTML.txt2html($activityList.PLAN_END_DT2)))})
									#end
									#if($CS_HTML.txt2html($activityList.PLAN_START_DT3)!="")
										#set($start_dt3 =  $!{CS_STATIC.toNumber($CS_STATIC.nullToZero($CS_HTML.txt2html($activityList.PLAN_START_DT3)))})
    									#set($end_dt3 =  $!{CS_STATIC.toNumber($CS_STATIC.nullToZero($CS_HTML.txt2html($activityList.PLAN_END_DT3)))})
									#end
									#if($CS_HTML.txt2html($activityList.PLAN_START_DT4)!="")
										#set($start_dt4 =  $!{CS_STATIC.toNumber($CS_STATIC.nullToZero($CS_HTML.txt2html($activityList.PLAN_START_DT4)))})
    									#set($end_dt4 =  $!{CS_STATIC.toNumber($CS_STATIC.nullToZero($CS_HTML.txt2html($activityList.PLAN_END_DT4)))})
									#end
									#if($CS_HTML.txt2html($activityList.PLAN_START_DT5)!="")
										#set($start_dt5 =  $!{CS_STATIC.toNumber($CS_STATIC.nullToZero($CS_HTML.txt2html($activityList.PLAN_START_DT5)))})
    									#set($end_dt5 =  $!{CS_STATIC.toNumber($CS_STATIC.nullToZero($CS_HTML.txt2html($activityList.PLAN_END_DT5)))})
									#end
									#if($CS_HTML.txt2html($activityList.PLAN_START_DT6)!="")
										#set($start_dt6 =  $!{CS_STATIC.toNumber($CS_STATIC.nullToZero($CS_HTML.txt2html($activityList.PLAN_START_DT6)))})
    									#set($end_dt6 =  $!{CS_STATIC.toNumber($CS_STATIC.nullToZero($CS_HTML.txt2html($activityList.PLAN_END_DT6)))})
									#end
									
                                <tr>
									#if($!{CS_HTML.txt2html($activityList.UP_INITIATIVE_ID)}=="")	
        								<td  style="line-height:20px; text-align:left;padding:0px 0px 0px 0px;padding-left:10px;" title="$!{CS_HTML.txt2html($activityList.PLAN_DESC)}">
									#else
        								<td  style="line-height:20px; text-align:left;padding:0px 0px 0px 0px;padding-left:20px;" title="$!{CS_HTML.txt2html($activityList.PLAN_DESC)}">
									#end
        									#if($!{CS_HTML.txt2html($activityList.UP_INITIATIVE_ID)}=="")	
    											$!{CS_HTML.txt2html($activityList.INITIATIVE_NM)}
        									#else
    											┗$!{CS_HTML.txt2html($activityList.INITIATIVE_NM)}
    										#end
        								</td>
									<td  colspan="12" >
										<table  width="100%"  summary=" ">	
											<tr>
												#foreach($i in [1..12])
													#if($i >= $start_dt && $i <= $end_dt )
													<td style=" border:0px; line-height:20px;text-align:left; padding:0px 0px 0px 0px; ">
    													#if($i == $end_dt )
												    		<div style="background-color:#7CFC00;width:90%;" >&nbsp;</div>
												    	#else
												    		<div style="background-color:#7CFC00;width:100%;">&nbsp;</div>
												    	#end
												    </td>
													#elseif(($i >= $start_dt2 && $i <= $end_dt2 )) 
												    <td style=" border:0px; line-height:20px;text-align:left; padding:0px 0px 0px 0px; ">
    													#if($i == $end_dt2 )
															<div style="background-color:#7CFC00;width:90%;" >&nbsp;</div>
												    	#else
															<div style="background-color:#7CFC00;width:100%;" >&nbsp;</div>
												    	#end
												    </td>
													#elseif(($i >= $start_dt3 && $i <= $end_dt3 )) 
												    <td style=" border:0px; line-height:20px;text-align:left; padding:0px 0px 0px 0px; "> 
    													#if($i == $end_dt3 )
															<div style="background-color:#7CFC00;width:90%;" >&nbsp;</div>
												    	#else
															<div style="background-color:#7CFC00;width:100%;" >&nbsp;</div>
												    	#end
												    </td>
													#elseif(($i >= $start_dt4 && $i <= $end_dt4 )) 
												    <td style=" border:0px; line-height:20px;text-align:left; padding:0px 0px 0px 0px; ">
    													#if($i == $end_dt4 )
															<div style="background-color:#7CFC00;width:90%;" >&nbsp;</div>
												    	#else
															<div style="background-color:#7CFC00;width:100%;" >&nbsp;</div>
												    	#end
												    </td>
													#elseif(($i >= $start_dt5 && $i <= $end_dt5 )) 
												    <td style=" border:0px; line-height:20px;text-align:left; padding:0px 0px 0px 0px; ">
    													#if($i == $end_dt5 )
															<div style="background-color:#7CFC00;width:90%;" >&nbsp;</div>
												    	#else
															<div style="background-color:#7CFC00;width:100%;" >&nbsp;</div>
												    	#end
												    </td>
													#elseif(($i >= $start_dt6 && $i <= $end_dt6 )) 
												    <td style=" border:0px; line-height:20px;text-align:left; padding:0px 0px 0px 0px; ">
    													#if($i == $end_dt6 )
															<div style="background-color:#7CFC00;width:90%;" >&nbsp;</div>
												    	#else
															<div style="background-color:#7CFC00;width:100%;" >&nbsp;</div>
												    	#end
												    </td>
													#else
													<td style=" border:0px; line-height:20px;text-align:left; padding:0px 0px 0px 0px; ">&nbsp;</td>
													#end
												#end
													 #set($start_dt  = 0) 
													 #set($start_dt2 = 0) 
													 #set($start_dt3 = 0) 
													 #set($start_dt4 = 0) 
													 #set($start_dt5 = 0) 
													 #set($start_dt6 = 0) 
													 #set($end_dt    = 0) 
													 #set($end_dt2   = 0) 
													 #set($end_dt3   = 0) 
													 #set($end_dt4   = 0) 
													 #set($end_dt5   = 0) 
													 #set($end_dt6   = 0) 
											</tr>
										</table>
									</td>		
                                    <td  class="textLeft">$!{CS_HTML.txt2html($activityList.PRODUCT)}</td>
        						</tr>
        						#end
                            </tbody>
                        </table>
                    </div>
				</div>
			</div>	
			<div id="splitterBox">
				<div>
					#foreach( $monthData in $list )
					<div class="blockListTable">
					<table summary="">
					<caption></caption>
    				<thead>
						<tr>
							<th scope="col" colspan="6">$monthData.MON 월</th>
						</tr>
                    </thead>
					<tbody>
						<tr>
							<th scope="col" colspan="2">당월계획</th>
							<th scope="col" colspan="2">실적</th>
							<th scope="col" colspan="2">미진사유</th>
						</tr>
						<tr>
							<td colspan="2">$!{CS_HTML.txt2html($monthData.PLAN_CONTENTS_1MON)}&nbsp;</td>
							<td colspan="2">$!{CS_HTML.txt2html($monthData.ACT_CONTENTS)}</td>
							<td colspan="2">$!{CS_HTML.txt2html($monthData.CAUSE_DESC)}</td>
						</tr>
						<tr>
							<th scope="col" colspan="2">첨부파일</th>
							<td colspan="4" style="text-align:left">
							#if ( 0 < $monthData.ATTACH_FILE_CNT )
								#foreach( $attachFile in $attachFileList )
									#if ( $monthData.MON == $attachFile.MON )
								$!{CS_HTML.makeFileIconFileName($attachFile.get("ATTACH_FILE_SUFFIX"), $attachFile.get("ATTACH_FILE_NM"), $attachFile.get("ATTACH_FILE_PATH"))} <br/>
									#end
								#end
							#end
							</td>
						</tr>
						<tr>
							<th scope="col" colspan="3">차월계획</th>
							<th scope="col" colspan="3">Catch-up</th>
						</tr>
						<tr>
							<td colspan="3">$!{CS_HTML.txt2html($monthData.NEXT_PLAN_CONTENTS)}&nbsp;</td>
							<td colspan="3">$!{CS_HTML.txt2html($monthData.CAUSE_DESC)}</td>
						</tr>
					</tbody>	
					</table>
					</div>
					<div class="h20"></div>
					#end
					
				</div>
			</div>
		</form>
	</div>
	<div class="clear"></div>
</div>
