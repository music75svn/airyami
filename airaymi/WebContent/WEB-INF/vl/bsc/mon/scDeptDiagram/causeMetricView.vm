#*************************************************************************
* CLASS 명      : causeMetricView
* 작 업 자      : 현걸욱
* 작 업 일      : 2012년 7월 24일 
* 기    능      : 실적관리
* ---------------------------- 변 경 이 력 --------------------------------
* 번호    작 업 자     작   업   일       변 경 내 용           비  고
* ----  --------  -----------------  -------------------------  -----------
*  1     하윤식      2012년 7월 24일             최 초 작 업
**************************************************************************#
#set($context_path = $!{searchMap.txt2html("context")})
#set($curr_url = $!{context_path} + "/bsc/mon/scDeptDiagram/causeMetricView.vw")
<script type="text/javascript" language="javascript" >
//<![CDATA[

	var J = jQuery;
	
	J(document).ready(function(){
	
		/******************************************
		 * 저장버튼 이벤트
		 ******************************************/
		J("#btnInsert").click(function(e) {
			e.preventDefault();
			saveChk();
		});
    	
    	/******************************************
         * 미진사유저장버튼 이벤트
         ******************************************/
        J("#btnInsertDesc").click(function() {
            saveDescChk();
        });
        
	});
	
	/******************************************
	 * 의견 필수입력 체크
	 ******************************************/
	function saveChk() {
		if(!LengthCheck(J("#opnion").val(), "의견", 1, 4000 ) ) {
            J("#opnion").focus();
            return false;
        }
		J.showConfirmBox("저장하시겠습니까?", "saveDo"); //saveDo() 콜백함수 호출
	}
	/******************************************
     * 미진사유 필수입력 체크
     ******************************************/
    function saveDescChk() {
        if(!LengthCheck(J("#causeDesc").val(), "미진사유", 1, 4000 ) ) {
            J("#causeDesc").focus();
            return false;
        }
	    	
        J.showConfirmBox("저장하시겠습니까?", "saveDescDo"); //saveDescDo() 콜백함수 호출
    }
    
	/******************************************
	 * 의견 저장
	 ******************************************/
	function saveDo() {
		J("#form1").attr("action", "$!{context_path}/bsc/mon/scDeptDiagram/scDeptDiagramProcess.vw?mode=OPNION&amp;type=template").submit();
	}
	
	/******************************************
	 * 미진사유 저장
	 ******************************************/
	function saveDescDo() {
		J("#form1").attr("action", "$!{context_path}/bsc/mon/scDeptDiagram/scDeptDiagramProcess.vw?mode=DESC&amp;type=template").submit();
	}
	
//]]>
</script>
<form id="form1" name="form1" method="post" action="$!{context_path}/bsc/mon/scDeptDiagram/scDeptDiagramProcess.vw?type=template">
	<input type="hidden" id="metricId"	name="metricId"		value="$!{searchMap.txt2html("metricId")}" />
	<input type="hidden" id="findAnalCycle"	name="findAnalCycle"	value="$!{searchMap.txt2html("analCycle")}" />
	<input type="hidden" id="findDiagramGubun"	name="findDiagramGubun"	value="$!{searchMap.txt2html("diagramGubun")}" />
	<input type="hidden" id="findSelScDeptId"	name="findSelScDeptId"	value="$!{searchMap.txt2html("SelScDeptId")}" />
	<input type="hidden" id="#findSelMetricId"	name="#findSelMetricId"	value="$!{searchMap.txt2html("SelMetricId")}" />
	<input type="hidden"	name="userId"			id="userId"			value="$!{searchMap.txt2html("userId")}"/>
	<input type="hidden"	name="selScDeptId"			id="selScDeptId"			value="$!{searchMap.txt2html("selScDeptId")}"/>
				
	$!{searchMap.makeHiddenFind()}
	<div id="blockDetailTB" class="blockListTable">
		<table summary="실적입력">
	    	<caption class="none">실적입력</caption>
	    	<thead class="none">
	    		<tr><td width="25%"></td><td></td></tr> 
	    	</thead>
	    	<tbody>
				<tr>
					<th width="25%">미진사유</th>
					<td width="75%" class="textLeft"><textarea id="causeDesc" name="causeDesc" class="tabletext" title="미진사유" cols="" rows="5" >$!{CS_HTML.txt2html($causeDetail.CAUSE_DESC)}</textarea></td>
				</tr>
				<tr>
					<th>첨부파일</th>
					<td class="textLeft">
						#foreach($fileList in $fileList)
							$!{CS_HTML.makeFileIconFileName($fileList.get("ATTACH_FILE_SUFFIX"), $fileList.get("ATTACH_FILE_NM"), $fileList.get("ATTACH_FILE_PATH"))} 
							&nbsp;&nbsp;
						#end
					</td>
				</tr>
				
				<tr>
					<th width="25%">의견</th>
					<td width="75%" class="textLeft"><textarea id="opnion" name="opnion" class="tabletext" title="의견" cols="" rows="5">$!{CS_HTML.txt2html($causeDetail.OPNION)}</textarea></td>
				</tr>
	    	</tbody>
	    </table>
			<div class="blockButton_all">
				<div class="blockButton" style="float:left; text-align:left; width:250px;">
					<font color="blue">지표담당자,담당부장,담당처실장에게 의견을 전달합니다.</font>
				</div>
				<div class="blockButton" style="float:right; text-align:right; width:200px;">
					<ul>
						#if($!{CS_LOGIN.chkAuthGrp("01")})
	                        <li><input type="button" id="btnInsert" value="의견저장" /></li>
                    		<li><input type="button" id="btnInsertDesc" value="미진사유 저장" /></li>
	                    #else
	                    	#if($!{CS_LOGIN.chkAuthGrp("62")})
	                        	<li><input type="button" id="btnInsert" value="의견저장" /></li>
	                    	#end
		                    #if("$!{searchMap.txt2html('userId')}" == "$!{CS_LOGIN.getSabun()}")
		                    	<li><input type="button" id="btnInsertDesc" value="미진사유저장" /></li>
		                    #end
	                    #end
					</ul>
				</div>
			</div>
	</div>
	<div class="clear"></div>
</form>