#*************************************************************************
* CLASS 명      : metricMatrixList_xml
* 작 업 자      : 한봉준
* 작 업 일      : 2012년 8월 29일 
* 기    능      : 전략과제연계도 json 데이터 조회
* ---------------------------- 변 경 이 력 --------------------------------
* 번호    작 업 자     작   업   일       변 경 내 용           비  고
* ----  --------  -----------------  -------------------------  -----------
*  1      한봉준     2012년 8월 29일            최 초 작 업
**************************************************************************# 
<?xml version='1.0' encoding='utf-8'?>

<root>
   
   <attribute pdfVisible="true" pdfUrl="$!{searchMap.txt2html("context")}/bsc/module/commModule/MatrixPdfDownload" applicationBar="true" position="horizontal">
			<node attributes="목표/false,실적/false,점수/false"  name="$!{searchMap.txt2html("METRIC_NM")}연계표" />
   </attribute>
   
#set($idx = 0)

#set($listSize = $!{CS_HTML.txt2html($list.size())})

#set($listSize1 = $!{CS_HTML.txt2html($list1.size())})
#set($listSize2 = $!{CS_HTML.txt2html($list2.size())})
#set($listSize3 = $!{CS_HTML.txt2html($list3.size())})
#set($listSize4 = $!{CS_HTML.txt2html($list4.size())})
#set($listSize5 = $!{CS_HTML.txt2html($list5.size())})
#set($listSize6 = $!{CS_HTML.txt2html($list6.size())})
#set($listSize7 = $!{CS_HTML.txt2html($list7.size())})

#if($searchMap.findStrategyId == "ALL"){
	<node label="전체" color="0xff0000" fontColor="0x00ff00" title="전체$!{searchMap.txt2html("METRIC_NM")}연계표" >
#end

#if($listSize != 0)
	#if($listSize1 != 0)
    	#foreach($list1 in $list1)
    		#set($title1 = $!{CS_HTML.txt2html($!CS_SC_DEPT.getName($!{searchMap.txt2html("findYear")}, $list1.SC_DEPT_ID))}+"&#xa;"+$!{CS_HTML.txt2html($list1.STRATEGY_NM)})
    		##set($url1 = $!{searchMap.txt2html("context")}+"/bsc/mon/metricDetail/metricDetailList.vw?type=template&findYear="+$!{searchMap.txt2html("findYear")}+"&findMon="+$!{searchMap.txt2html("findMon")}+"&findAnalCycle="+$!{searchMap.txt2html("findAnalCycle")}+"&findStrategyId="+$!{CS_HTML.txt2html($list1.STRATEGY_ID)}+"&findStrategyNm="+$!{CS_HTML.txt2html($list1.STRATEGY_NM)}+"&findScDeptId="+$!{CS_HTML.txt2html($list1.SC_DEPT_ID)}+"&findScDeptNm="+$!{CS_HTML.txt2html($list1.SC_DEPT_NM)}+"&findMetricId="+$!{CS_HTML.txt2html($list1.METRIC_ID)}+"&findMetricNm="+$!{CS_HTML.txt2html($list1.METRIC_NM)}+"&findHighPgmId="+$!{searchMap.txt2html("findHighPgmId")}+"&findSubPgmId="+$!{searchMap.txt2html("findSubPgmId")}+"&findPgmId="+$!{searchMap.txt2html("findPgmId")})
			#set($url1 = $!{CS_HTML.txt2html($list1.SC_DEPT_ID)}+"|"+$!{CS_HTML.txt2html($list1.STRATEGY_ID)}+"|"+$!{CS_HTML.txt2html($list1.METRIC_ID)})
			<node label="$!{CS_HTML.txt2html($list1.METRIC_NM)}"
				color="$!{CS_HTML.txt2html($sinalMap.get($list1.STATUS))}" fontColor="0x000000" title="$!{title1}"
				attributes="목표/$!{CS_HTML.txt2html($list1.TARGET)},실적/$!{CS_HTML.txt2html($list1.ACTUAL)},점수/$!{CS_HTML.txt2html($list1.SCORE)}"
				url="$!{url1}">
        	#if($listSize2 != 0)
            	#foreach($list2 in $list2)
					#if($list1.METRIC_ID == $list2.UP_METRIC_ID)
						#set($title2 = $!{CS_HTML.txt2html($!CS_SC_DEPT.getName($!{searchMap.txt2html("findYear")}, $list2.SC_DEPT_ID))}+"&#xa;"+$!{CS_HTML.txt2html($list2.STRATEGY_NM)})
						##set($url2 = $!{searchMap.txt2html("context")}+"/bsc/mon/metricDetail/metricDetailList.vw?type=template&findYear="+$!{searchMap.txt2html("findYear")}+"&findMon="+$!{searchMap.txt2html("findMon")}+"&findAnalCycle="+$!{searchMap.txt2html("findAnalCycle")}+"&findStrategyId="+$!{CS_HTML.txt2html($list2.STRATEGY_ID)}+"&findStrategyNm="+$!{CS_HTML.txt2html($list2.METRIC_NM)}+"&findScDeptId="+$!{CS_HTML.txt2html($list2.SC_DEPT_ID)}+"&findScDeptNm="+$!{CS_HTML.txt2html($list2.SC_DEPT_NM)}+"&findMetricId="+$!{CS_HTML.txt2html($list2.METRIC_ID)}+"&findMetricNm="+$!{CS_HTML.txt2html($list2.METRIC_NM)}+"&findHighPgmId="+$!{searchMap.txt2html("findHighPgmId")}+"&findSubPgmId="+$!{searchMap.txt2html("findSubPgmId")}+"&findPgmId="+$!{searchMap.txt2html("findPgmId")})
    					#set($url2 = $!{CS_HTML.txt2html($list2.SC_DEPT_ID)}+"|"+$!{CS_HTML.txt2html($list2.STRATEGY_ID)}+"|"+$!{CS_HTML.txt2html($list2.METRIC_ID)})
						<node label="$!{CS_HTML.txt2html($list2.METRIC_NM)}"
							color="$!{CS_HTML.txt2html($sinalMap.get($list2.STATUS))}" fontColor="0x000000" title="$!{title2}"
							attributes="목표/$!{CS_HTML.txt2html($list2.TARGET)},실적/$!{CS_HTML.txt2html($list2.ACTUAL)},점수/$!{CS_HTML.txt2html($list2.SCORE)}"
							url="$!{url2}">
						#if($listSize3 != 0)
                        	#foreach($list3 in $list3)
            					#if($list2.METRIC_ID == $list3.UP_METRIC_ID)
									#set($title3 = $!{CS_HTML.txt2html($!CS_SC_DEPT.getName($!{searchMap.txt2html("findYear")}, $list3.SC_DEPT_ID))}+"&#xa;"+$!{CS_HTML.txt2html($list3.STRATEGY_NM)})
                					##set($url3 = $!{searchMap.txt2html("context")}+"/bsc/mon/metricDetail/metricDetailList.vw?type=template&findYear="+$!{searchMap.txt2html("findYear")}+"&findMon="+$!{searchMap.txt2html("findMon")}+"&findAnalCycle="+$!{searchMap.txt2html("findAnalCycle")}+"&findStrategyId="+$!{CS_HTML.txt2html($list3.STRATEGY_ID)}+"&findStrategyNm="+$!{CS_HTML.txt2html($list3.METRIC_NM)}+"&findScDeptId="+$!{CS_HTML.txt2html($list3.SC_DEPT_ID)}+"&findScDeptNm="+$!{CS_HTML.txt2html($list3.SC_DEPT_NM)}+"&findMetricId="+$!{CS_HTML.txt2html($list3.METRIC_ID)}+"&findMetricNm="+$!{CS_HTML.txt2html($list3.METRIC_NM)}+"&findHighPgmId="+$!{searchMap.txt2html("findHighPgmId")}+"&findSubPgmId="+$!{searchMap.txt2html("findSubPgmId")}+"&findPgmId="+$!{searchMap.txt2html("findPgmId")})
									#set($url3 = $!{CS_HTML.txt2html($list3.SC_DEPT_ID)}+"|"+$!{CS_HTML.txt2html($list3.STRATEGY_ID)}+"|"+$!{CS_HTML.txt2html($list3.METRIC_ID)})
									<node label="$!{CS_HTML.txt2html($list3.METRIC_NM)}"
										color="$!{CS_HTML.txt2html($sinalMap.get($list3.STATUS))}" fontColor="0x000000" title="$!{title3}" 
										attributes="목표/$!{CS_HTML.txt2html($list3.TARGET)},실적/$!{CS_HTML.txt2html($list3.ACTUAL)},점수/$!{CS_HTML.txt2html($list3.SCORE)}"
										url="$!{url3}">
									#if($listSize4 != 0)
                                    	#foreach($list4 in $list5)
                        					#if($list3.METRIC_ID == $list4.UP_METRIC_ID)
            									#set($title4 = $!{CS_HTML.txt2html($!CS_SC_DEPT.getName($!{searchMap.txt2html("findYear")}, $list4.SC_DEPT_ID))}+"&#xa;"+$!{CS_HTML.txt2html($list4.STRATEGY_NM)})
                            					##set($url4 = $!{searchMap.txt2html("context")}+"/bsc/mon/metricDetail/metricDetailList.vw?type=template&findYear="+$!{searchMap.txt2html("findYear")}+"&findMon="+$!{searchMap.txt2html("findMon")}+"&findAnalCycle="+$!{searchMap.txt2html("findAnalCycle")}+"&findStrategyId="+$!{CS_HTML.txt2html($list4.STRATEGY_ID)}+"&findStrategyNm="+$!{CS_HTML.txt2html($list4.METRIC_NM)}+"&findScDeptId="+$!{CS_HTML.txt2html($list4.SC_DEPT_ID)}+"&findScDeptNm="+$!{CS_HTML.txt2html($list4.SC_DEPT_NM)}+"&findMetricId="+$!{CS_HTML.txt2html($list4.METRIC_ID)}+"&findMetricNm="+$!{CS_HTML.txt2html($list4.METRIC_NM)}+"&findHighPgmId="+$!{searchMap.txt2html("findHighPgmId")}+"&findSubPgmId="+$!{searchMap.txt2html("findSubPgmId")}+"&findPgmId="+$!{searchMap.txt2html("findPgmId")})
												#set($url4 = $!{CS_HTML.txt2html($list4.SC_DEPT_ID)}+"|"+$!{CS_HTML.txt2html($list4.STRATEGY_ID)}+"|"+$!{CS_HTML.txt2html($list4.METRIC_ID)})
												<node label="$!{CS_HTML.txt2html($list4.METRIC_NM)}"
													color="$!{CS_HTML.txt2html($sinalMap.get($list4.STATUS))}" fontColor="0x000000" title="$!{title4}"
													attributes="목표/$!{CS_HTML.txt2html($list4.TARGET)},실적/$!{CS_HTML.txt2html($list4.ACTUAL)},점수/$!{CS_HTML.txt2html($list4.SCORE)}"
													url="$!{url4}">
												#if($listSize5 != 0)
                                                	#foreach($list5 in $list5)
                                    					#if($list4.METRIC_ID == $list5.UP_METRIC_ID)
                        									#set($title5 = $!{CS_HTML.txt2html($!CS_SC_DEPT.getName($!{searchMap.txt2html("findYear")}, $list5.SC_DEPT_ID))}+"&#xa;"+$!{CS_HTML.txt2html($list5.STRATEGY_NM)})
                                        					##set($url5 = $!{searchMap.txt2html("context")}+"/bsc/mon/metricDetail/metricDetailList.vw?type=template&findYear="+$!{searchMap.txt2html("findYear")}+"&findMon="+$!{searchMap.txt2html("findMon")}+"&findAnalCycle="+$!{searchMap.txt2html("findAnalCycle")}+"&findStrategyId="+$!{CS_HTML.txt2html($list5.STRATEGY_ID)}+"&findStrategyNm="+$!{CS_HTML.txt2html($list5.METRIC_NM)}+"&findScDeptId="+$!{CS_HTML.txt2html($list5.SC_DEPT_ID)}+"&findScDeptNm="+$!{CS_HTML.txt2html($list5.SC_DEPT_NM)}+"&findMetricId="+$!{CS_HTML.txt2html($list5.METRIC_ID)}+"&findMetricNm="+$!{CS_HTML.txt2html($list5.METRIC_NM)}+"&findHighPgmId="+$!{searchMap.txt2html("findHighPgmId")}+"&findSubPgmId="+$!{searchMap.txt2html("findSubPgmId")}+"&findPgmId="+$!{searchMap.txt2html("findPgmId")})
															#set($url5 = $!{CS_HTML.txt2html($list5.SC_DEPT_ID)}+"|"+$!{CS_HTML.txt2html($list5.STRATEGY_ID)}+"|"+$!{CS_HTML.txt2html($list5.METRIC_ID)})
															<node label="$!{CS_HTML.txt2html($list5.METRIC_NM)}"
																color="$!{CS_HTML.txt2html($sinalMap.get($list5.STATUS))}" fontColor="0x000000" title="$!{title5}"
																attributes="목표/$!{CS_HTML.txt2html($list5.TARGET)},실적/$!{CS_HTML.txt2html($list5.ACTUAL)},점수/$!{CS_HTML.txt2html($list5.SCORE)}"
																url="$!{url5}">
															#if($listSize6 != 0)
                                                            	#foreach($list6 in $list6)
                                                					#if($list5.METRIC_ID == $list6.UP_METRIC_ID)
                                    									#set($title6 = $!{CS_HTML.txt2html($!CS_SC_DEPT.getName($!{searchMap.txt2html("findYear")}, $list6.SC_DEPT_ID))}+"&#xa;"+$!{CS_HTML.txt2html($list6.STRATEGY_NM)})
                                                    					##set($url6 = $!{searchMap.txt2html("context")}+"/bsc/mon/metricDetail/metricDetailList.vw?type=template&findYear="+$!{searchMap.txt2html("findYear")}+"&findMon="+$!{searchMap.txt2html("findMon")}+"&findAnalCycle="+$!{searchMap.txt2html("findAnalCycle")}+"&findStrategyId="+$!{CS_HTML.txt2html($list6.STRATEGY_ID)}+"&findStrategyNm="+$!{CS_HTML.txt2html($list6.METRIC_NM)}+"&findScDeptId="+$!{CS_HTML.txt2html($list6.SC_DEPT_ID)}+"&findScDeptNm="+$!{CS_HTML.txt2html($list6.SC_DEPT_NM)}+"&findMetricId="+$!{CS_HTML.txt2html($list6.METRIC_ID)}+"&findMetricNm="+$!{CS_HTML.txt2html($list6.METRIC_NM)}+"&findHighPgmId="+$!{searchMap.txt2html("findHighPgmId")}+"&findSubPgmId="+$!{searchMap.txt2html("findSubPgmId")}+"&findPgmId="+$!{searchMap.txt2html("findPgmId")})
            															#set($url6 = $!{CS_HTML.txt2html($list6.SC_DEPT_ID)}+"|"+$!{CS_HTML.txt2html($list6.STRATEGY_ID)}+"|"+$!{CS_HTML.txt2html($list6.METRIC_ID)})
																		<node label="$!{CS_HTML.txt2html($list6.METRIC_NM)}"
            																color="$!{CS_HTML.txt2html($sinalMap.get($list6.STATUS))}" fontColor="0x000000" title="$!{title6}"
            																attributes="목표/$!{CS_HTML.txt2html($list6.TARGET)},실적/$!{CS_HTML.txt2html($list6.ACTUAL)},점수/$!{CS_HTML.txt2html($list6.SCORE)}"
            																url="$!{url6}">
																		#if($listSize7 != 0)
                                                                        	#foreach($list7 in $list7)
                                                            					#if($list6.METRIC_ID == $list7.UP_METRIC_ID)
                                                									#set($title7 = $!{CS_HTML.txt2html($!CS_SC_DEPT.getName($!{searchMap.txt2html("findYear")}, $list7.SC_DEPT_ID))}+"&#xa;"+$!{CS_HTML.txt2html($list7.STRATEGY_NM)})
                                                                					##set($url7 = $!{searchMap.txt2html("context")}+"/bsc/mon/metricDetail/metricDetailList.vw?type=template&findYear="+$!{searchMap.txt2html("findYear")}+"&findMon="+$!{searchMap.txt2html("findMon")}+"&findAnalCycle="+$!{searchMap.txt2html("findAnalCycle")}+"&findStrategyId="+$!{CS_HTML.txt2html($list7.STRATEGY_ID)}+"&findStrategyNm="+$!{CS_HTML.txt2html($list7.METRIC_NM)}+"&findScDeptId="+$!{CS_HTML.txt2html($list7.SC_DEPT_ID)}+"&findScDeptNm="+$!{CS_HTML.txt2html($list7.SC_DEPT_NM)}+"&findMetricId="+$!{CS_HTML.txt2html($list7.METRIC_ID)}+"&findMetricNm="+$!{CS_HTML.txt2html($list7.METRIC_NM)}+"&findHighPgmId="+$!{searchMap.txt2html("findHighPgmId")}+"&findSubPgmId="+$!{searchMap.txt2html("findSubPgmId")}+"&findPgmId="+$!{searchMap.txt2html("findPgmId")})
                        															#set($url7 = $!{CS_HTML.txt2html($list7.SC_DEPT_ID)}+"|"+$!{CS_HTML.txt2html($list7.STRATEGY_ID)}+"|"+$!{CS_HTML.txt2html($list7.METRIC_ID)})
																					<node label="$!{CS_HTML.txt2html($list7.METRIC_NM)}"
                        																color="$!{CS_HTML.txt2html($sinalMap.get($list7.STATUS))}" fontColor="0x000000" title="$!{title7}"
                        																attributes="목표/$!{CS_HTML.txt2html($list7.TARGET)},실적/$!{CS_HTML.txt2html($list7.ACTUAL)},점수/$!{CS_HTML.txt2html($list7.SCORE)}"
                        																url="$!{url7}">
                                                            						</node>
                                                            					#end
                                                            				#end
                                                            			#end
                                                						</node>
                                                					#end
                                                				#end
                                                			#end
                                    						</node>
                                    					#end
                                    				#end
                                    			#end
                        						</node>
                        					#end
                        				#end
                        			#end
            						</node>
            					#end
            				#end
            			#end
						</node>
					#end
				#end
			#end
			</node>
		#end
	#end
#end
#if($!{findStrategyId} == "ALL"){
	</node>
#end

</root>
	