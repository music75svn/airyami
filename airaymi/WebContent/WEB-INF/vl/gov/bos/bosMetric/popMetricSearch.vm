#*************************************************************************
* CLASS 명      : popMetricSearch.vm
* 작 업 자      : 박경태
* 작 업 일      : 2012.11.08
* 기    능      : 정평지표검색
* ---------------------------- 변 경 이 력 --------------------------------
* 번호   작 업 자     작   업   일        변 경 내 용             비고
* ----  --------  -----------------  -------------------------  --------
*  1     박 경 태      2012.11.08          최 초 작 업 
**************************************************************************# 

<script type="text/javascript" language="javascript" >
//<![CDATA[

	var J = jQuery;
	
	J(document).ready(function(){
	
		/******************************************
		 * 데이터 그리드 출력
		 ******************************************/
		var str = J('#formFindPop').serialize();
		
		jQuery("#kpiList").jqGrid({
			url          :"$!{searchMap.txt2html("context")}/gov/bos/bosMetric/popMetricList_xml.vw" + "?" + str,
			mtype        :"POST",
			datatype     :"json",
			jsonReader   : {   
    						page   : "page",
    						total  : "total",
    						root   : "rows",
    						records: function(obj){return obj.length;},
    						repeatitems: false, 
    						id     : "id"
    				       },
			height       : 320,
			colNames     :['지표코드', '평가범주', '평가부문', '평가지표'],
			colModel     :[
							{name:'GOV_METRIC_ID'  		,index:'GOV_METRIC_ID' 		,width:50    ,align:'center' },
							{name:'EVAL_CAT_GRP_NM'  	,index:'EVAL_CAT_GRP_NM'	,width:150   ,align:'center' },
							{name:'EVAL_CAT_NM'   		,index:'EVAL_CAT_NM'  		,width:150   ,align:'center' },
							{name:'GOV_METRIC_NM'  		,index:'GOV_METRIC_NM'		,width:150   ,align:'left'   ,formatter:linkUpdate}
							],
			rowNum       : 100000,
			autowidth    : false,
			viewrecords  : true,
			loadonce     : false,
			cmTemplate	 : {sortable:false},
			cellEdit     : true,
			caption:"정평지표조회"
		}).jqGrid('hideCol',"GOV_METRIC_ID");
        
    });
	
	/******************************************
	 * jqGrid 수정페이지 링크
	 ******************************************/
	function linkUpdate(cellvalue, options, rowObject) { 
		return '<a href=javascript:setMetricSet(' + options.rowId + ')> ' + cellvalue + '<//a>';
	}
	
	/******************************************
	 * setting
	 ******************************************/
	function setMetricSet(rowId) {
		var ret = J("#kpiList").jqGrid('getRowData',rowId);
		var govMetricId = ret.GOV_METRIC_ID;
		var govMetricNm = ret.GOV_METRIC_NM;
		govMetricNm = J(govMetricNm).text();
		
		setKpiSet(govMetricId, govMetricNm);
	}

//]]>
</script>

<form id="formFindPop" name="formFindPop" method="post">
	<input type="hidden" id="findYear" name="findYear" value="$!{searchMap.txt2html("findYear")}" />
	
    <div style="width:520px;height:400px;">
    	<div id="popMetricArea">
    		<div id="userData" style="margin-left:15px;height:340px;width:450px;">
    			<!-- 데이터그리드 Start -->
    			<div class="blockGridListTable">
    				<table id="kpiList" summary="정평지표 조회">
    					<caption class="none">정평지표 조회</caption>
    					<thead><tr><th></th></tr></thead>
    					<tbody><tr><td></td></tr></tbody>
    				</table>
    				<div id="pager"></div>                    
    			</div>
    			<!--// 데이터그리드 End -->	
    		</div>
    	</div>
    </div>
</form>
