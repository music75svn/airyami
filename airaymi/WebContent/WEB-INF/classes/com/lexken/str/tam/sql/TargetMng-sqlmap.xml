<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="str.tam.targetMng">

	<!--
	==================================================================   
	  # 설명	: typeAlias 선언
	  #	기능	: SETTING
	  #	TABLE	: STR_METRIC_TARGET
	==================================================================
	-->
	<typeAlias alias="hashMap" 			type="java.util.HashMap" />
	 

	<!--
	==================================================================   
	  # 설명	: 목표입력 목록 보기
	  #	기능	: SELECT
	  #	TABLE	: STR_METRIC_TARGET
	==================================================================
	-->
	<select id="getList" parameterClass="hashMap" resultClass="hashMap">
		SELECT 'TARGET' LV, TO_CHAR(MAX(MON01)) MON01,
                   TO_CHAR(MAX(MON02)) MON02,
                   TO_CHAR(MAX(MON03)) MON03,
                   TO_CHAR(MAX(MON04)) MON04,
                   TO_CHAR(MAX(MON05)) MON05,
                   TO_CHAR(MAX(MON06)) MON06,
                   TO_CHAR(MAX(MON07)) MON07,
                   TO_CHAR(MAX(MON08)) MON08,
                   TO_CHAR(MAX(MON09)) MON09,
                   TO_CHAR(MAX(MON10)) MON10,
                   TO_CHAR(MAX(MON11)) MON11,
                   TO_CHAR(MAX(MON12)) MON12
          FROM(        
               SELECT CASE WHEN MON = '01' THEN TARGET END MON01,
                      CASE WHEN MON = '02' THEN TARGET END MON02,
                      CASE WHEN MON = '03' THEN TARGET END MON03,
                      CASE WHEN MON = '04' THEN TARGET END MON04,
                      CASE WHEN MON = '05' THEN TARGET END MON05,
                      CASE WHEN MON = '06' THEN TARGET END MON06,
                      CASE WHEN MON = '07' THEN TARGET END MON07,
                      CASE WHEN MON = '08' THEN TARGET END MON08,
                      CASE WHEN MON = '09' THEN TARGET END MON09,
                      CASE WHEN MON = '10' THEN TARGET END MON10,
                      CASE WHEN MON = '11' THEN TARGET END MON11,
                      CASE WHEN MON = '12' THEN TARGET END MON12
             FROM(
           SELECT A.CODE_ID AS MON, B.TARGET
             FROM BSC_CODE A
              LEFT OUTER JOIN STR_METRIC_TARGET B ON B.YEAR = #findYear#  AND A.CODE_ID = B.MON AND B.SUBJECT_METRIC_ID = #subjectMetricId#
           WHERE A.CODE_GRP_ID = '024'
                AND A.DELETE_DT IS NULL))
	</select>
	
	
	<!--
	==================================================================   
	  # 설명	: 목표 입력상태 가져오기
	  #	기능	: SELECT
	  #	TABLE	: STR_METRIC_TARGET_STATUS
	==================================================================
	-->
	<select id="getTargetStatusId" parameterClass="hashMap" resultClass="hashMap">
		SELECT A.CYCLE_ID,
               F_CODE_NM('008', A.CYCLE_ID, A.YEAR) CYCLE_NM,
               NVL(B.TARGET_STATUS_ID,'01') TARGET_STATUS_ID,
               B.TARGET_SET_BASE
          FROM STR_METRIC A
          LEFT OUTER JOIN STR_METRIC_TARGET_STATUS B ON A.YEAR=B.YEAR AND A.SUBJECT_METRIC_ID=B.SUBJECT_METRIC_ID
         WHERE A.YEAR=#year#
           AND A.SUBJECT_METRIC_ID=#subjectMetricId#              
	</select>
	
	<!--
	==================================================================   
	  # 설명	: 목표 입력자 조회
	  #	기능	: SELECT
	  #	TABLE	: STR_METRIC
	==================================================================
	-->
	<select id="getInsertUserList" parameterClass="hashMap" resultClass="hashMap">
		SELECT A.CHARGE_USER_ID, B.USER_NM AS CHARGE_USER_NM
          FROM STR_METRIC A
          LEFT OUTER JOIN V_ROLE_USER B ON A.CHARGE_USER_ID = B.USER_ID
         WHERE A.YEAR = #findYear#
           AND A.DELETE_DT IS NULL
           AND A.METRIC_ID IS NULL
           AND A.CHARGE_USER_ID IS NOT NULL
           AND B.USER_NM IS NOT NULL
         GROUP BY A.CHARGE_USER_ID, B.USER_NM
         ORDER BY B.USER_NM ASC
	</select>
	
	<!--
	==================================================================   
	  # 설명	: 목표 승인자 조회
	  #	기능	: SELECT
	  #	TABLE	: STR_METRIC
	==================================================================
	-->
	<select id="getApproveUserList" parameterClass="hashMap" resultClass="hashMap">
		SELECT A.APPROVE_USER_ID, B.USER_NM AS APPROVE_USER_NM
          FROM STR_METRIC A
          LEFT OUTER JOIN V_ROLE_USER B ON A.APPROVE_USER_ID = B.USER_ID
         WHERE A.YEAR = #findYear#
           AND A.DELETE_DT IS NULL 
           AND A.METRIC_ID IS NULL
           AND A.APPROVE_USER_ID IS NOT NULL
           AND B.USER_NM IS NOT NULL
         GROUP BY A.APPROVE_USER_ID, B.USER_NM
         ORDER BY B.USER_NM ASC
	</select>
	
	<!--
	==================================================================   
	  # 설명	: 목표입력기한 여부 가져오기
	  #	기능	: SELECT
	  #	TABLE	: STR_METRIC_TARGET_IN_TERM
	==================================================================
	-->
	<select id="getTargetInputTermYn" parameterClass="hashMap" resultClass="java.lang.String">
		SELECT CASE WHEN MAX(YEAR) IS NULL THEN 'N'
		            WHEN MAX(YEAR) IS NOT NULL THEN 'Y'
		       END IS_INPUT_TERM 
		  FROM STR_METRIC_TARGET_IN_TERM        
		 WHERE YEAR = #findYear# 
           AND START_DT <![CDATA[ <= ]]> TO_CHAR(SYSDATE,'YYYYMMDD')    
           AND END_DT   <![CDATA[ >= ]]> TO_CHAR(SYSDATE,'YYYYMMDD')    
    </select>
    
    <!--
	==================================================================   
	  # 설명	: 목표입력 트리 경영목표 데이터 조회
	  #	기능	: SELECT
	  #	TABLE	: BSC_MANAGEMENT
	==================================================================
	-->
	<select id="getInsertManagementTree" parameterClass="hashMap" resultClass="hashMap">
 SELECT A.MANAGEMENT_ID, A.MANAGEMENT_NM, '1' AS PARAM
  FROM BSC_MANAGEMENT A
       INNER JOIN STR_STRAT_SUBJECT B
          ON A.YEAR = B.YEAR
         AND A.MANAGEMENT_ID = B.MANAGEMENT_ID
         AND B.DELETE_DT IS NULL
       INNER JOIN BSC_CSF C
          ON B.YEAR = C.YEAR
         AND B.STRAT_SUBJECT_ID = C.STRAT_SUBJECT_ID
         AND C.DELETE_DT IS NULL
       INNER JOIN STR_METRIC D
          ON C.YEAR = D.YEAR
         AND C.CSF_ID = D.CSF_ID
         AND D.DELETE_DT IS NULL
         AND D.METRIC_ID IS NULL
       LEFT OUTER JOIN STR_METRIC_TARGET_STATUS E
          ON D.YEAR = E.YEAR
         AND D.SUBJECT_METRIC_ID = E.SUBJECT_METRIC_ID 
         WHERE A.YEAR=#findYear#
	       AND D.CHARGE_USER_ID = #findInsertUserId#
	         <isNotEmpty prepend="AND" property="findTargetStatusId">
				NVL(E.TARGET_STATUS_ID, '01')  = #findTargetStatusId#
			  </isNotEmpty>
         GROUP BY  A.MANAGEMENT_ID, A.MANAGEMENT_NM, A.SORT_ORDER
         ORDER BY A.SORT_ORDER
	</select>
	
    <!--
	==================================================================   
	  # 설명	: 목표입력 트리 전략과제 데이터 조회
	  #	기능	: SELECT
	  #	TABLE	: STR_STRAT_SUBJECT
	==================================================================
	-->
	<select id="getInsertStrStratSubjectTree" parameterClass="hashMap" resultClass="hashMap">
 SELECT B.STRAT_SUBJECT_ID, B.STRAT_SUBJECT_NM, B.MANAGEMENT_ID, '2' AS PARAM
  FROM STR_STRAT_SUBJECT B
       INNER JOIN BSC_CSF C
          ON B.YEAR = C.YEAR
         AND B.STRAT_SUBJECT_ID = C.STRAT_SUBJECT_ID
         AND C.DELETE_DT IS NULL
       INNER JOIN STR_METRIC D
          ON C.YEAR = D.YEAR
         AND C.CSF_ID = D.CSF_ID
         AND D.DELETE_DT IS NULL
         AND D.METRIC_ID IS NULL
       LEFT OUTER JOIN STR_METRIC_TARGET_STATUS E
          ON D.YEAR = E.YEAR
         AND D.SUBJECT_METRIC_ID = E.SUBJECT_METRIC_ID 
         WHERE B.YEAR=#findYear#
	       AND D.CHARGE_USER_ID = #findInsertUserId#
	         <isNotEmpty prepend="AND" property="findTargetStatusId">
				NVL(E.TARGET_STATUS_ID, '01')  = #findTargetStatusId#
			  </isNotEmpty>
         GROUP BY  B.STRAT_SUBJECT_ID, B.STRAT_SUBJECT_NM, B.MANAGEMENT_ID ,B.SORT_ORDER
         ORDER BY B.SORT_ORDER
	</select>
	
    <!--
	==================================================================   
	  # 설명	: 목표입력 트리 CSF 데이터 조회
	  #	기능	: SELECT
	  #	TABLE	: BSC_CSF
	==================================================================
	-->
	<select id="getInsertCsfTree" parameterClass="hashMap" resultClass="hashMap">
		SELECT A.CSF_ID 
				, A.CSF_NM 
				, A.STRAT_SUBJECT_ID
				, '3' AS PARAM
          FROM BSC_CSF A
         INNER JOIN STR_METRIC B ON A.YEAR=B.YEAR AND A.CSF_ID=B.CSF_ID AND B.DELETE_DT IS NULL AND B.METRIC_ID IS NULL
          LEFT OUTER JOIN STR_METRIC_TARGET_STATUS C ON B.YEAR=C.YEAR AND B.SUBJECT_METRIC_ID=C.SUBJECT_METRIC_ID  
         WHERE A.YEAR=#findYear#
	       AND B.CHARGE_USER_ID = #findInsertUserId#
	         <isNotEmpty prepend="AND" property="findTargetStatusId">
				NVL(C.TARGET_STATUS_ID, '01')  = #findTargetStatusId#
			  </isNotEmpty>
         GROUP BY  A.CSF_ID, A.CSF_NM, A.STRAT_SUBJECT_ID ,A.SORT_ORDER
         ORDER BY A.SORT_ORDER
	</select>
	
	<!--
	==================================================================   
	  # 설명	: 목표입력 트리 지표 데이터 조회
	  #	기능	: SELECT
	  #	TABLE	: STR_METRIC
	==================================================================
	-->
	<select id="getInsertMetricTree" parameterClass="hashMap" resultClass="hashMap">
		SELECT A.YEAR
		     , A.SUBJECT_METRIC_ID
		     , A.SUBJECT_METRIC_NM
		     , A.CSF_ID
		     , '4' AS PARAM
		     , NVL(B.TARGET_STATUS_ID, '01') AS TARGET_STATUS_ID
		     , (SELECT ETC1 
                  FROM BSC_CODE                                                                                                               
                 WHERE YEAR = (SELECT CASE YEAR_YN WHEN 'Y' THEN #findYear# ELSE '9999' END FROM BSC_CODE_GRP WHERE CODE_GRP_ID = '015')                       
                   AND CODE_GRP_ID = '015' AND CODE_ID =  NVL(B.TARGET_STATUS_ID, '01') AND DELETE_DT IS NULL) AS TARGET_STATUS_NM
		FROM STR_METRIC A
		LEFT OUTER JOIN STR_METRIC_TARGET_STATUS B ON A.YEAR=B.YEAR AND A.SUBJECT_METRIC_ID=B.SUBJECT_METRIC_ID         
		WHERE A.YEAR = #findYear#
		  AND A.CHARGE_USER_ID = #findInsertUserId#
		  AND A.DELETE_DT IS NULL
		  AND A.METRIC_ID IS NULL
		  <isNotEmpty prepend="AND" property="findTargetStatusId">
			NVL(B.TARGET_STATUS_ID, '01')  = #findTargetStatusId#
		  </isNotEmpty>
		 ORDER BY A.CSF_ID, A.SUBJECT_METRIC_ID
	</select>
	
	<!--
	==================================================================   
	  # 설명	: 목표입력 트리 경영목표 데이터 조회
	  #	기능	: SELECT
	  #	TABLE	: BSC_MANAGEMENT
	==================================================================
	-->
	<select id="getApproveManagementTree" parameterClass="hashMap" resultClass="hashMap">
 SELECT A.MANAGEMENT_ID, A.MANAGEMENT_NM, '1' AS PARAM
  FROM BSC_MANAGEMENT A
       INNER JOIN STR_STRAT_SUBJECT B
          ON A.YEAR = B.YEAR
         AND A.MANAGEMENT_ID = B.MANAGEMENT_ID
         AND B.DELETE_DT IS NULL
       INNER JOIN BSC_CSF C
          ON B.YEAR = C.YEAR
         AND B.STRAT_SUBJECT_ID = C.STRAT_SUBJECT_ID
         AND C.DELETE_DT IS NULL
       INNER JOIN STR_METRIC D
          ON C.YEAR = D.YEAR
         AND C.CSF_ID = D.CSF_ID
         AND D.DELETE_DT IS NULL
         AND D.METRIC_ID IS NULL
       LEFT OUTER JOIN STR_METRIC_TARGET_STATUS E
          ON D.YEAR = E.YEAR
         AND D.SUBJECT_METRIC_ID = E.SUBJECT_METRIC_ID  
         WHERE A.YEAR=#findYear#
	       AND D.APPROVE_USER_ID = #findApproveUserId#
	         <isNotEmpty prepend="AND" property="findTargetStatusId">
				NVL(E.TARGET_STATUS_ID, '01')  = #findTargetStatusId#
			  </isNotEmpty>
         GROUP BY  A.MANAGEMENT_ID, A.MANAGEMENT_NM, A.SORT_ORDER
         ORDER BY A.SORT_ORDER
	</select>
	
	<!--
	==================================================================   
	  # 설명	: 목표입력 트리 세부과제 데이터 조회
	  #	기능	: SELECT
	  #	TABLE	: STR_SUBJECT
	==================================================================
	-->
	<select id="getApproveStrStartTree" parameterClass="hashMap" resultClass="hashMap">
 SELECT B.STRAT_SUBJECT_ID, B.STRAT_SUBJECT_NM, B.MANAGEMENT_ID, '2' AS PARAM
  FROM STR_STRAT_SUBJECT B
       INNER JOIN BSC_CSF C
          ON B.YEAR = C.YEAR
         AND B.STRAT_SUBJECT_ID = C.STRAT_SUBJECT_ID
         AND C.DELETE_DT IS NULL
       INNER JOIN STR_METRIC D
          ON C.YEAR = D.YEAR
         AND C.CSF_ID = D.CSF_ID
         AND D.DELETE_DT IS NULL
         AND D.METRIC_ID IS NULL
       LEFT OUTER JOIN STR_METRIC_TARGET_STATUS E
          ON D.YEAR = E.YEAR
         AND D.SUBJECT_METRIC_ID = E.SUBJECT_METRIC_ID   
         WHERE B.YEAR=#findYear#
	       AND D.APPROVE_USER_ID = #findApproveUserId#
	         <isNotEmpty prepend="AND" property="findTargetStatusId">
				NVL(E.TARGET_STATUS_ID, '01')  = #findTargetStatusId#
			  </isNotEmpty>
         GROUP BY  B.STRAT_SUBJECT_ID, B.STRAT_SUBJECT_NM, B.MANAGEMENT_ID ,B.SORT_ORDER
         ORDER BY B.SORT_ORDER
	</select>
	<!--
	==================================================================   
	  # 설명	: 목표입력 트리 CSF 데이터 조회
	  #	기능	: SELECT
	  #	TABLE	: BSC_CSF
	==================================================================
	-->
	<select id="getApproveSubjectTree" parameterClass="hashMap" resultClass="hashMap">
		SELECT A.CSF_ID 
				, A.CSF_NM 
               	, A.STRAT_SUBJECT_ID
	            , '3' AS PARAM
          FROM BSC_CSF A
         INNER JOIN STR_METRIC B ON A.YEAR=B.YEAR AND A.CSF_ID=B.CSF_ID AND B.DELETE_DT IS NULL AND B.METRIC_ID IS NULL
          LEFT OUTER JOIN STR_METRIC_TARGET_STATUS C ON B.YEAR=C.YEAR AND B.SUBJECT_METRIC_ID=C.SUBJECT_METRIC_ID  
         WHERE A.YEAR=#findYear#
	       AND B.APPROVE_USER_ID = #findApproveUserId#
	         <isNotEmpty prepend="AND" property="findTargetStatusId">
				NVL(C.TARGET_STATUS_ID, '01')  = #findTargetStatusId#
			  </isNotEmpty>
         GROUP BY  A.CSF_ID, A.CSF_NM, A.STRAT_SUBJECT_ID, A.SORT_ORDER
         ORDER BY A.SORT_ORDER
	</select>
	
	<!--
	==================================================================   
	  # 설명	: 목표입력 트리 지표 데이터 조회
	  #	기능	: SELECT
	  #	TABLE	: STR_METRIC
	==================================================================
	-->
	<select id="getApproveMetricTree" parameterClass="hashMap" resultClass="hashMap">
		SELECT A.YEAR
		     , A.SUBJECT_METRIC_ID
		     , A.SUBJECT_METRIC_NM
		     , A.CSF_ID
		     , '4' AS PARAM
		     , NVL(B.TARGET_STATUS_ID, '01') AS TARGET_STATUS_ID
		     , (SELECT ETC1 
                  FROM BSC_CODE                                                                                                               
                 WHERE YEAR = (SELECT CASE YEAR_YN WHEN 'Y' THEN #findYear# ELSE '9999' END FROM BSC_CODE_GRP WHERE CODE_GRP_ID = '015')                       
                   AND CODE_GRP_ID = '015' AND CODE_ID =  NVL(B.TARGET_STATUS_ID, '01') AND DELETE_DT IS NULL) AS TARGET_STATUS_NM
		FROM STR_METRIC A
		LEFT OUTER JOIN STR_METRIC_TARGET_STATUS B ON A.YEAR=B.YEAR AND A.SUBJECT_METRIC_ID=B.SUBJECT_METRIC_ID         
		WHERE A.YEAR = #findYear#
		  AND A.APPROVE_USER_ID = #findApproveUserId#
		  AND A.DELETE_DT IS NULL
		  AND A.METRIC_ID IS NULL
		  <isNotEmpty prepend="AND" property="findTargetStatusId">
			NVL(B.TARGET_STATUS_ID, '01')  = #findTargetStatusId#
		  </isNotEmpty>
		 ORDER BY A.CSF_ID, A.SUBJECT_METRIC_ID
	</select>
	
	<!--
	==================================================================   
	  # 설명	: 목표입력 상세 보기
	  #	기능	: SELECT
	  #	TABLE	: STR_METRIC_TARGET
	==================================================================
	-->
	<select id="getDetail" parameterClass="hashMap" resultClass="hashMap">
		SELECT YEAR                  
			 , MON                   
			 , SUBJECT_METRIC_ID     
			 , TARGET                
		  FROM STR_METRIC_TARGET 
		 WHERE 1 = 1 
		   AND YEAR = #year#
		   AND MON = #mon#
		   AND SUBJECT_METRIC_ID = #subjectMetricId#	      
	</select>
	
	<!--
	==================================================================   
	  # 설명	: 목표입력 등록
	  #	기능	: INSERT
	  #	TABLE	: STR_METRIC_TARGET
	==================================================================
	-->	
	<insert id="insertData" parameterClass="hashMap">
		INSERT INTO STR_METRIC_TARGET ( 
			   YEAR
			 , MON
			 , SUBJECT_METRIC_ID
			 , TARGET
			 , CREATE_DT
			 ) VALUES ( 
			   #year#
			 , #mon#
			 , #subjectMetricId#
			 , #target#
			 , SYSDATE
			 )
	</insert>	
	
	<!--
	==================================================================   
	  # 설명	: 목표상태입력 수정
	  #	기능	: UPDATE
	  #	TABLE	: STR_METRIC_TARGET_STATUS
	==================================================================
	-->	
	<update id="updateData" parameterClass="hashMap">
		UPDATE STR_METRIC_TARGET_STATUS 
		   SET TARGET_STATUS_ID       = #targetStatusId#
		     , INSERT_USER_ID         = #insertUserId#
		     , TARGET_SET_BASE        = #targetSetBase#
			 , MODIFY_DT              = SYSDATE 
		 WHERE YEAR = #year#
		   AND SUBJECT_METRIC_ID = #subjectMetricId#		
	</update>	
	
	<!--
	==================================================================   
	  # 설명	: 목표상태 수정
	  #	기능	: UPDATE
	  #	TABLE	: BSC_ACTUAL
	==================================================================
	-->	
	<update id="updateStatusData" parameterClass="hashMap">
		UPDATE STR_METRIC_TARGET_STATUS
		   SET TARGET_STATUS_ID = #targetStatusId# 
		     , MODIFY_DT        = SYSDATE 
		 WHERE YEAR = #year#
           AND SUBJECT_METRIC_ID = #subjectMetricId#
	</update>
	
	<!--
	==================================================================   
	  # 설명	: 목표상태 수정
	  #	기능	: UPDATE
	  #	TABLE	: BSC_ACTUAL
	==================================================================
	-->	
	<update id="updateReturnStatusData" parameterClass="hashMap">
		UPDATE STR_METRIC_TARGET_STATUS
		   SET TARGET_STATUS_ID = #targetStatusId# 
		     , MODIFY_DT        = SYSDATE 
		     , RETURN_REASON    = #returnReason#  
		     , RETURN_DT        = SYSDATE 
		 WHERE YEAR = #year#
           AND SUBJECT_METRIC_ID = #subjectMetricId#
	</update>
	

	<!--
	==================================================================   
	  # 설명	: 목표입력 삭제
	  #	기능	: UPDATE
	  #	TABLE	: STR_METRIC_TARGET
	==================================================================
	-->	
	<update id="deleteData" parameterClass="hashMap">
		DELETE FROM STR_METRIC_TARGET 
		 WHERE YEAR = #year#
		   AND SUBJECT_METRIC_ID = #subjectMetricId#
	</update>
	
	<!--
	==================================================================   
	  # 설명	: 목표 첨부파일 등록
	  #	기능	: INSERT
	  #	TABLE	: STR_METRIC_TARGET_ATTACH
	==================================================================
	-->	
	<insert id="insertFileInfo" parameterClass="hashMap">
		<selectKey resultClass="java.lang.String" keyProperty="SEQ" >
			SELECT NVL(MAX(SEQ)+1,1) FROM STR_METRIC_TARGET_ATTACH WHERE YEAR=#year# AND SUBJECT_METRIC_ID=#subjectMetricId#
		</selectKey> 
		INSERT INTO STR_METRIC_TARGET_ATTACH (
               YEAR
             , SUBJECT_METRIC_ID
             , SEQ
             , ATTACH_FILE_NM
             , ATTACH_FILE_FNM
             , ATTACH_FILE_SUFFIX
             , ATTACH_FILE_PATH
             , CREATE_DT
           ) VALUES (
               #year#
             , #subjectMetricId#
             , #SEQ#
             , #attachFileNm#
             , #attachFileFnm#
             , #attachFileSuffix#
             , #attachFilePath#
             , SYSDATE
    	   )       
	</insert>
	
	<!--
	==================================================================   
	  # 설명	: 목표 첨부파일 삭제
	  #	기능	: INSERT
	  #	TABLE	: STR_METRIC_TARGET_ATTACH
	==================================================================
	-->	
	<delete id="deleteFileInfo" parameterClass="hashMap">
		DELETE FROM STR_METRIC_TARGET_ATTACH
		 WHERE YEAR = #year#
		   AND SUBJECT_METRIC_ID = #subjectMetricId#
		   AND SEQ = #seq#
	</delete>
	
	<!--
	==================================================================   
	  # 설명	: 목표 파일 목록 보기
	  #	기능	: SELECT
	  #	TABLE	: STR_METRIC_TARGET_ATTACH
	==================================================================
	-->
	<select id="getFileList" parameterClass="hashMap" resultClass="hashMap">
 		SELECT A.YEAR
	         , A.SUBJECT_METRIC_ID
	         , A.SEQ
	         , A.ATTACH_FILE_NM
	         , A.ATTACH_FILE_FNM
	         , A.ATTACH_FILE_SUFFIX
	         , F_ENCRYPT(A.ATTACH_FILE_PATH, #encryptionCode#) ATTACH_FILE_PATH
         FROM STR_METRIC_TARGET_ATTACH A
        WHERE A.YEAR = #year#
          AND A.SUBJECT_METRIC_ID = #subjectMetricId#
        ORDER BY A.SEQ
	</select>
	
	<!--
	==================================================================   
	  # 설명	: 목표반려 사유 가져오기
	  #	기능	: SELECT
	  #	TABLE	: STR_METRIC_TARGET_STATUS
	==================================================================
	-->
	<select id="getReturnReason" parameterClass="hashMap" resultClass="java.lang.String">
        SELECT RETURN_REASON
          FROM STR_METRIC_TARGET_STATUS
		 WHERE YEAR = #year#
           AND SUBJECT_METRIC_ID = #subjectMetricId#
	</select>	
	
	
</sqlMap>


