#*************************************************************************
* CLASS 명      : attFileModify
* 작 업 자      : 한봉준 
* 작 업 일      : 2012년 9월 6일 
* 기    능      : 게시판관리    
* ---------------------------- 변 경 이 력 --------------------------------
* 번호    작 업 자    작     업     일        변 경 내 용                비고
* ----  --------  -----------------  -------------------------  --------
*  1    한봉준      2012년 9월 6일             최 초 작 업 
**************************************************************************# 

<script type="text/javascript" language="javascript" >
//<![CDATA[

	var J = jQuery;

	J(document).ready(function(){
    
		/******************************************
		 * 저장버튼 이벤트
		 ******************************************/
		J("#btnInsert").click(function(e) {
			e.preventDefault();
			saveChk();
		});
		
		/******************************************
		 * 삭제 버튼 클릭 이벤트
		 ******************************************/
		J("#btnDelete").click(function() {
			goDelete();
			return false;
		});

		/******************************************
		 * 저장버튼 이중 클릭 방지
		 ******************************************/
		J("form").submit(function(){
			J("#btnInsert").unbind();
		});
		
	});

	/******************************************
	 * 필수입력 체크
	 ******************************************/
	function saveChk() {
		var fileChk = true;
		
        //첨부파일 확장자 체크
        J(":file", "#form1").each(function(index, item) {
            var fileFullName = J("input[name=" + item.name + "]").val();
            var src = getFileExtension(fileFullName);
            
            if (!((src.toLowerCase() == "xls") || (src.toLowerCase() == "xlsx") || (src.toLowerCase() == "ppt") || (src.toLowerCase() == "pptx")||
                  (src.toLowerCase() == "doc") || (src.toLowerCase() == "docx") || (src.toLowerCase() == "hwp") || (src.toLowerCase() == "pdf") ||
                  (src.toLowerCase() == "zip") || (src.toLowerCase() == "txt")  || (src.toLowerCase() == "gif") || (src.toLowerCase() == "jpg") ||
                  (src.toLowerCase() == "png") || (src.toLowerCase() == "png")
                )) {
            
                fileChk = false;
            }
        });
        
        if(fileChk == false) {
            J.showMsgBox("허용되지 않는 파일형식입니다<br/>허용되는 파일형식 : <br/>xls, xlsx, ppt, pptx, doc, docx, hwp <br/> pdf, zip, txt, gif, jpg, png, jpeg", null, null);
            return;
        }
        
		document.charset='utf-8';
		
		J.showConfirmBox("저장하시겠습니까?", "saveDo"); //saveDo() 콜백함수 호출
	}
    
	/******************************************
	 * 저장
	 ******************************************/
	function saveDo() {
		J("#mode").val("ADD");
		J("#form1").attr("action", "$!{context_path}/bsc/system/attFile/attFileProcess.vw?type=template").submit();
		return false;
	}
	
	/******************************************
	 * 삭제
	 ******************************************/
	function goDelete() {
		J.showConfirmBox("삭제하시겠습니까?", "deleteDo"); //deleteDo() 콜백함수 호출
		
	}

	/******************************************
	 * 삭제처리
	 ******************************************/
	function deleteDo() {

		J("#mode").val("DEL");
		J("#form1").attr("action", "$!{context_path}/bsc/system/attFile/attFileProcess.vw?type=template").submit();
		return false;
	}

//]]>
</script>    
 
 <div id="Table">
    	<div id="Table_blockContainer">
    		<div class="tableTop">
    			#parse("/WEB-INF/vl/common/template/tabs.vm")
				 <!-- search S -->
					<form id="formFind" name="formFind" method="post" action="$!{context_path}/bsc/system/attFile/attFileModify.vw?type=template">
						<input type="hidden"	id="findHighPgmId"	name="findHighPgmId"	value="$!{searchMap.txt2html("findHighPgmId")}" />
						<input type="hidden" 	id="findSubPgmId"	name="findSubPgmId"		value="$!{searchMap.txt2html("findSubPgmId")}" />
						<input type="hidden"	id="findPgmId"		name="findPgmId"		value="$!{searchMap.txt2html("findPgmId")}" />
						<input type="hidden" 	id="findDeptCd"		name="findDeptCd"		value="$!{searchMap.txt2html("findDeptCd")}" />
						<input type="hidden" 	id="findDeptNm"		name="findDeptNm"		value="$!{searchMap.txt2html("findDeptNm")}" />
						
						<div class="searchBox">
	    					<div><div><div>
	    					<table summary="내부경영평가편람 검색 조건">
								<caption class="none">내부경영평가편람 검색 조건</caption> 
								<thead><tr><th></th></tr></thead>
	        					<tbody>
	            					<tr>
										<td class="searchBox_tit w250">
		            						<span>$!{YEAR}</span>
		            						<span class="searchBar">
		            							<select id="findYear" name="findYear" class="select w80">
		            								$!CS_CODE.getCodeOption("017", $!{searchMap.txt2html("findYear")})
		            							</select>
		            						</span>
	            						</td>
	            					</tr>
	        					</tbody>
	    					</table>
	                    <input type="image" class="btnSearch" src="$!{img_path}/common/btn_search.gif" align="middle" alt="검색" /> 
	                    </div></div></div>
	    	        </div>
	    		</form>
				<!-- search E -->
				<div class="clear"></div>
			</div>				
 
			<form id="form1" name="form1" method="post" enctype="multipart/form-data" action="$!{context_path}/bsc/system/attFile/attFileProcess.vw?type=template">
			    <input type="hidden" id="mode"		name="mode"		/>
			    <input type="hidden" name="bbsRegisterName"     value="${CS_STATIC.nullToDefault($!{searchMap.txt2html("bbsRegisterName")},${CS_LOGIN.getUser_nm()})}">
			    <input type="hidden" name="bbsRegister"         value="${CS_STATIC.nullToDefault($!{searchMap.txt2html("bbsRegister")},${CS_LOGIN.getUser_id()})}">
			    <input type="hidden" name="count"        		 value="$!{searchMap.txt2html("count")}">
			    $!{searchMap.makeHiddenFind()}
			    			
			    		<div class="blockDetail">
			    			<table summary="내부경영평가편람">
								<caption class="none">내부경영평가편람</caption>
			    				<colgroup>
			    					<col width="15%" />
			    					<col width="85%" />
			    				</colgroup>
			    				<tbody>
			    						<th scope="row"><label for="bbs_file">내부경영평가편람</label></th>
			    						#if($!{searchMap.txt2html("count")} == "1")
			    						<td>
			    							#foreach($fileList in $fileList)
											$!{CS_HTML.makeFileIconFileName($fileList.get("ATTACH_FILE_SUFFIX"), $fileList.get("ATTACH_FILE_NM"), $fileList.get("ATTACH_FILE_PATH"))}
											#end 
										</td>
										#else
			    						<td>
											<input type="file" name="file0" class="input" size="70">
											<div>
												<ul id="fileAttach">
												</ul>
											</div>
										</td>
										#end
			    					</tr> 
			    				</tbody>
			    			</table>
							
			    		</div>
			    		<div class="blockButton"> 
			    			<ul>
			    				#if($!{searchMap.txt2html("count")} == "1")
			    					<li><input type="button" id="btnDelete" value="삭제" /></li>
			    				#else
			    					<li><input type="button" id="btnInsert" value="저장" /></li>
			    				#end
			    			</ul>
			    		</div>	
			    	</div>
			    	<div class="clear"></div>
			    </div>
			</form>
