<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="bsc.message.message">

	<!--
	==================================================================   
	  # 설명	: typeAlias 선언
	  #	기능	: SETTING
	  #	TABLE	: 
	==================================================================
	-->
	<typeAlias alias="hashMap" 			type="java.util.HashMap" />
	 

	<!--
	==================================================================   
	  # 설명	: 메세지 목록 보기
	  #	기능	: SELECT
	  #	TABLE	: 
	==================================================================
	-->
	<select id="getUserList" parameterClass="hashMap" resultClass="hashMap">
<!--	SELECT EMPN, KOR_NM
  		  FROM BSC_INSA
 		 WHERE DEPT_CD IN
          				( SELECT DEPT_CD
		                    FROM BSC_INSA_DEPT
		                   WHERE YEAR = #findYear#
		              START WITH DEPT_CD = #findDeptCd#
		           		 CONNECT BY PRIOR YEAR = YEAR AND PRIOR DEPT_CD = UP_DEPT_CD)
		  AND YEAR = #findYear#
-->		  
		SELECT USER_ID AS EMPN
			 , USER_NM AS KOR_NM
  		  FROM V_ROLE_USER
		 WHERE DEPT_CD  = #findDeptCd#
	
	</select>
	
	<!--
	==================================================================   
	  # 설명	: 실조직 트리 조회
	  #	기능	: SELECT
	  #	TABLE	: BSC_DEPTINFO
	==================================================================
	-->
	<select id="getDeptList" parameterClass="hashMap" resultClass="hashMap">
		SELECT  A.DEPT_ID AS CODE_ID
		      , A.DEPT_NM AS CODE_NM
		      , A.UP_DEPT_ID AS UP_CODE_ID
		      , LEVEL AS LEVEL_ID
		FROM  V_DEPTINFO A
		WHERE BEING_YN = 'Y'
		START WITH UP_DEPT_ID IS NULL
		CONNECT BY PRIOR DEPT_ID = UP_DEPT_ID   
		ORDER SIBLINGS BY OUORDER
	</select>
	
	<!--
	==================================================================   
	  # 설명	: 메세지 상세 보기
	  #	기능	: SELECT
	  #	TABLE	: 
	==================================================================
	-->
	<select id="getDetail" parameterClass="hashMap" resultClass="hashMap">
           
	</select>
	
	<!--
	==================================================================   
	  # 설명	: 메세지 등록
	  #	기능	: INSERT
	  #	TABLE	: 
	==================================================================
	-->	
	<insert id="insertData" parameterClass="hashMap">
		INSERT INTO MAORA01.M_ALRAM (NUM
		                           , SENDUSER
		                           , TARGETUSER
		                           , REGDATE
		                           , CONTENT
		                           , URL
		                           , TF)
		   SELECT MAORA01.ALRAM_SQ.NEXTVAL
		        , #sendId#
		        , #targetId#
		        , SYSDATE
		        , <![CDATA['[BSC-' || TO_CHAR (SYSDATE, 'YYYYMMDDHH') || ']<br>']]> || #message#
		        , <![CDATA['http://150.1.1.17:8110/secure/loginForm.vw?loginFlag=none&encUserId=']]> || #targetId#
		        , '0'
		     FROM DUAL
	</insert>
		
	<!--
	==================================================================   
	  # 설명	: 의견메시지 등록
	  #	기능	: INSERT
	  #	TABLE	: 
	==================================================================
	-->	
	<insert id="insertOpnionData" parameterClass="hashMap">
		INSERT INTO MAORA01.M_ALRAM (NUM
		                           , SENDUSER
		                           , TARGETUSER
		                           , REGDATE
		                           , CONTENT
		                           , URL
		                           , TF)
		   SELECT MAORA01.ALRAM_SQ.NEXTVAL
		        , #sendId#
		        , #targetId#
		        , SYSDATE
		        , <![CDATA['[BSC-' || #message1# || ']<br>']]> || #message2#
		        , <![CDATA['http://150.1.1.17:8110/secure/loginForm.vw?loginFlag=none&encUserId=']]> || #targetId#
		        , '0'
		     FROM DUAL
	</insert>	
	
	<!--
	==================================================================   
	  # 설명	: 신호등현황 수정
	  #	기능	: UPDATE
	  #	TABLE	: 
	==================================================================
	-->	
	<update id="updateData" parameterClass="hashMap">
		
	</update>	
	

	<!--
	==================================================================   
	  # 설명	: 메세지 삭제
	  #	기능	: UPDATE
	  #	TABLE	: 
	==================================================================
	-->	
	<update id="deleteData" parameterClass="hashMap">

	</update>
	
	
	<!--
	==================================================================
	  # 설명	: 파라미터 맵
	  #	기능	: SETTING
	  #	TABLE	:
	==================================================================
	-->
	<parameterMap id="paramMap" class="java.util.HashMap">
		<parameter property="procParam1"	jdbcType="VARCHAR"  javaType="java.lang.String" mode="IN"/>
		<parameter property="procParam2"	jdbcType="VARCHAR"  javaType="java.lang.String" mode="IN"/>
		<parameter property="procParam3"	jdbcType="VARCHAR"  javaType="java.lang.String" mode="IN"/>
		<parameter property="procParam4"	jdbcType="VARCHAR"  javaType="java.lang.String" mode="IN"/>
	</parameterMap>

	<!--
	==================================================================
	  # 설명	: 쪽지 보내기
	  #	기능	: PROCEDURES
	  #	TABLE	: BSC_ACTUAL
	==================================================================
	-->
	<procedure id="insertNoteProc" parameterMap="paramMap">
		{CALL SP_BSC_NOTE_PROC(?, ?, ?, ?)}
	</procedure>
	
</sqlMap>


