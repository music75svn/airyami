<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="prs.eval.evalDegree">

    <!--
    ==================================================================   
      # 설명    : typeAlias 선언
      #    기능    : SETTING
      #    TABLE    : PRS_MNG_EVAL_WEIGHT
    ==================================================================
    -->
    <typeAlias alias="hashMap"             type="java.util.HashMap" />
     

    <!--
    ==================================================================   
      # 설명    : 간부개인업적평가 평가가중치 목록 보기
      #    기능    : SELECT
      #    TABLE    : PRS_MNG_EVAL_WEIGHT
    ==================================================================
    -->
    <select id="getList" parameterClass="hashMap" resultClass="hashMap">
        SELECT NVL(B.YEAR, A.YEAR) AS YEAR
          , NVL(B.EVAL_DEGREE_ID, A.CODE_ID) AS EVAL_DEGREE_ID
          , A.CODE_NM
          , NVL(B.WEIGHT, A.ETC1) AS WEIGHT
          , A.CONTENT
          , DECODE(B.YEAR, null, 'ADD', 'MOD') AS JOB_TYPE
       FROM BSC_CODE A LEFT OUTER JOIN  PRS_MNG_EVAL_WEIGHT B ON A.YEAR = B.YEAR AND A.CODE_ID = B.EVAL_DEGREE_ID
      WHERE 1=1
        AND A.YEAR = #findYear#
        AND A.CODE_GRP_ID = '228'
    </select>
    
    <!--
    ==================================================================   
      # 설명    : 간부개인업적평가 평가가중치 상세 보기
      #    기능    : SELECT
      #    TABLE    : PRS_MNG_EVAL_WEIGHT
    ==================================================================
    -->
    <select id="getDetail" parameterClass="hashMap" resultClass="hashMap">
        SELECT YEAR                  
             , EVAL_DEGREE_ID        
             , WEIGHT                
             , CREATE_BY_ID          
             , MODIFY_BY_ID          
          FROM PRS_MNG_EVAL_WEIGHT 
        WHERE 1 = 1 
           AND YEAR = #year#
           AND EVAL_DEGREE_ID = #evalDegreeId#          
    </select>
    
    <!--
    ==================================================================   
      # 설명    : 간부개인업적평가 평가가중치 등록
      #    기능    : INSERT
      #    TABLE    : PRS_MNG_EVAL_WEIGHT
    ==================================================================
    -->    
    <insert id="insertData" parameterClass="hashMap">
        <selectKey resultClass="java.lang.String" keyProperty="SEQ" >
            SELECT F_PGM_SERI('PRS_MNG_EVAL_WEIGHT','','','','','') SEQ FROM DUAL
        </selectKey>
        INSERT INTO PRS_MNG_EVAL_WEIGHT ( 
               YEAR
             , EVAL_DEGREE_ID
             , WEIGHT
             , CREATE_DT
             , CREATE_BY_ID             
             ) VALUES ( 
               #year#
             , #evalDegreeId#
             , #weight#
             , SYSDATE
             , #createById#
             )
    </insert>    
    
    <!--
    ==================================================================   
      # 설명    : 간부개인업적평가 평가가중치 수정
      #    기능    : UPDATE
      #    TABLE    : PRS_MNG_EVAL_WEIGHT
    ==================================================================
    -->    
    <update id="updateData" parameterClass="hashMap">
        UPDATE PRS_MNG_EVAL_WEIGHT 
           SET WEIGHT                 = #weight# 
             , MODIFY_DT              = SYSDATE 
             , MODIFY_BY_ID           = #modifyById# 
         WHERE 1 = 1 
           AND YEAR = #year#
           AND EVAL_DEGREE_ID = #evalDegreeId#        
    </update>    
    

    <!--
    ==================================================================   
      # 설명    : 간부개인업적평가 평가가중치 삭제
      #    기능    : UPDATE
      #    TABLE    : PRS_MNG_EVAL_WEIGHT
    ==================================================================
    -->    
    <update id="deleteData" parameterClass="hashMap">
        DELETE FROM PRS_MNG_EVAL_WEIGHT 
         WHERE 1 = 1 
           AND YEAR = #year#
           AND EVAL_DEGREE_ID = #evalDegreeId#
    </update>
    
    
</sqlMap>


