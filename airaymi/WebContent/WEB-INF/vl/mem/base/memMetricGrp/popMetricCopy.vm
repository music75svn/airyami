#*************************************************************************
* CLASS 명      : popMetricCopy.vm
* 작 업 자      : 하윤식
* 작 업 일      : 2012.08.26
* 기    능      : 사용지표 조직조회
* ---------------------------- 변 경 이 력 --------------------------------
* 번호   작 업 자     작   업   일        변 경 내 용             비고
* ----  --------  -----------------  -------------------------  --------
*  1     하 윤 식      2012.08.26          최 초 작 업 
**************************************************************************# 

<script type="text/javascript" language="javascript" >
//<![CDATA[

	var J = jQuery;
	
	J(document).ready(function(){
	
    	/******************************************
    	 * 성명 검색 엔터키 이벤트
    	 ******************************************/
		J("#findUserNm").keyup(function(e)  {
        	if(e.keyCode == 13) {
        		goAction('','');
        	}
        });
		
		/******************************************
		 * 선택된 조직명 클릭이벤트
		 ******************************************/
		J("#useData ul li").dblclick(function() {
			J(this).remove();
		});
		
		/******************************************
		 * 입력완료 버튼 이벤트
		 ******************************************/
		J("#btnInsert").click(function(e) {
			copyMetric();
		});
		
		try {
			$("input", ".blockButton" ).button(); //버튼 ui 적용
		} catch(err) { }
	});
	
	/******************************************
	 * 사용자 setting
	 ******************************************/
	function setSearchUserInfo() {
		$!{searchMap.txt2html("callBack")}(arguments);  //콜백함수 설정
	}
	
	/******************************************
	 * 조직선택 더블클릭이벤트
	 ******************************************/
	function goDblClickActionPop(deptId, deptNm) {
	
		var isExist = false;
	
		J("input[name=selScDeptIds]", "#useData").each(function(index, item) {
			
			if( deptId == J(this).val() ) {
				alert("이미 선택한 조직입니다.");
				isExist = true;
			}
		});
		
		if(isExist == false) {
			J("#useData ul").append("<li><input type=\"hidden\" name=\"selScDeptIds\" value=\""+deptId+"\"/>"+deptNm+"</li>");
			
			J("#useData ul li").dblclick(function() {
				J(this).remove();
			});
		}
	}
	
	/******************************************
	 * 조직별 지표복사
	 ******************************************/
	function copyMetric() {
		var selScDeptIds = "";
		
		J("input[name=selScDeptIds]", "#useData").each(function(index, item) {
			selScDeptIds = selScDeptIds + item.value + "|";
		});
		
		J("#scDeptIds").val(selScDeptIds);
		saveDo();
		
		J.fancybox.close();
	}
	
	

//]]>
</script>

<div style="width:530px;height:420px;"> 
	<div id="popSearchUserArea">
		<h1 class="none">조직트리</h1>
		<div class="blockGridTreeTable">
			#parse("/WEB-INF/vl/bsc/module/commModule/commonTreePop.vm")
		</div>
		<div id="useData" class="blockGridTreeTable" style="margin-left:30px;height:378px;width:255px;">
			<ul>
				#foreach($list in $useScDeptList)
					<li><input type="hidden" name="selScDeptIds" value="$!{CS_HTML.txt2html($list.SC_DEPT_ID)}"/>$!{CS_HTML.txt2html($list.SC_DEPT_NM)}</li>
                #end
			</ul>
		</div>
	</div>
	<br/>
	<div class="blockButton_all floatLeft">			
    	<div class="blockButton_l"></div>
    	<div class="blockButton">			
    		<ul>
    			<li><input type="button" id="btnInsert" value="입력완료" /></li>
    		</ul>
    	</div>
    </div>
</div>
	