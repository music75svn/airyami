<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="mem.base.memMeasGrade">

	<!--
	==================================================================   
	  # 설명	: typeAlias 선언
	  #	기능	: SETTING
	  #	TABLE	: MEM_EVAL_SECTION_POOL
	==================================================================
	-->
	<typeAlias alias="hashMap" 			type="java.util.HashMap" />
	 

	<!--
	==================================================================
	  # 설명	: 구간대 조회
	  #	기능	: SELECT
	  #	TABLE	: MEM_EVAL_SECTION_POOL
	==================================================================
	-->
	<select id="evalSectionList" parameterClass="hashMap" resultClass="hashMap">
        SELECT A.CODE_ID AS EVAL_SECTION_ID
             , A.CODE_NM AS EVAL_SECTION_NM
             , B.FROM_VALUE
             , B.TO_VALUE
		     , B.CONVERSION_SCORE
		     , CASE WHEN #gubun# = '02' THEN  B.TO_VALUE
		            ELSE B.FROM_VALUE
		            END VIEW_VAL
		FROM BSC_CODE A
		         LEFT OUTER JOIN MEM_EVAL_SECTION_POOL B
		                 ON B.YEAR = #year#
		                 AND B.GUBUN_ID = #gubun#
		                 AND A.CODE_ID = B.EVAL_SECTION_ID
		                 AND B.DELETE_DT IS NULL
		WHERE A.CODE_GRP_ID = '235'
		  AND A.YEAR = (SELECT CASE YEAR_YN WHEN 'Y' THEN #year# ELSE '9999' END FROM BSC_CODE_GRP WHERE CODE_GRP_ID = '235')
		  AND A.DELETE_DT IS NULL
		ORDER BY A.SORT_ORDER
	</select>
		
	<!--
	==================================================================
	  # 설명	: 평가등급  구간대항목 삭제
	  #	기능	: DELETE
	  #	TABLE	: MEM_EVAL_SECTION_POOL
	==================================================================
	-->
	<delete id="deleteEvalSection" parameterClass="hashMap">
		DELETE FROM MEM_EVAL_SECTION_POOL
		WHERE YEAR = #year#
		  AND GUBUN_ID = #gubun#
	</delete>
		
	<!--
	==================================================================
	  # 설명	: 평가등급 구간대항목 등록
	  #	기능	: INSERT
	  #	TABLE	: MEM_EVAL_SECTION_POOL
	==================================================================
	-->
	<insert id="insertEvalSection" parameterClass="hashMap">
		INSERT INTO MEM_EVAL_SECTION_POOL (
               YEAR
             , GUBUN_ID
             , EVAL_SECTION_ID
             , FROM_VALUE
             , TO_VALUE
             , CONVERSION_SCORE
             , CREATE_DT
           ) VALUES (
               #year#
             , #gubun#
             , #evalSectionId#
             , #fromValue#
             , #toValue#
             , #conversionScore#
             , SYSDATE
               )
	</insert>
</sqlMap>


